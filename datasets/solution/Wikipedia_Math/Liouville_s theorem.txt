Key result in Hamiltonian mechanics and statistical mechanics
This article is about Liouville's theorem in Hamiltonian mechanics. For other uses, see Liouville's theorem.
Part of a series onClassical mechanicsF=ddt(mv)F=d/dt(mv)Second law of motion

History
Timeline
Textbooks

Branches
Applied
Celestial
Continuum
Dynamics
Kinematics
Kinetics
Statics
Statistical mechanics


Fundamentals
Acceleration
Angular momentum
Couple
D'Alembert's principle
Energy
kinetic
potential
Force
Frame of reference
Inertial frame of reference
Impulse
Inertia / Moment of inertia
Mass
Mechanical power
Mechanical work
Moment
Momentum
Space
Speed
Time
Torque
Velocity
Virtual work


Formulations
Newton's laws of motion
Analytical mechanics Lagrangian mechanicsHamiltonian mechanicsRouthian mechanicsHamilton–Jacobi equationAppell's equation of motionKoopman–von Neumann mechanics

Core topics
Damping
Displacement
Equations of motion
Euler's laws of motion
Fictitious force
Friction
Harmonic oscillator

Inertial / Non-inertial reference frame
Mechanics of planar particle motion

Motion (linear)
Newton's law of universal gravitation
Newton's laws of motion
Relative velocity
Rigid body
dynamics
Euler's equations
Simple harmonic motion
Vibration


Rotation
Circular motion
Rotating reference frame
Centripetal force
Centrifugal force
reactive
Coriolis force
Pendulum
Tangential speed
Rotational frequency

Angular acceleration / displacement / frequency / velocity

Scientists
Kepler
Galileo
Huygens
Newton
Horrocks
Halley
Maupertuis
Daniel Bernoulli
Johann Bernoulli
Euler
d'Alembert
Clairaut
Lagrange
Laplace
Hamilton
Poisson
Cauchy
Routh
Liouville
Appell
Gibbs
Koopman
von Neumann


 Physics portal
 Categoryvte
In physics, Liouville's theorem, named after the French mathematician Joseph Liouville, is a key theorem in classical statistical and Hamiltonian mechanics. It asserts that the phase-space distribution function is constant along the trajectories of the system—that is that the density of system points in the vicinity of a given system point traveling through phase-space is constant with time. This time-independent density is in statistical mechanics known as the classical a priori probability.[1]
There are related mathematical results in symplectic topology and ergodic theory; systems obeying Liouville's theorem are examples of incompressible dynamical systems.
There are extensions of Liouville's theorem to stochastic systems.[2]


Liouville equation[edit]
Evolution of an ensemble of classical systems in phase space (top). Each system consists of one massive particle in a one-dimensional potential well (red curve, lower figure). Whereas the motion of an individual member of the ensemble is given by Hamilton's equations, Liouville's equation describes the flow of the whole distribution. The motion is analogous to a dye in an incompressible fluid.
The Liouville equation describes the time evolution of the phase space distribution function. Although the equation is usually referred to as the "Liouville equation", Josiah Willard Gibbs was the first to recognize the importance of this equation as the fundamental equation of statistical mechanics.[3][4] It is referred to as the Liouville equation because its derivation for non-canonical systems utilises an identity first derived by Liouville in 1838.[5][6]
Consider a Hamiltonian dynamical system with canonical coordinates qi_i and conjugate momenta pi_i, where i=1,…,n=1,…,n. Then the phase space distribution ρ(p,q)ρ(p,q) determines the probability ρ(p,q)dnqdnpρ(p,q) d^nq d^np that the system will be found in the infinitesimal phase space volume dnqdnpd^nq d^np. The Liouville equation governs the evolution of ρ(p,q;t)ρ(p,q;t) in time t:

dρdt=∂ρ∂t+∑i=1n(∂ρ∂qiq˙i+∂ρ∂pip˙i)=0.dρ/dt=∂ρ/+∑_i=1^n(∂ρ/_iq̇_i+∂ρ/_iṗ_i)=0.
Time derivatives are denoted by dots, and are evaluated according to Hamilton's equations for the system. This equation demonstrates the conservation of density in phase space (which was Gibbs's name for the theorem). Liouville's theorem states that

The distribution function is constant along any trajectory in phase space.
A proof of Liouville's theorem uses the n-dimensional divergence theorem.  This proof is based on the fact that the evolution of ρρ obeys an 2n-dimensional version of the continuity equation:

∂ρ∂t+∑i=1n(∂(ρq˙i)∂qi+∂(ρp˙i)∂pi)=0.∂ρ/+∑_i=1^n(∂(ρq̇_i)/_i+∂(ρṗ_i)/_i)=0.
That is, the 3-tuple (ρ,ρq˙i,ρp˙i)(ρ,ρq̇_i,ρṗ_i) is a conserved current. Notice that the difference between this and Liouville's equation are the terms

ρ∑i=1n(∂q˙i∂qi+∂p˙i∂pi)=ρ∑i=1n(∂2H∂qi∂pi−∂2H∂pi∂qi)=0,ρ∑_i=1^n(∂q̇_i/_i+∂ṗ_i/_i)=ρ∑_i=1^n(∂^2H/_i _i-∂^2H/_i_i)=0,
where H is the Hamiltonian, and Hamilton's equations as well as conservation of the Hamiltonian along the flow have been used. That is, viewing the motion through phase space as a 'fluid flow' of system points, the theorem that the convective derivative of the density, dρ/dtρ/dt, is zero follows from the equation of continuity by noting that the 'velocity field' (p˙,q˙)(ṗ,q̇) in phase space has zero divergence (which follows from Hamilton's relations).[7]
Another illustration is to consider the trajectory of a cloud of points through phase space. It is straightforward to show that as the cloud stretches in one coordinate, pi_i for instance, it shrinks in the corresponding qi^i direction so that the product ΔpiΔqi_i ^i remains constant.

Other formulations[edit]
Poisson bracket[edit]
The theorem above is often restated in terms of the Poisson bracket as

∂ρ∂t=−ρ,H∂ρ/=-{ ρ,H }
or, in terms of the linear Liouville operator or Liouvillian,

iL^=∑i=1n[∂H∂pi∂∂qi−∂H∂qi∂∂pi]=∙,Hi𝐋=∑_i=1^n[/_i∂/^i-/^i∂/_i]={∙,H}
as

∂ρ∂t+iL^ρ=0.∂ρ/+i𝐋ρ=0.
Ergodic theory[edit]
In ergodic theory and dynamical systems, motivated by the physical considerations given so far, there is a corresponding result also referred to as Liouville's theorem. In Hamiltonian mechanics, the phase space is a smooth manifold that comes naturally equipped with a smooth measure (locally, this measure is the 6n-dimensional Lebesgue measure). The theorem says this smooth measure is invariant under the Hamiltonian flow. More generally, one can describe the necessary and sufficient condition under which a smooth measure is invariant under a flow[citation needed]. The Hamiltonian case then becomes a corollary.

Symplectic geometry[edit]
We can also formulate Liouville's Theorem in terms of symplectic geometry. For a given system, we can consider the phase space (qμ,pμ)(q^μ,p_μ) of a particular Hamiltonian H as a manifold (M,ω)(M,ω) endowed with a symplectic 2-form

ω=dpμ∧dqμ.ω=dp_μ^μ.
The volume form of our manifold is the top exterior power of the symplectic 2-form, and is just another representation of the measure on the phase space described above.
On our phase space symplectic manifold we can define a Hamiltonian vector field generated by a function f(q,p)(q,p) as

Xf=∂f∂pμ∂∂qμ−∂f∂qμ∂∂pμ._f=/_μ∂/^μ-/^μ∂/_μ.
Specifically, when the generating function is the Hamiltonian itself, f(q,p)=H(q,p)=H, we get

XH=∂H∂pμ∂∂qμ−∂H∂qμ∂∂pμ=dqμdt∂∂qμ+dpμdt∂∂pμ=ddt_H=/_μ∂/^μ-/^μ∂/_μ=dq^μ/dt∂/^μ+dp^μ/dt∂/_μ=d/dt
where we utilized Hamilton's equations of motion and the definition of the chain rule.[8]
In this formalism, Liouville's Theorem states that the Lie derivative of the volume form is zero along the flow generated by XH_H. That is, for (M,ω)(M,ω) a 2n-dimensional symplectic manifold,

LXH(ωn)=0.ℒ_X_H(ω^n)=0.
In fact, the symplectic structure ωω itself is preserved, not only its top exterior power. That is, Liouville's Theorem also gives [9]

LXH(ω)=0.ℒ_X_H(ω)=0.
Quantum Liouville equation[edit]
The analog of Liouville equation in quantum mechanics describes the time evolution of a mixed state.  Canonical quantization yields a quantum-mechanical version of this theorem, the von Neumann equation.  This procedure, often used to devise quantum analogues of classical systems, involves describing a classical system using Hamiltonian mechanics.  Classical variables are then re-interpreted as quantum operators, while Poisson brackets are replaced by commutators.  In this case, the resulting equation is[10][11]

∂ρ∂t=1iℏ[H,ρ],∂ρ/=1/iħ[H,ρ],
where ρ is the density matrix.
When applied to the expectation value of an observable, the corresponding equation is given by Ehrenfest's theorem, and takes the form

ddt⟨A⟩=−1iℏ⟨[H,A]⟩,d/dt⟩=-1/iħ⟨[H,A]⟩,
where A is an observable. Note the sign difference, which follows from the assumption that the operator is stationary and the state is time-dependent.
In the phase-space formulation of quantum mechanics, substituting the Moyal brackets for Poisson brackets in the phase-space analog of the von Neumann equation results in compressibility of the probability fluid, and thus violations of Liouville's theorem incompressibility. This, then, leads to concomitant difficulties in defining meaningful quantum trajectories.[12]

Examples[edit]
SHO phase-space volume[edit]
The time evolution of phase space for the simple harmonic oscillator (SHO). Here we have taken m=ω=1=ω=1 and are considering the region p,q∈[−1,1],q∈[-1,1].
Consider an N-particle system in three dimensions, and focus on only the evolution of dNd𝒩 particles. Within phase space, these dNd𝒩 particles occupy an infinitesimal volume given by

dΓ=∏i=1Nd3pid3qi.dΓ=∏_i=1^Nd^3p_id^3q_i.
We want dNdΓd𝒩/dΓ to remain the same throughout time, so that ρ(Γ,t)ρ(Γ,t) is constant along the trajectories of the system. If we allow our particles to evolve by an infinitesimal time step δt, we see that each particle phase space location changes as

qi′=qi+qi˙δt,pi′=pi+pi˙δt,q_i'=q_i+q̇_̇i̇,
p_i'=p_i+ṗ_̇i̇,
where qi˙q̇_̇i̇ and pi˙ṗ_̇i̇ denote dqidtdq_i/dt and dpidtdp_i/dt respectively, and we have only kept terms linear in δt. Extending this to our infinitesimal hypercube dΓdΓ, the side lengths change as

dqi′=dqi+∂qi˙∂qidqiδt,dpi′=dpi+∂pi˙∂pidpiδt.dq_i'=dq_i+∂q̇_̇i̇/_idq_i,
dp_i'=dp_i+∂ṗ_̇i̇/_idp_i.
To find the new infinitesimal phase-space volume dΓ′dΓ', we need the product of the above quantities. To first order in δt, we get the following:

dqi′dpi′=dqidpi[1+(∂qi˙∂qi+∂pi˙∂pi)δt]._i'dp_i'=dq_idp_i[1+(∂q̇_̇i̇/_i+∂ṗ_̇i̇/_i)].
So far, we have yet to make any specifications about our system. Let us now specialize to the case of N 33-dimensional isotropic harmonic oscillators. That is, each particle in our ensemble can be treated as a simple harmonic oscillator. The Hamiltonian for this system is given by

H=∑i=13N(12mpi2+mω22qi2).=∑_i=1^3N(1/2mp_i^2+mω^2/2q_i^2).
By using Hamilton's equations with the above Hamiltonian we find that the term in parentheses above is identically zero, thus yielding

dqi′dpi′=dqidpi._i'dp_i'=dq_idp_i.
From this we can find the infinitesimal volume of phase space:

dΓ′=∏i=1Nd3qi′d3pi′=∏i=1Nd3qid3pi=dΓ.dΓ'=∏_i=1^Nd^3q_i'd^3p_i'=∏_i=1^Nd^3q_id^3p_i=dΓ.
Thus we have ultimately found that the infinitesimal phase-space volume is unchanged, yielding

ρ(Γ′,t+δt)=dNdΓ′=dNdΓ=ρ(Γ,t),ρ(Γ',t+)=d𝒩/dΓ'=d𝒩/dΓ=ρ(Γ,t),
demonstrating that Liouville's theorem holds for this system.[13]
The question remains of how the phase-space volume actually evolves in time. Above we have shown that the total volume is conserved, but said nothing about what it looks like. For a single particle we can see that its trajectory in phase space is given by the ellipse of constant H. Explicitly, one can solve Hamilton's equations for the system and find

qi(t)=Qicos⁡ωt+Pimωsin⁡ωt,pi(t)=Picos⁡ωt−mωQisin⁡ωt,q_i(t)   =Q_icos+P_i/mωsin,
p_i(t)   =P_icos-m_isin,
where Qi_i and Pi_i denote the initial position and momentum of the i-th particle.
For a system of multiple particles, each one will have a phase-space trajectory that traces out an ellipse corresponding to the particle's energy. The frequency at which the ellipse is traced is given by the ωω in the Hamiltonian, independent of any differences in energy. As a result, a region of phase space will simply rotate about the point (q,p)=(0,0)(𝐪,𝐩)=(0,0) with frequency dependent on ωω.[14] This can be seen in the animation above.

Damped harmonic oscillator[edit]
The evolution of phase-space volume for the damped harmonic oscillator. The same values of parameters are used as in the SHO case, with γ=0.5(α=0.25)γ=0.5α=0.25).
One of the foundational assumptions of Liouville's theorem is that the system obeys the conservation of energy. In the context of phase space, this is to say that ρρ is constant on phase-space surfaces of constant energy E. If we break this requirement by considering a system in which energy is not conserved, we find that ρρ also fails to be constant.
As an example of this, consider again the system of N particles each in a 33-dimensional isotropic harmonic potential, the Hamiltonian for which is given in the previous example. This time, we add the condition that each particle experiences a frictional force. As this is a non-conservative force, we need to extend Hamilton's equations as

qi˙=∂H∂pi,pi˙=−∂H∂qi−γpi,q̇_̇i̇   =/_i,
ṗ_̇i̇   =-/_i-_i,
where γγ is a positive constant dictating the amount of friction. Following a very similar procedure to the undamped harmonic oscillator case, we arrive again at

dqi′dpi′=dqidpi[1+(∂qi˙∂qi+∂pi˙∂pi)δt]._i'dp_i'=dq_idp_i[1+(∂q̇_̇i̇/_i+∂ṗ_̇i̇/_i)].
Plugging in our modified Hamilton's equations, we find

dqi′dpi′=dqidpi[1+(∂2H∂qi∂pi−∂2H∂pi∂qi−γ)δt],=dqidpi[1−γδt].dq_i'dp_i'   =dq_idp_i[1+(∂^2H/_i_i-∂^2H/_i_i-γ)],
   =dq_idp_i[1-γ].
Calculating our new infinitesimal phase space volume, and keeping only first order in δt we find the following result:

dΓ′=∏i=1Nd3qi′d3pi′=[1−γδt]3N∏i=1Nd3qid3pi=dΓ[1−3Nγδt].dΓ'=∏_i=1^Nd^3q_i'd^3p_i'=[1-γ]^3N∏_i=1^Nd^3q_id^3p_i=dΓ[1-3Nγ].
We have found that the infinitesimal phase-space volume is no longer constant, and thus the phase-space density is not conserved. As can be seen from the equation as time increases, we expect our phase-space volume to decrease to zero as friction affects the system.
As for how the phase-space volume evolves in time, we will still have the constant rotation as in the undamped case. However, the damping will introduce a steady decrease in the radii of each ellipse. Again we can solve for the trajectories explicitly using Hamilton's equations, taking care to use the modified ones above. Letting α≡γ2α≡γ/2 for convenience, we find

qi(t)=e−αt[Qicos⁡ω1t+Bisin⁡ω1t]ω1≡ω2−α2,pi(t)=e−αt[Picos⁡ω1t−m(ω1Qi+2αBi)sin⁡ω1t]Bi≡1ω1(Pim+2αQi),q_i(t)   =e^-[Q_icosω_1t+B_isinω_1t]      ω_1≡√(ω^2-α^2),
p_i(t)   =e^-[P_icosω_1t-m(ω_1Q_i+2_i)sinω_1t]      B_i≡1/ω_1(P_i/m+2_i),
where the values Qi_i and Pi_i denote the initial position and momentum of the i-th particle.
As the system evolves the total phase-space volume will spiral in to the origin. This can be seen in the figure above.

Remarks[edit]
The Liouville equation is valid for both equilibrium and nonequilibrium systems. It is a fundamental equation of non-equilibrium statistical mechanics.
The Liouville equation is integral to the proof of the fluctuation theorem from which the second law of thermodynamics can be derived.  It is also the key component of the derivation of Green–Kubo relations for linear transport coefficients such as shear viscosity, thermal conductivity or electrical conductivity.
Virtually any textbook on Hamiltonian mechanics, advanced statistical mechanics, or symplectic geometry will derive the Liouville theorem.[9][15][16][17][18]
See also[edit]
Boltzmann transport equation
Reversible reference system propagation algorithm (r-RESPA)
References[edit]


^ Harald J. W. Müller-Kirsten, Basics of Statistical Physics, 2nd ed., World Scientific (Singapore, 2013)

^ Kubo, Ryogo (1963-02-01). "Stochastic Liouville Equations". Journal of Mathematical Physics. 4 (2): 174–183. Bibcode:1963JMP.....4..174K. doi:10.1063/1.1703941. ISSN 0022-2488.

^ J. W. Gibbs, "On the Fundamental Formula of Statistical Mechanics, with Applications to Astronomy and Thermodynamics." Proceedings of the American Association for the Advancement of Science, 33, 57–58 (1884). Reproduced in The Scientific Papers of J. Willard Gibbs, Vol II (1906), p. 16.

^ Gibbs, Josiah Willard (1902). Elementary Principles in Statistical Mechanics. New York: Charles Scribner's Sons.

^ Liouville, Joseph (1838). "Sur la Theorie de la Variation des constantes arbitraires" (PDF). Journal de mathématiques pures et appliquées. 3: 342–349.

^ Ehrendorfer, Martin. "The Liouville Equation: Background - Historical Background". The Liouville Equation in Atmospheric Predictability (PDF). pp. 48–49.

^ Harald J.W. Müller-Kirsten, Introduction to Quantum Mechanics: Schrödinger Equation and Path Integral, 2nd ed., World Scientific (Singapore, 2012).

^ Nakahara, Mikio (2003). Geometry, Topology, and Physics (2 ed.). Taylor & Francis Group. pp. 201–204. ISBN 978-0-7503-0606-5.

^ a b Nash, Oliver (8 January 2015). "Liouville's theorem for pedants" (PDF). Proves Liouville's theorem using the language of modern differential geometry.

^ The theory of open quantum systems, by Breuer and Petruccione, p. 110.

^ Statistical mechanics, by Schwabl, p. 16.

^ Oliva, Maxime; Kakofengitis, Dimitris; Steuernagel, Ole (2018). "Anharmonic quantum mechanical systems do not feature phase space trajectories". Physica A: Statistical Mechanics and Its Applications. 502: 201–210. arXiv:1611.03303. Bibcode:2018PhyA..502..201O. doi:10.1016/j.physa.2017.10.047. S2CID 53691877.

^ Kardar, Mehran (2007). Statistical Physics of Particles. University of Cambridge Press. pp. 59–60. ISBN 978-0-521-87342-0.

^ Eastman, Peter (2014–2015). "Evolution of Phase Space Probabilities".

^ For a particularly clear derivation see Tolman, R. C. (1979). The Principles of Statistical Mechanics. Dover. pp. 48–51. ISBN 9780486638966.

^ "Phase Space and Liouville's Theorem". Retrieved January 6, 2014. Nearly identical to proof in this Wikipedia article. Assumes (without proof) the n-dimensional continuity equation.

^ "Preservation of phase space volume and Liouville's theorem". Retrieved January 6, 2014. A rigorous proof based on how the Jacobian volume element transforms under Hamiltonian mechanics.

^ "Physics 127a: Class Notes" (PDF). Retrieved January 6, 2014. Uses the n-dimensional divergence theorem (without proof).


Further reading[edit]
Murugeshan, R. Modern Physics. S. Chand.
Misner; Thorne; Wheeler (1973). "Kinetic Theory in Curved Spacetime". Gravitation. Freeman. pp. 583–590. ISBN 9781400889099.
External links[edit]
"Phase space distribution functions and Liouville's theorem".



