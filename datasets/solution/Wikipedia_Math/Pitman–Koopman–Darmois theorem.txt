Family of probability distributions related to the normal distribution
Not to be confused with the exponential distribution.
"Natural parameter" redirects here. For use of this term in differential geometry, see Natural parametrization.
In probability and statistics, an exponential family is a parametric set of probability distributions of a certain form, specified below. This special form is chosen for mathematical convenience, including the enabling of the user to calculate expectations, covariances using differentiation based on some useful algebraic properties, as well as for generality, as exponential families are in a sense very natural sets of distributions to consider. The term exponential class is sometimes used in place of "exponential family",[1] or the older term Koopmanâ€“Darmois family. The terms "distribution" and "family" are often used loosely: specifically, an exponential family is a set of distributions, where the specific distribution varies with the parameter;[a] however, a parametric family of distributions is often referred to as "a distribution" (like "the normal distribution", meaning "the family of normal distributions"), and the set of all exponential families is sometimes loosely referred to as "the" exponential family. They are distinct because they possess a variety of desirable properties, most importantly the existence of a sufficient statistic.
The concept of exponential families is credited to[2] E. J. G. Pitman,[3] G. Darmois,[4] and B. O. Koopman[5] in 1935â€“1936. Exponential families of distributions provide a general framework for selecting a possible alternative parameterisation of a parametric family of distributions, in terms of natural parameters, and for defining useful sample statistics, called the natural sufficient statistics of the family.


Definition[edit]
Most of the commonly used distributions form an exponential family or subset of an exponential family, listed in the subsection below. The subsections following it are a sequence of increasingly more general mathematical definitions of an exponential family. A casual reader may wish to restrict attention to the first and simplest definition, which corresponds to a single-parameter family of discrete or continuous probability distributions.

Examples of exponential family distributions[edit]
Exponential families include many of the most common distributions. Among many others, exponential families includes the following:[6]


normal
exponential
gamma
chi-squared
beta
Dirichlet
Bernoulli
categorical
Poisson
Wishart
inverse Wishart
geometric

A number of common distributions are exponential families, but only when certain parameters are fixed and known. For example:

binomial (with fixed number of trials)
multinomial (with fixed number of trials)
negative binomial (with fixed number of failures)
Notice that in each case, the parameters which must be fixed determine a limit on the size of observation values.
Examples of common distributions that are not exponential families are Student's t, most mixture distributions, and even the family of uniform distributions when the bounds are not fixed. See the section below on examples for more discussion.

Scalar parameter[edit]
A single-parameter exponential family is a set of probability distributions whose probability density function (or probability mass function, for the case of a discrete distribution) can be expressed in the form

fX(xâˆ£Î¸)=h(x)exp[Î·(Î¸)â‹…T(x)âˆ’A(Î¸)]_X(x|Î¸)=h(x) exp[ Î·(Î¸)(x)-A(Î¸) ]
where T(x), h(x), Î·(Î¸), and A(Î¸) are known functions.
The function h(x) must of course be non-negative.
An alternative, equivalent form often given is

fX(xâˆ£Î¸)=h(x)g(Î¸)exp[Î·(Î¸)â‹…T(x)]_X(x|Î¸)=h(x) g(Î¸) exp[ Î·(Î¸)(x) ]
or equivalently

fX(xâˆ£Î¸)=exp[Î·(Î¸)â‹…T(x)âˆ’A(Î¸)+B(x)]_X(x|Î¸)=exp[ Î·(Î¸)(x)-A(Î¸)+B(x) ]
The value Î¸ is called the parameter of the family.
In addition, the support of fX(xâˆ£Î¸)_X(x|Î¸) (i.e. the set of all x for which fX(xâˆ£Î¸)_X(x|Î¸) is greater than 0) does not depend on Î¸Î¸.[7] This can be used to exclude a parametric family distribution from being an exponential family. For example, the Pareto distribution has a pdf which is defined for xâ‰¥xm_m (xm_m being the scale parameter) and its support, therefore, has a lower limit of xm_m. Since the support of fÎ±,xm(x)_Î±,x_m(x) is dependent on the value of the parameter, the family of Pareto distributions does not form an exponential family of distributions (at least when xm_m is unknown).
Often x is a vector of measurements, in which case T(x) may be a function from the space of possible values of x to the real numbers. More generally, Î·(Î¸) and T(x) can each be vector-valued such that Î·â€²(Î¸)â‹…T(x)Î·'(Î¸)(x) is real-valued. However, see the discussion below on vector parameters, regarding the curved exponential family.
If Î·(Î¸)Â =Â Î¸, then the exponential family is said to be in canonical form. By defining a transformed parameter Î·Â =Â Î·(Î¸), it is always possible to convert an exponential family to canonical form. The canonical form is non-unique, since Î·(Î¸) can be multiplied by any nonzero constant, provided that T(x) is multiplied by that constant's reciprocal, or a constant c can be added to Î·(Î¸) and h(x) multiplied by exp[âˆ’câ‹…T(x)]exp[-c(x) ] to offset it.  In the special case that Î·(Î¸)Â =Â Î¸ and T(x)Â =Â x then the family is called a natural exponential family.
Even when x is a scalar, and there is only a single parameter, the functions Î·(Î¸) and T(x) can still be vectors, as described below.
The function A(Î¸), or equivalently g(Î¸), is automatically determined once the other functions have been chosen, since it must assume a form that causes the distribution to be normalized (sum or integrate to one over the entire domain).  Furthermore, both of these functions can always be written as functions of Î·, even when Î·(Î¸) is not a one-to-one function, i.e. two or more different values of Î¸ map to the same value of Î·(Î¸), and hence Î·(Î¸) cannot be inverted. In such a case, all values of Î¸ mapping to the same Î·(Î¸) will also have the same value for A(Î¸) and g(Î¸).

Factorization of the variables involved[edit]
What is important to note, and what characterizes all exponential family variants, is that the parameter(s) and the observation variable(s) must factorize (can be separated into products each of which involves only one type of variable), either directly or within either part (the base or exponent) of an exponentiation operation.  Generally, this means that all of the factors constituting the density or mass function must be of one of the following forms:

f(x),g(Î¸),cf(x),cg(Î¸),[f(x)]c,[g(Î¸)]c,[f(x)]g(Î¸),[g(Î¸)]f(x),[f(x)]h(x)g(Î¸),or[g(Î¸)]h(x)j(Î¸),(x),g(Î¸),c^f(x),c^g(Î¸),[f(x)]^c,[g(Î¸)]^c,[f(x)]^g(Î¸),[g(Î¸)]^f(x),[f(x)]^h(x)g(Î¸),or[g(Î¸)]^h(x)j(Î¸),
where f and h are arbitrary functions of x; g and j are arbitrary functions of Î¸; and c is an arbitrary "constant" expression (i.e. an expression not involving x or Î¸).
There are further restrictions on how many such factors can occur.  For example, the two expressions:

[f(x)g(Î¸)]h(x)j(Î¸),[f(x)]h(x)j(Î¸)[g(Î¸)]h(x)j(Î¸),[f(x)g(Î¸)]^h(x)j(Î¸),    [f(x)]^h(x)j(Î¸)[g(Î¸)]^h(x)j(Î¸),
are the same, i.e. a product of two "allowed" factors.  However, when rewritten into the factorized form,

[f(x)g(Î¸)]h(x)j(Î¸)=[f(x)]h(x)j(Î¸)[g(Î¸)]h(x)j(Î¸)=e[h(x)logâ¡f(x)]j(Î¸)+h(x)[j(Î¸)logâ¡g(Î¸)],[f(x)g(Î¸)]^h(x)j(Î¸)=[f(x)]^h(x)j(Î¸)[g(Î¸)]^h(x)j(Î¸)=e^[h(x)(x)]j(Î¸)+h(x)[j(Î¸)(Î¸)],
it can be seen that it cannot be expressed in the required form. (However, a form of this sort is a member of a curved exponential family, which allows multiple factorized terms in the exponent.[citation needed])
To see why an expression of the form

[f(x)]g(Î¸)[f(x)]^g(Î¸)
qualifies,

[f(x)]g(Î¸)=eg(Î¸)logâ¡f(x)[f(x)]^g(Î¸)=e^g(Î¸)(x)
and hence factorizes inside of the exponent. Similarly,

[f(x)]h(x)g(Î¸)=eh(x)g(Î¸)logâ¡f(x)=e[h(x)logâ¡f(x)]g(Î¸)[f(x)]^h(x)g(Î¸)=e^h(x)g(Î¸)(x)=e^[h(x)(x)]g(Î¸)
and again factorizes inside of the exponent.
A factor consisting of a sum where both types of variables are involved (e.g. a factor of the form 1+f(x)g(Î¸)1+f(x)g(Î¸)) cannot be factorized in this fashion (except in some cases where occurring directly in an exponent); this is why, for example, the Cauchy distribution and Student's t distribution are not exponential families.

Vector parameter[edit]
The definition in terms of one real-number parameter can be extended to one real-vector parameter

Î¸â‰¡[Î¸1,Î¸2,â€¦,Î¸s]T.Î¸â‰¡[ Î¸_1, Î¸_2, â€¦, Î¸_s ]^ğ–³Â .
A family of distributions is said to belong to a vector exponential family if the probability density function (or probability mass function, for discrete distributions) can be written as

fX(xâˆ£Î¸)=h(x)expâ¡(âˆ‘i=1sÎ·i(Î¸)Ti(x)âˆ’A(Î¸)),_X(x|Î¸)=h(x) exp(âˆ‘_i=1^sÎ·_i(Î¸)T_i(x)-A(Î¸))Â ,
or in a more compact form,

fX(xâˆ£Î¸)=h(x)expâ¡(Î·(Î¸)â‹…T(x)âˆ’A(Î¸))_X(x|Î¸)=h(x) exp(Î·(Î¸)Â·ğ“(x)-A(Î¸))
This form writes the sum as a dot product of vector-valued functions Î·(Î¸)Î·(Î¸) and T(x)ğ“(x) .
An alternative, equivalent form often seen is

fX(xâˆ£Î¸)=h(x)g(Î¸)expâ¡(Î·(Î¸)â‹…T(x))_X(x|Î¸)=h(x) g(Î¸) exp(Î·(Î¸)Â·ğ“(x))
As in the scalar valued case, the exponential family is said to be in canonical form if

Î·i(Î¸)=Î¸iâˆ€i.  Î·_i(Î¸)=Î¸_i   .
A vector exponential family is said to be curved if the dimension of

Î¸â‰¡[Î¸1,Î¸2,â€¦,Î¸d]TÎ¸â‰¡[ Î¸_1, Î¸_2, â€¦, Î¸_d  ]^ğ–³
is less than the dimension of the vector

Î·(Î¸)â‰¡[Î·1(Î¸),Î·2(Î¸),â€¦,Î·s(Î¸)]T.Î·(Î¸)â‰¡[ Î·_1(Î¸), Î·_2(Î¸), â€¦, Î·_s(Î¸) ]^ğ–³Â .
That is, if the dimension, d, of the parameter vector is less than the number of functions, s, of the parameter vector in the above representation of the probability density function. Most common distributions in the exponential family are not curved, and many algorithms designed to work with any exponential family implicitly or explicitly assume that the distribution is not curved.
Just as in the case of a scalar-valued parameter, the function A(Î¸)(Î¸) or equivalently g(Î¸)(Î¸) is automatically determined by the normalization constraint, once the other functions have been chosen. Even if Î·(Î¸)Î·(Î¸) is not one-to-one, functions A(Î·)(Î·) and g(Î·)(Î·) can be defined by requiring that the distribution is normalized for each value of the natural parameter Î·Î·. This yields the canonical form

fX(xâˆ£Î·)=h(x)expâ¡(Î·â‹…T(x)âˆ’A(Î·)),_X(x|Î·)=h(x) exp(Î·Â·ğ“(x)-A(Î·)),
or equivalently

fX(xâˆ£Î·)=h(x)g(Î·)expâ¡(Î·â‹…T(x))._X(x|Î·)=h(x) g(Î·) exp(Î·Â·ğ“(x)).
The above forms may sometimes be seen with Î·TT(x)Î·^ğ–³ğ“(x) in place of Î·â‹…T(x)Î·Â·ğ“(x) . These are exactly equivalent formulations, merely using different notation for the dot product.

Vector parameter, vector variable[edit]
The vector-parameter form over a single scalar-valued random variable can be trivially expanded to cover a joint distribution over a vector of random variables. The resulting distribution is simply the same as the above distribution for a scalar-valued random variable with each occurrence of the scalar x replaced by the vector

x=(x1,x2,â‹¯,xk)T.ğ±=(x_1,x_2,â‹¯,x_k)^ğ–³Â .
The dimensions k of the random variable need not match the dimension d of the parameter vector, nor (in the case of a curved exponential function) the dimension s of the natural parameter Î·Î· and sufficient statistic T(x)Â .
The distribution in this case is written as

fX(xâˆ£Î¸)=h(x)exp(âˆ‘i=1sÎ·i(Î¸)Ti(x)âˆ’A(Î¸))_X(ğ±|Î¸)=h(ğ±) exp( âˆ‘_i=1^sÎ·_i(Î¸)T_i(ğ±)-A(Î¸) )
Or more compactly as

fX(xâˆ£Î¸)=h(x)exp(Î·(Î¸)â‹…T(x)âˆ’A(Î¸))_X( ğ±|Î¸ )=h(ğ±) exp( Î·(Î¸)Â·ğ“(ğ±)-A(Î¸) )
Or alternatively as

fX(xâˆ£Î¸)=g(Î¸)h(x)exp(Î·(Î¸)â‹…T(x))_X( ğ±|Î¸ )=g(Î¸) h(ğ±) exp( Î·(Î¸)Â·ğ“(ğ±) )
Measure-theoretic formulation[edit]
We use cumulative distribution functions (CDF) in order to encompass both discrete and continuous distributions.
Suppose H is a non-decreasing function of a real variable. Then Lebesgueâ€“Stieltjes integrals with respect to dH(x)d H(ğ±) are integrals with respect to the reference measure of the exponential family generated by HÂ .
Any member of that exponential family has cumulative distribution function

dF(xâˆ£Î¸)=expâ¡(Î·(Î¸)â‹…T(x)âˆ’A(Î¸))dH(x).d F( ğ±|Î¸ )=exp( Î·(Î¸)Â·ğ“(ğ±) - A(Î¸) )Â d H(ğ±)Â .
H(x) is a Lebesgueâ€“Stieltjes integrator for the reference measure. When the reference measure is finite, it can be normalized and H is actually the cumulative distribution function of a probability distribution. If F is absolutely continuous with a density f(x)(x) with respect to a reference measure dx d x  (typically Lebesgue measure), one can write dF(x)=f(x)dx d F(x)=f(x)Â d x .
In this case, H is also absolutely continuous and can be written dH(x)=h(x)dx d H(x)=h(x) d x  so the formulas reduce to that of the previous paragraphs. If F is discrete, then H is a step function (with steps on the support of F).
Alternatively, we can write the probability measure directly as

P(dxâˆ£Î¸)=expâ¡(Î·(Î¸)â‹…T(x)âˆ’A(Î¸))Î¼(dx).( d ğ±|Î¸ )=exp( Î·(Î¸)Â·ğ“(ğ±)-A(Î¸) )Â Î¼(d ğ±)Â .
for some reference measure Î¼Î¼ .

Interpretation[edit]
In the definitions above, the functions T(x), Î·(Î¸), and A(Î·) were arbitrary. However, these functions have important interpretations in the resulting probability distribution.

T(x) is a sufficient statistic of the distribution. For exponential families, the sufficient statistic is a function of the data that holds all information the data x provides with regard to the unknown parameter values. This means that, for any data sets x and y, the likelihood ratio is the same, that is f(x;Î¸1)f(x;Î¸2)=f(y;Î¸1)f(y;Î¸2)f(x;Î¸_1)/f(x;Î¸_2)=f(y;Î¸_1)/f(y;Î¸_2) if Â T(x) = T(y)Â . This is true even if x and y are not equal to each other. The dimension of T(x) equals the number of parameters of Î¸ and encompasses all of the information regarding the data related to the parameter Î¸. The sufficient statistic of a set of independent identically distributed data observations is simply the sum of individual sufficient statistics, and encapsulates all the information needed to describe the posterior distribution of the parameters, given the data (and hence to derive any desired estimate of the parameters). (This important property is discussed further below.)
Î· is called the natural parameter. The set of values of Î· for which the function fX(x;Î·)_X(x;Î·) is integrable is called the natural parameter space. It can be shown that the natural parameter space is always convex.
A(Î·) is called the log-partition function[b] because it is the logarithm of a normalization factor, without which fX(x;Î¸)_X(x;Î¸) would not be a probability distribution:
A(Î·)=logâ¡(âˆ«Xh(x)expâ¡(Î·(Î¸)â‹…T(x))dx)(Î·)=log(âˆ«_Xh(x) exp(Î·(Î¸)(x)) dx)
The function A is important in its own right, because the mean, variance and other moments of the sufficient statistic T(x) can be derived simply by differentiating A(Î·). For example, because log(x) is one of the components of the sufficient statistic of the gamma distribution, Eâ¡[logâ¡x]â„°[] can be easily determined for this distribution using A(Î·). Technically, this is true because 

K(uâˆ£Î·)=A(Î·+u)âˆ’A(Î·),(u|Î·)=A(Î·+u)-A(Î·) ,
is the cumulant generating function of the sufficient statistic.

Properties[edit]
Exponential families have a large number of properties that make them extremely useful for statistical analysis. In many cases, it can be shown that only exponential families have these properties.  Examples:

Exponential families are the only families with sufficient statistics that can summarize arbitrary amounts of independent identically distributed data using a fixed number of values. (Pitmanâ€“Koopmanâ€“Darmois theorem)
Exponential families have conjugate priors, an important property in Bayesian statistics.
The posterior predictive distribution of an exponential-family random variable with a conjugate prior can always be written in closed form (provided that the normalizing factor of the exponential-family distribution can itself be written in closed form).[c]
In the mean-field approximation in variational Bayes (used for approximating the posterior distribution in large Bayesian networks), the best approximating posterior distribution of an exponential-family node (a node is a random variable in the context of Bayesian networks) with a conjugate prior is in the same family as the node.[8]
Given an exponential family defined by fX(xâˆ£Î¸)=h(x)exp[Î¸â‹…T(x)âˆ’A(Î¸)]_X(x|Î¸)=h(x) exp[ Î¸(x)-A(Î¸) ], where Î˜Î˜ is the parameter space, such that Î¸âˆˆÎ˜âŠ‚RkÎ¸âˆˆÎ˜âŠ‚â„^k. Then

If Î˜Î˜ has nonempty interior in Rkâ„^k, then given any IID samples X1,...,Xnâˆ¼fX_1,...,X_n_X, the statistic T(X1,...,Xn):=âˆ‘i=1nT(Xi)(X_1,...,X_n):=âˆ‘_i=1^nT(X_i) is a complete statistic for Î¸Î¸.[9][10]
T is a minimal statistic for Î¸Î¸ iff for all Î¸1,Î¸2âˆˆÎ˜Î¸_1,Î¸_2âˆˆÎ˜, and x1,x2_1,x_2 in the support of X, if (Î¸1âˆ’Î¸2)â‹…(T(x1)âˆ’T(x2))=0(Î¸_1-Î¸_2)Â·(T(x_1)-T(x_2))=0, then Î¸1=Î¸2Î¸_1=Î¸_2 or x1=x2_1=x_2.[11]
Examples[edit]
It is critical, when considering the examples in this section, to remember the discussion above about what it means to say that a "distribution" is an exponential family, and in particular to keep in mind that the set of parameters that are allowed to vary is critical in determining whether a "distribution" is or is not an exponential family.
The normal, exponential, log-normal, gamma, chi-squared, beta, Dirichlet, Bernoulli, categorical, Poisson, geometric, inverse Gaussian, von Mises and von Mises-Fisher distributions are all exponential families.
Some distributions are exponential families only if some of their parameters are held fixed.  The family of Pareto distributions with a fixed minimum bound xm form an exponential family.  The families of binomial and multinomial distributions with fixed number of trials n but unknown probability parameter(s) are exponential families.  The family of negative binomial distributions with fixed number of failures (a.k.a. stopping-time parameter) r is an exponential family.  However, when any of the above-mentioned fixed parameters are allowed to vary, the resulting family is not an exponential family.
As mentioned above, as a general rule, the support of an exponential family must remain the same across all parameter settings in the family. This is why the above cases (e.g. binomial with varying number of trials, Pareto with varying minimum bound) are not exponential families â€” in all of the cases, the parameter in question affects the support (particularly, changing the minimum or maximum possible value). For similar reasons, neither the discrete uniform distribution nor continuous uniform distribution are exponential families as one or both bounds vary.
The Weibull distribution with fixed shape parameter k is an exponential family. Unlike in the previous examples, the shape parameter does not affect the support; the fact that allowing it to vary makes the Weibull non-exponential is due rather to the particular form of the Weibull's probability density function (k appears in the exponent of an exponent).
In general, distributions that result from a finite or infinite mixture of other distributions, e.g. mixture model densities and compound probability distributions, are not exponential families. Examples are typical Gaussian mixture models as well as many heavy-tailed distributions that result from compounding (i.e. infinitely mixing) a distribution with a prior distribution over one of its parameters, e.g. the Student's t-distribution (compounding a normal distribution over a gamma-distributed precision prior), and the beta-binomial and Dirichlet-multinomial distributions.  Other examples of distributions that are not exponential families are the F-distribution, Cauchy distribution, hypergeometric distribution and logistic distribution.
Following are some detailed examples of the representation of some useful distribution as exponential families.

Normal distribution: unknown mean, known variance[edit]
As a first example, consider a random variable distributed normally with unknown mean Î¼ and known variance Ïƒ2. The probability density function is then

fÏƒ(x;Î¼)=12Ï€Ïƒ2eâˆ’(xâˆ’Î¼)2/(2Ïƒ2)._Ïƒ(x;Î¼)=1/âˆš(2Ï€Ïƒ^2)e^-(x-Î¼)^2/(2Ïƒ^2).
This is a single-parameter exponential family, as can be seen by setting

hÏƒ(x)=12Ï€Ïƒ2eâˆ’x2/(2Ïƒ2)TÏƒ(x)=xÏƒAÏƒ(Î¼)=Î¼22Ïƒ2Î·Ïƒ(Î¼)=Î¼Ïƒ.h_Ïƒ(x)   =1/âˆš(2Ï€Ïƒ^2)e^-x^2/(2Ïƒ^2)
T_Ïƒ(x)   =x/Ïƒ
A_Ïƒ(Î¼)   =Î¼^2/2Ïƒ^2
Î·_Ïƒ(Î¼)   =Î¼/Ïƒ.
If Ïƒ = 1 this is in canonical form, as thenÂ Î·(Î¼)Â =Â Î¼.

Normal distribution: unknown mean and unknown variance[edit]
Next, consider the case of a normal distribution with unknown mean and unknown variance. The probability density function is then

f(y;Î¼,Ïƒ)=12Ï€Ïƒ2eâˆ’(yâˆ’Î¼)2/2Ïƒ2.(y;Î¼,Ïƒ)=1/âˆš(2Ï€Ïƒ^2)e^-(y-Î¼)^2/2Ïƒ^2.
This is an exponential family which can be written in canonical form by defining

Î·=[Î¼Ïƒ2,âˆ’12Ïƒ2]h(y)=12Ï€T(y)=(y,y2)TA(Î·)=Î¼22Ïƒ2+logâ¡|Ïƒ|=âˆ’Î·124Î·2+12logâ¡|12Î·2|Î·   =[ Î¼/Ïƒ^2,Â -1/2Ïƒ^2 ]
h(y)   =1/âˆš(2Ï€)
T(y)   =(y,y^2)^T
A(Î·)   =Î¼^2/2Ïƒ^2+log|Ïƒ|=-Î·_1^2/4Î·_2+1/2log|1/2Î·_2|
Binomial distribution[edit]
As an example of a discrete exponential family, consider the binomial distribution with known number of trials n. The probability mass function for this distribution is

f(x)=(nx)px(1âˆ’p)nâˆ’x,xâˆˆ0,1,2,â€¦,n.(x)=np^x(1-p)^n-x,âˆˆ{0,1,2,â€¦,n}.
This can equivalently be written as

f(x)=(nx)expâ¡(xlogâ¡(p1âˆ’p)+nlogâ¡(1âˆ’p)),(x)=nexp(xlog(p/1-p)+nlog(1-p)),
which shows that the binomial distribution is an exponential family, whose natural parameter is

Î·=logâ¡p1âˆ’p.Î·=logp/1-p.
This function of p is known as logit.

Table of distributions[edit]
The following table shows how to rewrite a number of common distributions as exponential-family distributions with natural parameters. Refer  to the flashcards[12] for main exponential families.
For a scalar variable and scalar parameter, the form is as follows:

fX(xâˆ£Î¸)=h(x)expâ¡(Î·(Î¸)T(x)âˆ’A(Î·))_X(x|Î¸)=h(x)exp(Î·(Î¸)T(x)-A(Î·))
For a scalar variable and vector parameter:

fX(xâˆ£Î¸)=h(x)expâ¡(Î·(Î¸)â‹…T(x)âˆ’A(Î·))_X(x|Î¸)=h(x)exp(Î·(Î¸)Â·ğ“(x)-A(Î·))
fX(xâˆ£Î¸)=h(x)g(Î¸)expâ¡(Î·(Î¸)â‹…T(x))_X(x|Î¸)=h(x)g(Î¸)exp(Î·(Î¸)Â·ğ“(x))
For a vector variable and vector parameter:

fX(xâˆ£Î¸)=h(x)expâ¡(Î·(Î¸)â‹…T(x)âˆ’A(Î·))_X(ğ±|Î¸)=h(ğ±)exp(Î·(Î¸)Â·ğ“(ğ±)-A(Î·))
The above formulas choose the functional form of the exponential-family with a log-partition function A(Î·)(Î·). The reason for this is so that the moments of the sufficient statistics can be calculated easily, simply by differentiating this function.  Alternative forms involve either parameterizing this function in terms of the normal parameter Î¸Î¸ instead of the natural parameter, and/or using a factor g(Î·)(Î·) outside of the exponential. The relation between the latter and the former is:

A(Î·)=âˆ’logâ¡g(Î·)(Î·)=-(Î·)
g(Î·)=eâˆ’A(Î·)(Î·)=e^-A(Î·)
To convert between the representations involving the two types of parameter, use the formulas below for writing one type of parameter in terms of the other.



Distribution

Parameter(s) Î¸Î¸

Natural parameter(s) Î·Î·

Inverse parameter mapping

Base measure h(x)(x)

Sufficient statistic T(x)(x)

Log-partition A(Î·)(Î·)

Log-partition A(Î¸)(Î¸)


Bernoulli distribution
p

logâ¡p1âˆ’plogp/1-p
This is the logit function.

11+eâˆ’Î·=eÎ·1+eÎ·1/1+e^-Î·=e^Î·/1+e^Î·
This is the logistic function.

11

x

logâ¡(1+eÎ·)log(1+e^Î·)

âˆ’logâ¡(1âˆ’p)-log(1-p)


binomial distributionwith known number of trials n
p

logâ¡p1âˆ’plogp/1-p

11+eâˆ’Î·=eÎ·1+eÎ·1/1+e^-Î·=e^Î·/1+e^Î·

(nx)n

x

nlogâ¡(1+eÎ·)log(1+e^Î·)

âˆ’nlogâ¡(1âˆ’p)-nlog(1-p)


Poisson distribution
Î»Î»

logâ¡Î»logÎ»

eÎ·^Î·

1x!1/x!

x

eÎ·^Î·

Î»Î»


negative binomial distributionwith known number of failures r
p

logâ¡p

eÎ·^Î·

(x+râˆ’1x)x+r-1

x

âˆ’rlogâ¡(1âˆ’eÎ·)-rlog(1-e^Î·)

âˆ’rlogâ¡(1âˆ’p)-rlog(1-p)


exponential distribution
Î»Î»

âˆ’Î»-Î»

âˆ’Î·-Î·

11

x

âˆ’logâ¡(âˆ’Î·)-log(-Î·)

âˆ’logâ¡Î»-logÎ»


Pareto distributionwith known minimum value xm_m
Î±Î±

âˆ’Î±âˆ’1-Î±-1

âˆ’1âˆ’Î·-1-Î·

11

logâ¡x

âˆ’logâ¡(âˆ’1âˆ’Î·)+(1+Î·)logâ¡xm-log(-1-Î·)+(1+Î·)_m

âˆ’logâ¡Î±âˆ’Î±logâ¡xm-logÎ±-Î±_m


Weibull distributionwith known shape k
Î»Î»

âˆ’1Î»k-1/Î»^k

(âˆ’Î·)âˆ’1/k(-Î·)^-1/k

xkâˆ’1^k-1

xk^k

âˆ’logâ¡(âˆ’Î·)âˆ’logâ¡k-log(-Î·)-

klogâ¡Î»âˆ’logâ¡klogÎ»-


Laplace distributionwith known mean Î¼Î¼
b

âˆ’1b-1/b

âˆ’1Î·-1/Î·

11

|xâˆ’Î¼||x-Î¼|

logâ¡(âˆ’2Î·)log(-2/Î·)

logâ¡2blog2b


chi-squared distribution
Î½Î½

Î½2âˆ’1Î½/2-1

2(Î·+1)2(Î·+1)

eâˆ’x/2^-x/2

logâ¡x

logâ¡Î“(Î·+1)+(Î·+1)logâ¡2logÎ“(Î·+1)+(Î·+1)log2

logâ¡Î“(Î½2)+Î½2logâ¡2logÎ“(Î½/2)+Î½/2log2


normal distributionknown variance
Î¼Î¼

Î¼ÏƒÎ¼/Ïƒ

ÏƒÎ·ÏƒÎ·

eâˆ’x2/(2Ïƒ2)2Ï€Ïƒe^-x^2/(2Ïƒ^2)/âˆš(2Ï€)Ïƒ

xÏƒx/Ïƒ

Î·22Î·^2/2

Î¼22Ïƒ2Î¼^2/2Ïƒ^2


continuous Bernoulli distribution
Î»Î»

logâ¡Î»1âˆ’Î»logÎ»/1-Î»

eÎ·1+eÎ·e^Î·/1+e^Î·

11

x

logâ¡eÎ·âˆ’1Î·loge^Î·-1/Î·

logâ¡(1âˆ’2Î»(1âˆ’Î»)logâ¡(1âˆ’Î»Î»))log(1-2Î»/(1-Î»)log(1-Î»/Î»))


normal distribution
Î¼,Ïƒ2Î¼,
sigma^2

[Î¼Ïƒ2âˆ’12Ïƒ2][   Î¼Ïƒ^2; -12Ïƒ^2 ]

[âˆ’Î·12Î·2âˆ’12Î·2][ -Î·_12Î·_2;   -12Î·_2 ]

12Ï€1/âˆš(2Ï€)

[xx2][   x; x^2 ]

âˆ’Î·124Î·2âˆ’12logâ¡(âˆ’2Î·2)-Î·_1^2/4Î·_2-1/2log(-2Î·_2)

Î¼22Ïƒ2+logâ¡ÏƒÎ¼^2/2Ïƒ^2+logÏƒ


log-normal distribution
Î¼,Ïƒ2Î¼,
sigma^2

[Î¼Ïƒ2âˆ’12Ïƒ2][   Î¼Ïƒ^2; -12Ïƒ^2 ]

[âˆ’Î·12Î·2âˆ’12Î·2][ -Î·_12Î·_2;   -12Î·_2 ]

12Ï€x1/âˆš(2Ï€)x

[logâ¡x(logâ¡x)2][     ; ()^2 ]

âˆ’Î·124Î·2âˆ’12logâ¡(âˆ’2Î·2)-Î·_1^2/4Î·_2-1/2log(-2Î·_2)

Î¼22Ïƒ2+logâ¡ÏƒÎ¼^2/2Ïƒ^2+logÏƒ


inverse Gaussian distribution
Î¼,Î»Î¼,
lambda

[âˆ’Î»2Î¼2âˆ’Î»2][ -Î»2Î¼^2;    -Î»2 ]

[Î·2Î·1âˆ’2Î·2][ âˆš(Î·_2Î·_1);     -2Î·_2 ]

12Ï€x3/21/âˆš(2Ï€)x^3/2

[x1x][  x; 1x ]

âˆ’2Î·1Î·2âˆ’12logâ¡(âˆ’2Î·2)-2âˆš(Î·_1Î·_2)-1/2log(-2Î·_2)

âˆ’Î»Î¼âˆ’12logâ¡Î»-Î»/Î¼-1/2logÎ»


gamma distribution
Î±,Î²Î±,
beta

[Î±âˆ’1âˆ’Î²][ Î±-1;  -Î² ]

[Î·1+1âˆ’Î·2][ Î·_1+1;  -Î·_2 ]

11

[logâ¡xx][  ; x ]

logâ¡Î“(Î·1+1)âˆ’(Î·1+1)logâ¡(âˆ’Î·2)logÎ“(Î·_1+1)-(Î·_1+1)log(-Î·_2)

logâ¡Î“(Î±)âˆ’Î±logâ¡Î²logÎ“(Î±)-Î±logÎ²


k,Î¸,
theta

[kâˆ’1âˆ’1Î¸][ k-1; -1Î¸ ]

[Î·1+1âˆ’1Î·2][ Î·_1+1; -1Î·_2 ]

logâ¡Î“(k)+klogâ¡Î¸logÎ“(k)+klogÎ¸


inverse gamma distribution
Î±,Î²Î±,
beta

[âˆ’Î±âˆ’1âˆ’Î²][ -Î±-1;   -Î² ]

[âˆ’Î·1âˆ’1âˆ’Î·2][ -Î·_1-1;   -Î·_2 ]

11

[logâ¡x1x][    ; 1/x ]

logâ¡Î“(âˆ’Î·1âˆ’1)âˆ’(âˆ’Î·1âˆ’1)logâ¡(âˆ’Î·2)logÎ“(-Î·_1-1)-(-Î·_1-1)log(-Î·_2)

logâ¡Î“(Î±)âˆ’Î±logâ¡Î²logÎ“(Î±)-Î±logÎ²


generalized inverse Gaussian distribution
p,a,b,,

[pâˆ’1âˆ’a/2âˆ’b/2][  p-1; -a/2; -b/2 ]

[Î·1+1âˆ’2Î·2âˆ’2Î·3][ Î·_1+1; -2Î·_2; -2Î·_3 ]

11

[logâ¡xx1x][    ;   x; 1/x ]

logâ¡2KÎ·1+1(4Î·2Î·3)âˆ’Î·1+12logâ¡Î·2Î·3log2K_Î·_1+1(âˆš(4Î·_2Î·_3))-Î·_1+1/2logÎ·_2/Î·_3

logâ¡2Kp(ab)âˆ’p2logâ¡ablog2K_p(âˆš(ab))-p/2loga/b


scaled inverse chi-squared distribution
Î½,Ïƒ2Î½,
sigma^2

[âˆ’Î½2âˆ’1âˆ’Î½Ïƒ22][  -Î½2-1; -Î½Ïƒ^22 ]

[âˆ’2(Î·1+1)Î·2Î·1+1][ -2(Î·_1+1);  Î·_2Î·_1+1 ]

11

[logâ¡x1x][    ; 1/x ]

logâ¡Î“(âˆ’Î·1âˆ’1)âˆ’(âˆ’Î·1âˆ’1)logâ¡(âˆ’Î·2)logÎ“(-Î·_1-1)-(-Î·_1-1)log(-Î·_2)

logâ¡Î“(Î½2)âˆ’Î½2logâ¡Î½Ïƒ22logÎ“(Î½/2)-Î½/2logÎ½Ïƒ^2/2


beta distribution(variant 1)
Î±,Î²Î±,
beta

[Î±Î²][ Î±; Î² ]

[Î·1Î·2][ Î·_1; Î·_2 ]

1x(1âˆ’x)1/x(1-x)

[logâ¡xlogâ¡(1âˆ’x)][         ; log(1-x) ]

logâ¡Î“(Î·1)+logâ¡Î“(Î·2)âˆ’logâ¡Î“(Î·1+Î·2)logÎ“(Î·_1)+logÎ“(Î·_2)-logÎ“(Î·_1+Î·_2)

logâ¡Î“(Î±)+logâ¡Î“(Î²)âˆ’logâ¡Î“(Î±+Î²)logÎ“(Î±)+logÎ“(Î²)-logÎ“(Î±+Î²)


beta distribution(variant 2)
Î±,Î²Î±,
beta

[Î±âˆ’1Î²âˆ’1][ Î±-1; Î²-1 ]

[Î·1+1Î·2+1][ Î·_1+1; Î·_2+1 ]

11

[logâ¡xlogâ¡(1âˆ’x)][         ; log(1-x) ]

logâ¡Î“(Î·1+1)+logâ¡Î“(Î·2+1)âˆ’logâ¡Î“(Î·1+Î·2+2)logÎ“(Î·_1+1)+logÎ“(Î·_2+1)-logÎ“(Î·_1+Î·_2+2)

logâ¡Î“(Î±)+logâ¡Î“(Î²)âˆ’logâ¡Î“(Î±+Î²)logÎ“(Î±)+logÎ“(Î²)-logÎ“(Î±+Î²)


multivariate normal distribution
Î¼,Î£Î¼,{Î£

[Î£âˆ’1Î¼âˆ’12Î£âˆ’1][    Î£^-1Î¼; -1/2Î£^-1 ]

[âˆ’12Î·2âˆ’1Î·1âˆ’12Î·2âˆ’1][ -1/2Î·_2^-1Î·_1;    -1/2Î·_2^-1 ]

(2Ï€)âˆ’k2(2Ï€)^-k/2

[xxxT][    ğ±; ğ±ğ±^ğ–³ ]

âˆ’14Î·1TÎ·2âˆ’1Î·1âˆ’12logâ¡|âˆ’2Î·2|-1/4Î·_1^ğ–³Î·_2^-1Î·_1-1/2log|-2Î·_2|

12Î¼TÎ£âˆ’1Î¼+12logâ¡|Î£|1/2Î¼^ğ–³Î£^-1Î¼+1/2log|Î£|


categorical distribution(variant 1)
p1,â€¦,pk_1,
ldots, p_kwhere âˆ‘i=1kpi=1âˆ‘_i=1^kp_i=1

[logâ¡p1â‹®logâ¡pk][ _1;  â‹®; _k ]

[eÎ·1â‹®eÎ·k][ e^Î·_1;     â‹®; e^Î·_k ] where âˆ‘i=1keÎ·i=1âˆ‘_i=1^ke^Î·_i=1

11

[[x=1]â‹®[x=k]][ [x=1];     â‹®; [x=k] ]
[x=i][x=i] is the Iverson bracket*

00

00


categorical distribution(variant 2)
p1,â€¦,pk_1,
ldots, p_kwhere âˆ‘i=1kpi=1âˆ‘_i=1^kp_i=1

[logâ¡p1+Câ‹®logâ¡pk+C][ _1+C;    â‹®; _k+C ]

[1CeÎ·1â‹®1CeÎ·k]=[ 1Ce^Î·_1;       â‹®; 1Ce^Î·_k ]=
[eÎ·1âˆ‘i=1keÎ·iâ‹®eÎ·kâˆ‘i=1keÎ·i][ e^Î·_1âˆ‘_i=1^ke^Î·_i;                 â‹®; e^Î·_kâˆ‘_i=1^ke^Î·_i ]
where âˆ‘i=1keÎ·i=Câˆ‘_i=1^ke^Î·_i=C


11

[[x=1]â‹®[x=k]][ [x=1];     â‹®; [x=k] ]
[x=i][x=i] is the Iverson bracket*

00

00


categorical distribution(variant 3)
p1,â€¦,pk_1,
ldots, p_kwhere pk=1âˆ’âˆ‘i=1kâˆ’1pi_k=1-âˆ‘_i=1^k-1p_i

[logâ¡p1pkâ‹®logâ¡pkâˆ’1pk0]=[   logp_1p_k;           â‹®; logp_k-1p_k;           0 ]=[logâ¡p11âˆ’âˆ‘i=1kâˆ’1piâ‹®logâ¡pkâˆ’11âˆ’âˆ‘i=1kâˆ’1pi0][   logp_11-âˆ‘_i=1^k-1p_i;                      â‹®; logp_k-11-âˆ‘_i=1^k-1p_i;                      0 ]
This is the inverse softmax function, a generalization of the logit function.

[eÎ·1âˆ‘i=1keÎ·iâ‹®eÎ·kâˆ‘i=1keÎ·i]=[ e^Î·_1âˆ‘_i=1^ke^Î·_i;                 â‹®; e^Î·_kâˆ‘_i=1^ke^Î·_i ]=
[eÎ·11+âˆ‘i=1kâˆ’1eÎ·iâ‹®eÎ·kâˆ’11+âˆ‘i=1kâˆ’1eÎ·i11+âˆ‘i=1kâˆ’1eÎ·i][   e^Î·_11+âˆ‘_i=1^k-1e^Î·_i;                       â‹®; e^Î·_k-11+âˆ‘_i=1^k-1e^Î·_i;       11+âˆ‘_i=1^k-1e^Î·_i ]

This is the softmax function, a generalization of the logistic function.

11

[[x=1]â‹®[x=k]][ [x=1];     â‹®; [x=k] ]
[x=i][x=i] is the Iverson bracket*

logâ¡(âˆ‘i=1keÎ·i)=logâ¡(1+âˆ‘i=1kâˆ’1eÎ·i)log(âˆ‘_i=1^ke^Î·_i)=log(1+âˆ‘_i=1^k-1e^Î·_i)

âˆ’logâ¡pk=âˆ’logâ¡(1âˆ’âˆ‘i=1kâˆ’1pi)-_k=-log(1-âˆ‘_i=1^k-1p_i)


multinomial distribution(variant 1)with known number of trials n
p1,â€¦,pk_1,
ldots, p_kwhere âˆ‘i=1kpi=1âˆ‘_i=1^kp_i=1

[logâ¡p1â‹®logâ¡pk][ _1;  â‹®; _k ]

[eÎ·1â‹®eÎ·k][ e^Î·_1;     â‹®; e^Î·_k ]where âˆ‘i=1keÎ·i=1âˆ‘_i=1^ke^Î·_i=1

n!âˆi=1kxi!n!/âˆ_i=1^kx_i!

[x1â‹®xk][ x_1;   â‹®; x_k ]

00

00


multinomial distribution(variant 2)with known number of trials n
p1,â€¦,pk_1,
ldots, p_kwhere âˆ‘i=1kpi=1âˆ‘_i=1^kp_i=1

[logâ¡p1+Câ‹®logâ¡pk+C][ _1+C;    â‹®; _k+C ]

[1CeÎ·1â‹®1CeÎ·k]=[ 1Ce^Î·_1;       â‹®; 1Ce^Î·_k ]=
[eÎ·1âˆ‘i=1keÎ·iâ‹®eÎ·kâˆ‘i=1keÎ·i][ e^Î·_1âˆ‘_i=1^ke^Î·_i;                 â‹®; e^Î·_kâˆ‘_i=1^ke^Î·_i ]
where âˆ‘i=1keÎ·i=Câˆ‘_i=1^ke^Î·_i=C


n!âˆi=1kxi!n!/âˆ_i=1^kx_i!

[x1â‹®xk][ x_1;   â‹®; x_k ]

00

00


multinomial distribution(variant 3)with known number of trials n

p1,â€¦,pk_1,
ldots, p_kwhere pk=1âˆ’âˆ‘i=1kâˆ’1pi_k=1-âˆ‘_i=1^k-1p_i

[logâ¡p1pkâ‹®logâ¡pkâˆ’1pk0]=[   logp_1p_k;           â‹®; logp_k-1p_k;           0 ]=[logâ¡p11âˆ’âˆ‘i=1kâˆ’1piâ‹®logâ¡pkâˆ’11âˆ’âˆ‘i=1kâˆ’1pi0][   logp_11-âˆ‘_i=1^k-1p_i;                      â‹®; logp_k-11-âˆ‘_i=1^k-1p_i;                      0 ]

[eÎ·1âˆ‘i=1keÎ·iâ‹®eÎ·kâˆ‘i=1keÎ·i]=[ e^Î·_1âˆ‘_i=1^ke^Î·_i;                 â‹®; e^Î·_kâˆ‘_i=1^ke^Î·_i ]=
[eÎ·11+âˆ‘i=1kâˆ’1eÎ·iâ‹®eÎ·kâˆ’11+âˆ‘i=1kâˆ’1eÎ·i11+âˆ‘i=1kâˆ’1eÎ·i][   e^Î·_11+âˆ‘_i=1^k-1e^Î·_i;                       â‹®; e^Î·_k-11+âˆ‘_i=1^k-1e^Î·_i;       11+âˆ‘_i=1^k-1e^Î·_i ]


n!âˆi=1kxi!n!/âˆ_i=1^kx_i!

[x1â‹®xk][ x_1;   â‹®; x_k ]

nlogâ¡(âˆ‘i=1keÎ·i)=nlogâ¡(1+âˆ‘i=1kâˆ’1eÎ·i)log(âˆ‘_i=1^ke^Î·_i)=nlog(1+âˆ‘_i=1^k-1e^Î·_i)

âˆ’nlogâ¡pk=âˆ’nlogâ¡(1âˆ’âˆ‘i=1kâˆ’1pi)-n_k=-nlog(1-âˆ‘_i=1^k-1p_i)


Dirichlet distribution(variant 1)
Î±1,â€¦,Î±kÎ±_1,
ldots, Î±_k

[Î±1â‹®Î±k][ Î±_1;   â‹®; Î±_k ]

[Î·1â‹®Î·k][ Î·_1;   â‹®; Î·_k ]

1âˆi=1kxi1/âˆ_i=1^kx_i

[logâ¡x1â‹®logâ¡xk][ _1;  â‹®; _k ]

âˆ‘i=1klogâ¡Î“(Î·i)âˆ’logâ¡Î“(âˆ‘i=1kÎ·i)âˆ‘_i=1^klogÎ“(Î·_i)-logÎ“(âˆ‘_i=1^kÎ·_i)

âˆ‘i=1klogâ¡Î“(Î±i)âˆ’logâ¡Î“(âˆ‘i=1kÎ±i)âˆ‘_i=1^klogÎ“(Î±_i)-logÎ“(âˆ‘_i=1^kÎ±_i)


Dirichlet distribution(variant 2)
Î±1,â€¦,Î±kÎ±_1,
ldots, Î±_k

[Î±1âˆ’1â‹®Î±kâˆ’1][ Î±_1-1;     â‹®; Î±_k-1 ]

[Î·1+1â‹®Î·k+1][ Î·_1+1;     â‹®; Î·_k+1 ]

11

[logâ¡x1â‹®logâ¡xk][ _1;  â‹®; _k ]

âˆ‘i=1klogâ¡Î“(Î·i+1)âˆ’logâ¡Î“(âˆ‘i=1k(Î·i+1))âˆ‘_i=1^klogÎ“(Î·_i+1)-logÎ“(âˆ‘_i=1^k(Î·_i+1))

âˆ‘i=1klogâ¡Î“(Î±i)âˆ’logâ¡Î“(âˆ‘i=1kÎ±i)âˆ‘_i=1^klogÎ“(Î±_i)-logÎ“(âˆ‘_i=1^kÎ±_i)


Wishart distribution
V,nğ•,

[âˆ’12Vâˆ’1nâˆ’pâˆ’12][ -1/2ğ•^-1;   n-p-12 ]

[âˆ’12Î·1âˆ’12Î·2+p+1][ -1/2Î·_1^-1;   2Î·_2+p+1 ]

11

[Xlogâ¡|X|][      ğ—; log|ğ—| ]

âˆ’(Î·2+p+12)logâ¡|âˆ’Î·1|-(Î·_2+p+1/2)log|-Î·_1|
Â Â Â Â Â Â +logâ¡Î“p(Î·2+p+12)=+logÎ“_p(Î·_2+p+1/2)=
âˆ’n2logâ¡|âˆ’Î·1|+logâ¡Î“p(n2)=-n/2log|-Î·_1|+logÎ“_p(n/2)=
(Î·2+p+12)(plogâ¡2+logâ¡|V|)(Î·_2+p+1/2)(plog2+log|ğ•|)
Â Â Â Â Â Â +logâ¡Î“p(Î·2+p+12)+logÎ“_p(Î·_2+p+1/2)

Three variants with different parameterizations are given, to facilitate computing moments of the sufficient statistics.

n2(plogâ¡2+logâ¡|V|)+logâ¡Î“p(n2)n/2(plog2+log|ğ•|)+logÎ“_p(n/2)


Note: Uses the fact that tr(ATB)=vecâ¡(A)â‹…vecâ¡(B),tr(ğ€^ğ–³ğ)=vec(ğ€)Â·vec(ğ), i.e. the trace of a matrix product is much like a dot product. The matrix parameters are assumed to be vectorized (laid out in a vector) when inserted into the exponential form. Also, Vğ• and Xğ— are symmetric, so e.g. VT=V.ğ•^ğ–³=ğ•


inverse Wishart distribution
Î¨,mÎ¨, m

[âˆ’12Î¨âˆ’m+p+12][   -1/2Î¨; -m+p+12 ]

[âˆ’2Î·1âˆ’(2Î·2+p+1)][       -2Î·_1; -(2Î·_2+p+1) ]

11

[Xâˆ’1logâ¡|X|][   ğ—^-1; log|ğ—| ]

(Î·2+p+12)logâ¡|âˆ’Î·1|(Î·_2+p+1/2)log|-Î·_1|
Â Â Â Â Â Â +logâ¡Î“p(âˆ’(Î·2+p+12))=+logÎ“_p(-(Î·_2+p+1/2))=
âˆ’m2logâ¡|âˆ’Î·1|+logâ¡Î“p(m2)=-m/2log|-Î·_1|+logÎ“_p(m/2)=
âˆ’(Î·2+p+12)(plogâ¡2âˆ’logâ¡|Î¨|)-(Î·_2+p+1/2)(plog2-log|Î¨|)
Â Â Â Â Â Â +logâ¡Î“p(âˆ’(Î·2+p+12))+logÎ“_p(-(Î·_2+p+1/2))


m2(plogâ¡2âˆ’logâ¡|Î¨|)+logâ¡Î“p(m2)m/2(plog2-log|Î¨|)+logÎ“_p(m/2)


normal-gamma distribution
Î±,Î²,Î¼,Î»Î±,
beta,
mu,
lambda

[Î±âˆ’12âˆ’Î²âˆ’Î»Î¼22Î»Î¼âˆ’Î»2][    Î±-1/2; -Î²-Î»Î¼^22;       Î»Î¼;      -Î»2 ]

[Î·1+12âˆ’Î·2+Î·324Î·4âˆ’Î·32Î·4âˆ’2Î·4][        Î·_1+1/2; -Î·_2+Î·_3^24Î·_4;       -Î·_32Î·_4;          -2Î·_4 ]

12Ï€1âˆš(2Ï€)

[logâ¡Ï„Ï„Ï„xÏ„x2][ logÏ„;    Ï„;     ;   ^2 ]

logâ¡Î“(Î·1+12)âˆ’12logâ¡(âˆ’2Î·4)logÎ“(Î·_1+1/2)-1/2log(-2Î·_4)
Â Â Â Â Â Â âˆ’(Î·1+12)logâ¡(âˆ’Î·2+Î·324Î·4)-(Î·_1+1/2)log(-Î·_2+Î·_3^24Î·_4)


logâ¡Î“(Î±)âˆ’Î±logâ¡Î²âˆ’12logâ¡Î»logÎ“(Î±)-Î±logÎ²-1/2logÎ»

* The Iverson bracket is a generalization of the discrete delta-function: If the bracketed expression is true, the bracket has value 1; if the enclosed statement is false, the Iverson bracket is zero. There are many variant notations, e.g. wavey brackets: â§™a=bâ§˜ is equivalent to the [a=b] notation used above.
The three variants of the categorical distribution and multinomial distribution are due to the fact that the parameters pi_i are constrained, such that

âˆ‘i=1kpi=1.âˆ‘_i=1^kp_i=1Â .
Thus, there are only kâˆ’1-1 independent parameters.

Variant 1 uses k natural parameters with a simple relation between the standard and natural parameters; however, only kâˆ’1-1 of the natural parameters are independent, and the set of k natural parameters is nonidentifiable.  The constraint on the usual parameters translates to a similar constraint on the natural parameters.
Variant 2 demonstrates the fact that the entire set of natural parameters is nonidentifiable: Adding any constant value to the natural parameters has no effect on the resulting distribution. However, by using the constraint on the natural parameters, the formula for the normal parameters in terms of the natural parameters can be written in a way that is independent on the constant that is added.
Variant 3 shows how to make the parameters identifiable in a convenient way by setting C=âˆ’logâ¡pk.=-_k This effectively "pivots" around pk_k and causes the last natural parameter to have the constant value of 0. All the remaining formulas are written in a way that does not access pk_k}, so that effectively the model has only kâˆ’1-1 parameters, both of the usual and natural kind.
Variants 1 and 2 are not actually standard exponential families at all. Rather they are curved exponential families, i.e. there are kâˆ’1-1 independent parameters embedded in a k-dimensional parameter space.[13] Many of the standard results for exponential families do not apply to curved exponential families. An example is the log-partition function A(x)(x)}, which has the value of 0 in the curved cases. In standard exponential families, the derivatives of this function correspond to the moments (more technically, the cumulants) of the sufficient statistics, e.g. the mean and variance. However, a value of 0 suggests that the mean and variance of all the sufficient statistics are uniformly 0, whereas in fact the mean of the ith sufficient statistic should be pi_i}. (This does emerge correctly when using the form of A(x)(x)} shown in variant 3.)

Moments and cumulants of the sufficient statistic[edit]
Normalization of the distribution[edit]
We start with the normalization of the probability distribution. In general, any non-negative function f(x) that serves as the kernel of a probability distribution (the part encoding all dependence on x) can be made into a proper distribution by normalizing: i.e.

p(x)=1Zf(x)(x)=1/Zf(x)
where

Z=âˆ«xf(x)dx.=âˆ«_xf(x) dx.
The factor Z is sometimes termed the normalizer or partition function, based on an analogy to statistical physics.
In the case of an exponential family where 

p(x;Î·)=g(Î·)h(x)eÎ·â‹…T(x),(x;Î·)=g(Î·)h(x)e^Î·Â·ğ“(x),
the kernel is

K(x)=h(x)eÎ·â‹…T(x)(x)=h(x)e^Î·Â·ğ“(x)
and the partition function is

Z=âˆ«xh(x)eÎ·â‹…T(x)dx.=âˆ«_xh(x)e^Î·Â·ğ“(x) dx.
Since the distribution must be normalized, we have

1=âˆ«xg(Î·)h(x)eÎ·â‹…T(x)dx=g(Î·)âˆ«xh(x)eÎ·â‹…T(x)dx=g(Î·)Z.1=âˆ«_xg(Î·)h(x)e^Î·Â·ğ“(x) dx=g(Î·)âˆ«_xh(x)e^Î·Â·ğ“(x) dx=g(Î·)Z.
In other words,

g(Î·)=1Z(Î·)=1/Z
or equivalently

A(Î·)=âˆ’logâ¡g(Î·)=logâ¡Z.(Î·)=-(Î·)=.
This justifies calling A the log-normalizer or log-partition function.

Moment-generating function of the sufficient statistic[edit]
Now, the moment-generating function of T(x) is

MT(u)â‰¡E[euâŠ¤T(x)âˆ£Î·]=âˆ«xh(x)e(Î·+u)âŠ¤T(x)âˆ’A(Î·)dx=eA(Î·+u)âˆ’A(Î·)_T(u)[e^u^âŠ¤T(x)|Î·]=âˆ«_xh(x)e^(Î·+u)^âŠ¤T(x)-A(Î·) dx=e^A(Î·+u)-A(Î·)
proving the earlier statement that

K(uâˆ£Î·)=A(Î·+u)âˆ’A(Î·)(u|Î·)=A(Î·+u)-A(Î·)
is the cumulant generating function for T.
An important subclass of exponential families are the natural exponential families, which have a similar form for the moment-generating function for the distribution of x.

Differential identities for cumulants[edit]
In particular, using the properties of the cumulant generating function,

Eâ¡(Tj)=âˆ‚A(Î·)âˆ‚Î·jE(T_j)=(Î·)/âˆ‚Î·_j
and

covâ¡(Ti,Tj)=âˆ‚2A(Î·)âˆ‚Î·iâˆ‚Î·j.cov(T_i,_j)=âˆ‚^2A(Î·)/âˆ‚Î·_i âˆ‚Î·_j.
The first two raw moments and all mixed second moments can be recovered from these two identities. Higher-order moments and cumulants are obtained by higher derivatives. This technique is often useful when T is a complicated function of the data, whose moments are difficult to calculate by integration.
Another way to see this that does not rely on the theory of cumulants is to begin from the fact that the distribution of an exponential family must be normalized, and differentiate.  We illustrate using the simple case of a one-dimensional parameter, but an analogous derivation holds more generally.
In the one-dimensional case, we have

p(x)=g(Î·)h(x)eÎ·T(x).(x)=g(Î·)h(x)e^(x).
This must be normalized, so

1=âˆ«xp(x)dx=âˆ«xg(Î·)h(x)eÎ·T(x)dx=g(Î·)âˆ«xh(x)eÎ·T(x)dx.1=âˆ«_xp(x) dx=âˆ«_xg(Î·)h(x)e^(x) dx=g(Î·)âˆ«_xh(x)e^(x) dx.
Take the derivative of both sides with respect to Î·:

0=g(Î·)ddÎ·âˆ«xh(x)eÎ·T(x)dx+gâ€²(Î·)âˆ«xh(x)eÎ·T(x)dx=g(Î·)âˆ«xh(x)(ddÎ·eÎ·T(x))dx+gâ€²(Î·)âˆ«xh(x)eÎ·T(x)dx=g(Î·)âˆ«xh(x)eÎ·T(x)T(x)dx+gâ€²(Î·)âˆ«xh(x)eÎ·T(x)dx=âˆ«xT(x)g(Î·)h(x)eÎ·T(x)dx+gâ€²(Î·)g(Î·)âˆ«xg(Î·)h(x)eÎ·T(x)dx=âˆ«xT(x)p(x)dx+gâ€²(Î·)g(Î·)âˆ«xp(x)dx=Eâ¡[T(x)]+gâ€²(Î·)g(Î·)=Eâ¡[T(x)]+ddÎ·logâ¡g(Î·)0   =g(Î·)d/dÎ·âˆ«_xh(x)e^(x) dx+g'(Î·)âˆ«_xh(x)e^(x) dx
   =g(Î·)âˆ«_xh(x)(d/dÎ·e^(x)) dx+g'(Î·)âˆ«_xh(x)e^(x) dx
   =g(Î·)âˆ«_xh(x)e^(x)T(x) dx+g'(Î·)âˆ«_xh(x)e^(x) dx
   =âˆ«_xT(x)g(Î·)h(x)e^(x) dx+g'(Î·)/g(Î·)âˆ«_xg(Î·)h(x)e^(x) dx
   =âˆ«_xT(x)p(x) dx+g'(Î·)/g(Î·)âˆ«_xp(x) dx
   =E[T(x)]+g'(Î·)/g(Î·)
   =E[T(x)]+d/dÎ·(Î·)
Therefore,

Eâ¡[T(x)]=âˆ’ddÎ·logâ¡g(Î·)=ddÎ·A(Î·).E[T(x)]=-d/dÎ·(Î·)=d/dÎ·A(Î·).
Example 1[edit]
As an introductory example, consider the gamma distribution, whose distribution is defined by

p(x)=Î²Î±Î“(Î±)xÎ±âˆ’1eâˆ’Î²x.(x)=Î²^Î±/Î“(Î±)x^Î±-1e^-.
Referring to the above table, we can see that the natural parameter is given by

Î·1=Î±âˆ’1,Î·_1=Î±-1,
Î·2=âˆ’Î²,Î·_2=-Î²,
the reverse substitutions are

Î±=Î·1+1,Î±=Î·_1+1,
Î²=âˆ’Î·2,Î²=-Î·_2,
the sufficient statistics are (logâ¡x,x),(,x), and the log-partition function is

A(Î·1,Î·2)=logâ¡Î“(Î·1+1)âˆ’(Î·1+1)logâ¡(âˆ’Î·2).(Î·_1,Î·_2)=logÎ“(Î·_1+1)-(Î·_1+1)log(-Î·_2).
We can find the mean of the sufficient statistics as follows.  First, for Î·1:

Eâ¡[logâ¡x]=âˆ‚A(Î·1,Î·2)âˆ‚Î·1=âˆ‚âˆ‚Î·1(logâ¡Î“(Î·1+1)âˆ’(Î·1+1)logâ¡(âˆ’Î·2))=Ïˆ(Î·1+1)âˆ’logâ¡(âˆ’Î·2)=Ïˆ(Î±)âˆ’logâ¡Î²,E[]   =(Î·_1,Î·_2)/âˆ‚Î·_1=âˆ‚/âˆ‚Î·_1(logÎ“(Î·_1+1)-(Î·_1+1)log(-Î·_2))
   =Ïˆ(Î·_1+1)-log(-Î·_2)
   =Ïˆ(Î±)-logÎ²,
Where Ïˆ(x)Ïˆ(x) is the digamma function (derivative of log gamma), and we used the reverse substitutions in the last step.
Now, for Î·2:

Eâ¡[x]=âˆ‚A(Î·1,Î·2)âˆ‚Î·2=âˆ‚âˆ‚Î·2(logâ¡Î“(Î·1+1)âˆ’(Î·1+1)logâ¡(âˆ’Î·2))=âˆ’(Î·1+1)1âˆ’Î·2(âˆ’1)=Î·1+1âˆ’Î·2=Î±Î²,E[x]   =(Î·_1,Î·_2)/âˆ‚Î·_2=âˆ‚/âˆ‚Î·_2(logÎ“(Î·_1+1)-(Î·_1+1)log(-Î·_2))
   =-(Î·_1+1)1/-Î·_2(-1)=Î·_1+1/-Î·_2
   =Î±/Î²,
again making the reverse substitution in the last step.
To compute the variance of x, we just differentiate again:

Varâ¡(x)=âˆ‚2A(Î·1,Î·2)âˆ‚Î·22=âˆ‚âˆ‚Î·2Î·1+1âˆ’Î·2=Î·1+1Î·22=Î±Î²2.Var(x)   =âˆ‚^2A(Î·_1,Î·_2)/âˆ‚Î·_2^2=âˆ‚/âˆ‚Î·_2Î·_1+1/-Î·_2
   =Î·_1+1/Î·_2^2
   =Î±/Î²^2.
All of these calculations can be done using integration, making use of various properties of the gamma function, but this requires significantly more work.

Example 2[edit]
As another example consider a real valued random variable X with density

pÎ¸(x)=Î¸eâˆ’x(1+eâˆ’x)Î¸+1_Î¸(x)=^-x/(1+e^-x)^Î¸+1
indexed by shape parameter Î¸âˆˆ(0,âˆ)Î¸âˆˆ(0,âˆ) (this is called the skew-logistic distribution). The density can be rewritten as

eâˆ’x1+eâˆ’xexpâ¡(âˆ’Î¸logâ¡(1+eâˆ’x)+logâ¡(Î¸))e^-x/1+e^-xexp(-Î¸log(1+e^-x)+log(Î¸))
Notice this is an exponential family with natural parameter

Î·=âˆ’Î¸,Î·=-Î¸,
sufficient statistic

T=logâ¡(1+eâˆ’x),=log(1+e^-x),
and log-partition function

A(Î·)=âˆ’logâ¡(Î¸)=âˆ’logâ¡(âˆ’Î·)(Î·)=-log(Î¸)=-log(-Î·)
So using the first identity,

Eâ¡(logâ¡(1+eâˆ’X))=Eâ¡(T)=âˆ‚A(Î·)âˆ‚Î·=âˆ‚âˆ‚Î·[âˆ’logâ¡(âˆ’Î·)]=1âˆ’Î·=1Î¸,E(log(1+e^-X))=E(T)=(Î·)/âˆ‚Î·=âˆ‚/âˆ‚Î·[-log(-Î·)]=1/-Î·=1/Î¸,
and using the second identity

varâ¡(logâ¡(1+eâˆ’X))=âˆ‚2A(Î·)âˆ‚Î·2=âˆ‚âˆ‚Î·[1âˆ’Î·]=1(âˆ’Î·)2=1Î¸2.var(log(1+e^-X))=âˆ‚^2A(Î·)/âˆ‚Î·^2=âˆ‚/âˆ‚Î·[1/-Î·]=1/(-Î·)^2=1/Î¸^2.
This example illustrates a case where using this method is very simple, but the direct calculation would be nearly impossible.

Example 3[edit]
The final example is one where integration would be extremely difficult.  This is the case of the Wishart distribution, which is defined over matrices.  Even taking derivatives is a bit tricky, as it involves matrix calculus, but the respective identities are listed in that article.
From the above table, we can see that the natural parameter is given by

Î·1=âˆ’12Vâˆ’1,Î·_1=-1/2ğ•^-1,
Î·2=nâˆ’pâˆ’12,Î·_2=n-p-1/2,
the reverse substitutions are

V=âˆ’12Î·1âˆ’1,ğ•=-1/2Î·_1^-1,
n=2Î·2+p+1,=2Î·_2+p+1,
and the sufficient statistics are (X,logâ¡|X|).(ğ—,log|ğ—|).
The log-partition function is written in various forms in the table, to facilitate differentiation and back-substitution.  We use the following forms:

A(Î·1,n)=âˆ’n2logâ¡|âˆ’Î·1|+logâ¡Î“p(n2),(Î·_1,n)=-n/2log|-Î·_1|+logÎ“_p(n/2),
A(V,Î·2)=(Î·2+p+12)(plogâ¡2+logâ¡|V|)+logâ¡Î“p(Î·2+p+12).(ğ•,Î·_2)=(Î·_2+p+1/2)(plog2+log|ğ•|)+logÎ“_p(Î·_2+p+1/2).
Expectation of X (associated with Î·1)
To differentiate with respect to Î·1, we need the following matrix calculus identity:

âˆ‚logâ¡|aX|âˆ‚X=(Xâˆ’1)Tâˆ‚log|ağ—|/âˆ‚ğ—=(ğ—^-1)^T
Then:

Eâ¡[X]=âˆ‚A(Î·1,â€¦)âˆ‚Î·1=âˆ‚âˆ‚Î·1[âˆ’n2logâ¡|âˆ’Î·1|+logâ¡Î“p(n2)]=âˆ’n2(Î·1âˆ’1)T=n2(âˆ’Î·1âˆ’1)T=n(V)T=nVE[ğ—]   =(Î·_1,â€¦)/âˆ‚Î·_1
   =âˆ‚/âˆ‚Î·_1[-n/2log|-Î·_1|+logÎ“_p(n/2)]
   =-n/2(Î·_1^-1)^T
   =n/2(-Î·_1^-1)^T
   =n(ğ•)^T
   =nğ•
The last line uses the fact that V is symmetric, and therefore it is the same when transposed.

Expectation of log |X| (associated with Î·2)
Now, for Î·2, we first need to expand the part of the log-partition function that involves the multivariate gamma function:

logâ¡Î“p(a)=logâ¡(Ï€p(pâˆ’1)4âˆj=1pÎ“(a+1âˆ’j2))=p(pâˆ’1)4logâ¡Ï€+âˆ‘j=1plogâ¡Î“[a+1âˆ’j2]logÎ“_p(a)=log(Ï€^p(p-1)/4âˆ_j=1^pÎ“(a+1-j/2))=p(p-1)/4logÏ€+âˆ‘_j=1^plogÎ“[a+1-j/2]
We also need the digamma function:

Ïˆ(x)=ddxlogâ¡Î“(x).Ïˆ(x)=d/dxlogÎ“(x).
Then:

Eâ¡[logâ¡|X|]=âˆ‚A(â€¦,Î·2)âˆ‚Î·2=âˆ‚âˆ‚Î·2[âˆ’(Î·2+p+12)(plogâ¡2+logâ¡|V|)+logâ¡Î“p(Î·2+p+12)]=âˆ‚âˆ‚Î·2[(Î·2+p+12)(plogâ¡2+logâ¡|V|)+p(pâˆ’1)4logâ¡Ï€+âˆ‘j=1plogâ¡Î“(Î·2+p+12+1âˆ’j2)]=plogâ¡2+logâ¡|V|+âˆ‘j=1pÏˆ(Î·2+p+12+1âˆ’j2)=plogâ¡2+logâ¡|V|+âˆ‘j=1pÏˆ(nâˆ’pâˆ’12+p+12+1âˆ’j2)=plogâ¡2+logâ¡|V|+âˆ‘j=1pÏˆ(n+1âˆ’j2)E[log|ğ—|]   =(â€¦,Î·_2)/âˆ‚Î·_2
   =âˆ‚/âˆ‚Î·_2[-(Î·_2+p+1/2)(plog2+log|ğ•|)+logÎ“_p(Î·_2+p+1/2)]
   =âˆ‚/âˆ‚Î·_2[(Î·_2+p+1/2)(plog2+log|ğ•|)+p(p-1)/4logÏ€+âˆ‘_j=1^plogÎ“(Î·_2+p+1/2+1-j/2)]
   =plog2+log|ğ•|+âˆ‘_j=1^pÏˆ(Î·_2+p+1/2+1-j/2)
   =plog2+log|ğ•|+âˆ‘_j=1^pÏˆ(n-p-1/2+p+1/2+1-j/2)
   =plog2+log|ğ•|+âˆ‘_j=1^pÏˆ(n+1-j/2)
This latter formula is listed in the Wishart distribution article.  Both of these expectations are needed when deriving the variational Bayes update equations in a Bayes network involving a Wishart distribution (which is the conjugate prior of the multivariate normal distribution).
Computing these formulas using integration would be much more difficult.  The first one, for example, would require matrix integration.

Entropy[edit]
Relative entropy[edit]
The relative entropy (Kullbackâ€“Leibler divergence, KL divergence) of two distributions in an exponential family has a simple expression as the Bregman divergence between the natural parameters with respect to the log-normalizer.[14] The relative entropy is defined in terms of an integral, while the Bregman divergence is defined in terms of a derivative and inner product, and thus is easier to calculate and has a closed-form expression (assuming the derivative has a closed-form expression). Further, the Bregman divergence in terms of the natural parameters and the log-normalizer equals the Bregman divergence of the dual parameters (expectation parameters), in the opposite order, for the convex conjugate function.[15]
Fixing an exponential family with log-normalizer A (with convex conjugate Aâˆ—^*), writing PA,Î¸_A,Î¸ for the distribution in this family corresponding a fixed value of the natural parameter Î¸Î¸ (writing Î¸â€²Î¸' for another value, and with Î·,Î·â€²Î·,Î·' for the corresponding dual expectation/moment parameters), writing KL for the KL divergence, and BA_A for the Bregman divergence, the divergences are related as:

KL(PA,Î¸âˆ¥PA,Î¸â€²)=BA(Î¸â€²âˆ¥Î¸)=BAâˆ—(Î·âˆ¥Î·â€²).KL(P_A,Î¸_A,Î¸')=B_A(Î¸'âˆ¥Î¸)=B_A^*(Î·âˆ¥Î·').
The KL divergence is conventionally written with respect to the first parameter, while the Bregman divergence is conventionally written with respect to the second parameter, and thus this can be read as "the relative entropy is equal to the Bregman divergence defined by the log-normalizer on the swapped natural parameters", or equivalently as "equal to the Bregman divergence defined by the dual to the log-normalizer on the expectation parameters".

Maximum-entropy derivation[edit]
Exponential families arise naturally as the answer to the following question: what is the maximum-entropy distribution consistent with given constraints on expected values?
The information entropy of a probability distribution dF(x) can only be computed with respect to some other probability distribution (or, more generally, a positive measure), and both measures must be mutually absolutely continuous. Accordingly, we need to pick a reference measure dH(x) with the same support as dF(x).
The entropy of dF(x) relative to dH(x) is

S[dFâˆ£dH]=âˆ’âˆ«dFdHlogâ¡dFdHdH[dF]=-âˆ«dF/dHlogdF/dH dH
or

S[dFâˆ£dH]=âˆ«logâ¡dHdFdF[dF]=âˆ«logdH/dF dF
where dF/dH and dH/dF are Radonâ€“Nikodym derivatives. The ordinary definition of entropy for a discrete distribution supported on a set I, namely

S=âˆ’âˆ‘iâˆˆIpilogâ¡pi=-âˆ‘_ip_i_i
assumes, though this is seldom pointed out, that dH is chosen to be the counting measure on I.
Consider now a collection of observable quantities (random variables) Ti. The probability distribution dF whose entropy with respect to dH is greatest, subject to the conditions that the expected value of Ti be equal to ti, is an exponential family with dH as reference measure and (T1, ..., Tn) as sufficient statistic.
The derivation is a simple variational calculation using Lagrange multipliers. Normalization is imposed by letting T0 = 1 be one of the constraints. The natural parameters of the distribution are the Lagrange multipliers, and the normalization factor is the Lagrange multiplier associated to T0.
For examples of such derivations, see Maximum entropy probability distribution.

Role in statistics[edit]
Classical estimation: sufficiency[edit]
According to the Pitmanâ€“Koopmanâ€“Darmois theorem, among families of probability distributions whose domain does not vary with the parameter being estimated, only in exponential families is there a sufficient statistic whose dimension remains bounded as sample size increases.
Less tersely, suppose Xk, (where k = 1, 2, 3, ... n) are independent, identically distributed random variables. Only if their distribution is one of the exponential family of distributions is there a sufficient statistic T(X1, ..., Xn) whose number of scalar components does not increase as the sample size n increases; the statistic T may be a vector or a single scalar number, but whatever it is, its size will neither grow nor shrink when more data are obtained.
As a counterexample if these conditions are relaxed, the family of uniform distributions (either discrete or continuous, with either or both bounds unknown) has a sufficient statistic, namely the sample maximum, sample minimum, and sample size, but does not form an exponential family, as the domain varies with the parameters.

Bayesian estimation: conjugate distributions[edit]
Exponential families are also important in Bayesian statistics. In Bayesian statistics a prior distribution is multiplied by a likelihood function and then normalised to produce a posterior distribution. In the case of a likelihood which belongs to an exponential family there exists a conjugate prior, which is often also in an exponential family. A conjugate prior Ï€ for the parameter Î·Î· of an exponential family

f(xâˆ£Î·)=h(x)expâ¡(Î·TT(x)âˆ’A(Î·))(x|Î·)=h(x)exp(Î·^Tğ“(x)-A(Î·))
is given by

pÏ€(Î·âˆ£Ï‡,Î½)=f(Ï‡,Î½)expâ¡(Î·TÏ‡âˆ’Î½A(Î·)),_Ï€(Î·|Ï‡,Î½)=f(Ï‡,Î½)exp(Î·^TÏ‡-(Î·)),
or equivalently

pÏ€(Î·âˆ£Ï‡,Î½)=f(Ï‡,Î½)g(Î·)Î½expâ¡(Î·TÏ‡),Ï‡âˆˆRs_Ï€(Î·|Ï‡,Î½)=f(Ï‡,Î½)g(Î·)^Î½exp(Î·^TÏ‡),    Ï‡âˆˆâ„^s
where s is the dimension of Î·Î· and Î½>0Î½>0 and Ï‡Ï‡ are hyperparameters (parameters controlling parameters). Î½Î½ corresponds to the effective number of observations that the prior distribution contributes, and Ï‡Ï‡ corresponds to the total amount that these pseudo-observations contribute to the sufficient statistic over all observations and pseudo-observations. f(Ï‡,Î½)(Ï‡,Î½) is a normalization constant that is automatically determined by the remaining functions and serves to ensure that the given function is a probability density function (i.e. it is normalized). A(Î·)(Î·) and equivalently g(Î·)(Î·) are the same functions as in the definition of the distribution over which Ï€ is the conjugate prior.
A conjugate prior is one which, when combined with the likelihood and normalised, produces a posterior distribution which is of the same type as the prior. For example, if one is estimating the success probability of a binomial distribution, then if one chooses to use a beta distribution as one's prior, the posterior is another beta distribution. This makes the computation of the posterior particularly simple. Similarly, if one is estimating the parameter of a Poisson distribution the use of a gamma prior will lead to another gamma posterior. Conjugate priors are often very flexible and can be very convenient. However, if one's belief about the likely value of the theta parameter of a binomial is represented by (say) a bimodal (two-humped) prior distribution, then this cannot be represented by a beta distribution. It can however be represented by using a mixture density as the prior, here a combination of two beta distributions; this is a form of hyperprior.
An arbitrary likelihood will not belong to an exponential family, and thus in general no conjugate prior exists. The posterior will then have to be computed by numerical methods.
To show that the above prior distribution is a conjugate prior, we can derive the posterior.
First, assume that the probability of a single observation follows an exponential family, parameterized using its natural parameter:

pF(xâˆ£Î·)=h(x)g(Î·)expâ¡(Î·TT(x))_F(x|Î·)=h(x)g(Î·)exp(Î·^Tğ“(x))
Then, for data X=(x1,â€¦,xn)ğ—=(x_1,â€¦,x_n), the likelihood is computed as follows:

p(Xâˆ£Î·)=(âˆi=1nh(xi))g(Î·)nexpâ¡(Î·Tâˆ‘i=1nT(xi))(ğ—|Î·)=(âˆ_i=1^nh(x_i))g(Î·)^nexp(Î·^Tâˆ‘_i=1^nğ“(x_i))
Then, for the above conjugate prior:

pÏ€(Î·âˆ£Ï‡,Î½)=f(Ï‡,Î½)g(Î·)Î½expâ¡(Î·TÏ‡)âˆg(Î·)Î½expâ¡(Î·TÏ‡)p_Ï€(Î·|Ï‡,Î½)   =f(Ï‡,Î½)g(Î·)^Î½exp(Î·^TÏ‡)(Î·)^Î½exp(Î·^TÏ‡)
We can then compute the posterior as follows:

p(Î·âˆ£X,Ï‡,Î½)âˆp(Xâˆ£Î·)pÏ€(Î·âˆ£Ï‡,Î½)=(âˆi=1nh(xi))g(Î·)nexpâ¡(Î·Tâˆ‘i=1nT(xi))f(Ï‡,Î½)g(Î·)Î½expâ¡(Î·TÏ‡)âˆg(Î·)nexpâ¡(Î·Tâˆ‘i=1nT(xi))g(Î·)Î½expâ¡(Î·TÏ‡)âˆg(Î·)Î½+nexpâ¡(Î·T(Ï‡+âˆ‘i=1nT(xi)))p(Î·|ğ—,Ï‡,Î½)   (ğ—|Î·)p_Ï€(Î·|Ï‡,Î½)
   =(âˆ_i=1^nh(x_i))g(Î·)^nexp(Î·^Tâˆ‘_i=1^nğ“(x_i))f(Ï‡,Î½)g(Î·)^Î½exp(Î·^TÏ‡)
   (Î·)^nexp(Î·^Tâˆ‘_i=1^nğ“(x_i))g(Î·)^Î½exp(Î·^TÏ‡)
   (Î·)^Î½+nexp(Î·^T(Ï‡+âˆ‘_i=1^nğ“(x_i)))
The last line is the kernel of the posterior distribution, i.e.

p(Î·âˆ£X,Ï‡,Î½)=pÏ€(Î·|Ï‡+âˆ‘i=1nT(xi),Î½+n)(Î·|ğ—,Ï‡,Î½)=p_Ï€(Î·|Â Ï‡+âˆ‘_i=1^nğ“(x_i),Î½+n.)
This shows that the posterior has the same form as the prior.
The data X enters into this equation only in the expression

T(X)=âˆ‘i=1nT(xi),ğ“(ğ—)=âˆ‘_i=1^nğ“(x_i),
which is termed the sufficient statistic of the data.  That is, the value of the sufficient statistic is sufficient to completely determine the posterior distribution.  The actual data points themselves are not needed, and all sets of data points with the same sufficient statistic will have the same distribution.  This is important because the dimension of the sufficient statistic does not grow with the data size â€” it has only as many components as the components of Î·Î· (equivalently, the number of parameters of the distribution of a single data point).
The update equations are as follows:

Ï‡â€²=Ï‡+T(X)=Ï‡+âˆ‘i=1nT(xi)Î½â€²=Î½+nÏ‡'   =Ï‡+ğ“(ğ—)
   =Ï‡+âˆ‘_i=1^nğ“(x_i)
Î½'   =Î½+n
This shows that the update equations can be written simply in terms of the number of data points and the sufficient statistic of the data.  This can be seen clearly in the various examples of update equations shown in the conjugate prior page. Because of the way that the sufficient statistic is computed, it necessarily involves sums of components of the data (in some cases disguised as products or other forms â€” a product can be written in terms of a sum of logarithms). The cases where the update equations for particular distributions don't exactly match the above forms are cases where the conjugate prior has been expressed using a different parameterization than the one that produces a conjugate prior of the above form â€” often specifically because the above form is defined over the natural parameter Î·Î· while conjugate priors are usually defined over the actual parameter Î¸.Î¸.

Unbiased estimation[edit]
If the likelihood z|Î·âˆ¼eÎ·zf1(Î·)f0(z)|Î·^f_1(Î·)f_0(z) is an exponential family, then the unbiased estimator of Î·Î· is âˆ’ddzlnâ¡f0(z)-d/dz_0(z).[16]

Hypothesis testing: uniformly most powerful tests[edit]
Further information: Uniformly most powerful test
A one-parameter exponential family has a monotone non-decreasing likelihood ratio in the sufficient statistic T(x), provided that Î·(Î¸) is non-decreasing. As a consequence, there exists a uniformly most powerful test for testing the hypothesis H0: Î¸ â‰¥ Î¸0 vs. H1: Î¸ < Î¸0.

Generalized linear models[edit]
Exponential families form the basis for the distribution functions used in generalized linear models (GLM), a class of model that encompasses many of the commonly used regression models in statistics.  Examples include logistic regression using the binomial family and Poisson regression.

See also[edit]
Exponential dispersion model
Gibbs measure
Modified half-normal distribution
Natural exponential family
Footnotes[edit]


^ For example, the family of normal distributions includes the standard normal distribution N(0, 1) with mean 0 and variance 1, as well as other normal distributions with different mean and variance.

^ "Partition function" is often used in statistics as a synonym of "normalization factor".

^ These distributions are often not themselves exponential families. Common examples of non-exponential families arising from exponential ones are the Student's t-distribution, beta-binomial distribution and Dirichlet-multinomial distribution.


References[edit]
Citations[edit]


^ Kupperman, M. (1958). "Probabilities of hypotheses and information-statistics in sampling from exponential-class populations". Annals of Mathematical Statistics. 9 (2): 571â€“575. doi:10.1214/aoms/1177706633. JSTORÂ 2237349.

^ Andersen, Erling (September 1970). "Sufficiency and Exponential Families for Discrete Sample Spaces". Journal of the American Statistical Association. Journal of the American Statistical Association. 65 (331): 1248â€“1255. doi:10.2307/2284291. JSTORÂ 2284291. MRÂ 0268992.

^ Pitman, E.; Wishart, J. (1936). "Sufficient statistics and intrinsic accuracy". Mathematical Proceedings of the Cambridge Philosophical Society. 32 (4): 567â€“579. Bibcode:1936PCPS...32..567P. doi:10.1017/S0305004100019307. S2CIDÂ 120708376.

^ Darmois, G. (1935). "Sur les lois de probabilites a estimation exhaustive". C. R. Acad. Sci. Paris (in French). 200: 1265â€“1266.

^ Koopman, B. (1936). "On distribution admitting a sufficient statistic". Transactions of the American Mathematical Society. American Mathematical Society. 39 (3): 399â€“409. doi:10.2307/1989758. JSTORÂ 1989758. MRÂ 1501854.

^ "General Exponential Families". www.randomservices.org. Retrieved 2022-08-30.

^ Abramovich & Ritov (2013). Statistical Theory: A Concise Introduction. Chapman & Hall. ISBNÂ 978-1439851845.

^ Blei, David. "Variational Inference" (PDF). Princeton U.

^ Casella, George (2002). Statistical inference. Roger L. Berger (2ndÂ ed.). Australia: Thomson Learning. Theorem 6.2.25. ISBNÂ 0-534-24312-6. OCLCÂ 46538638.

^ Brown, Lawrence D. (1986). Fundamentals of statistical exponential familiesÂ : with applications in statistical decision theory. Hayward, Calif.: Institute of Mathematical Statistics. Theorem 2.12. ISBNÂ 0-940600-10-2. OCLCÂ 15986663.

^ Keener, Robert W. (2010). Theoretical statisticsÂ : topics for a core course. New York. pp.Â 47, Example 3.12. ISBNÂ 978-0-387-93839-4. OCLCÂ 676700036.{{cite book}}:  CS1 maint: location missing publisher (link)

^ Nielsen, Frank; Garcia, Vincent (2009). "Statistical exponential families: A digest with flash cards". arXiv:0911.4863 [cs.LG].

^ van Garderen, Kees Jan (1997). "Curved Exponential Models in Econometrics". Econometric Theory. 13 (6): 771â€“790. doi:10.1017/S0266466600006253. S2CIDÂ 122742807.

^ Nielsen & Nock 2010, 4. Bregman Divergences and Relative Entropy of Exponential Families.

^ Barndorff-Nielsen 1978, 9.1 Convex duality and exponential families.

^ Efron, Bradley (December 2011). "Tweedie's Formula and Selection Bias". Journal of the American Statistical Association. 106 (496): 1602â€“1614. doi:10.1198/jasa.2011.tm11181. ISSNÂ 0162-1459. PMCÂ 3325056. PMIDÂ 22505788.


This article includes a list of general references, but it lacks sufficient corresponding inline citations. Please help to improve this article by introducing more precise citations. (November 2010) (Learn how and when to remove this template message)
Sources[edit]

Barndorff-Nielsen, Ole (1978). Information and exponential families in statistical theory. Wiley Series in Probability and Mathematical Statistics. Chichester: John Wiley & Sons, Ltd. pp.Â ix+238 pp. ISBNÂ 0-471-99545-2. MRÂ 0489333.
Reprinted as Barndorff-Nielsen, Ole (2014). Information and exponential families in statistical theory. John Wiley & Sons, Ltd. doi:10.1002/9781118857281. ISBNÂ 978-111885750-2.
Nielsen, Frank; Garcia, Vincent (2009). "Statistical exponential families: A digest with flash cards". arXiv:0911.4863. Bibcode:2009arXiv0911.4863N.
Nielsen, Frank; Nock, Richard (2010). Entropies and cross-entropies of exponential families (PDF). IEEE International Conference on Image Processing. doi:10.1109/ICIP.2010.5652054. Archived from the original (PDF) on 2019-03-31.

Further reading[edit]
Fahrmeir, Ludwig; Tutz, G. (1994). Multivariate Statistical Modelling based on Generalized Linear Models. Springer. pp.Â 18â€“22, 345â€“349. ISBNÂ 0-387-94233-5.
Keener, Robert W. (2006). Theoretical Statistics: Topics for a Core Course. Springer. pp.Â 27â€“28, 32â€“33. ISBNÂ 978-0-387-93838-7.
Lehmann, E. L.; Casella, G. (1998). Theory of Point Estimation (2ndÂ ed.). sec. 1.5. ISBNÂ 0-387-98502-6.
External links[edit]
A primer on the exponential family of distributions
Exponential family of distributions on the Earliest known uses of some of the words of mathematics
jMEF: A Java library for exponential families Archived 2013-04-11 at archive.today
vteStatistics
Outline
Index
Descriptive statisticsContinuous dataCenter
Mean
Arithmetic
Arithmetic-Geometric
Cubic
Generalized/power
Geometric
Harmonic
Heronian
Heinz
Lehmer
Median
Mode
Dispersion
Average absolute deviation
Coefficient of variation
Interquartile range
Percentile
Range
Standard deviation
Variance
Shape
Central limit theorem
Moments
Kurtosis
L-moments
Skewness
Count data
Index of dispersion
Summary tables
Contingency table
Frequency distribution
Grouped data
Dependence
Partial correlation
Pearson product-moment correlation
Rank correlation
Kendall's Ï„
Spearman's Ï
Scatter plot
Graphics
Bar chart
Biplot
Box plot
Control chart
Correlogram
Fan chart
Forest plot
Histogram
Pie chart
Qâ€“Q plot
Radar chart
Run chart
Scatter plot
Stem-and-leaf display
Violin plot
Data collectionStudy design
Effect size
Missing data
Optimal design
Population
Replication
Sample size determination
Statistic
Statistical power
Survey methodology
Sampling
Cluster
Stratified
Opinion poll
Questionnaire
Standard error
Controlled experiments
Blocking
Factorial experiment
Interaction
Random assignment
Randomized controlled trial
Randomized experiment
Scientific control
Adaptive designs
Adaptive clinical trial
Stochastic approximation
Up-and-down designs
Observational studies
Cohort study
Cross-sectional study
Natural experiment
Quasi-experiment
Statistical inferenceStatistical theory
Population
Statistic
Probability distribution
Sampling distribution
Order statistic
Empirical distribution
Density estimation
Statistical model
Model specification
Lp space
Parameter
location
scale
shape
Parametric family
LikelihoodÂ (monotone)
Locationâ€“scale family
Exponential family
Completeness
Sufficiency
Statistical functional
Bootstrap
U
V
Optimal decision
loss function
Efficiency
Statistical distance
divergence
Asymptotics
Robustness
Frequentist inferencePoint estimation
Estimating equations
Maximum likelihood
Method of moments
M-estimator
Minimum distance
Unbiased estimators
Mean-unbiased minimum-variance
Raoâ€“Blackwellization
Lehmannâ€“ScheffÃ© theorem
Median unbiased
Plug-in
Interval estimation
Confidence interval
Pivot
Likelihood interval
Prediction interval
Tolerance interval
Resampling
Bootstrap
Jackknife
Testing hypotheses
1- & 2-tails
Power
Uniformly most powerful test
Permutation test
Randomization test
Multiple comparisons
Parametric tests
Likelihood-ratio
Score/Lagrange multiplier
Wald
Specific tests
Z-test (normal)
Student's t-test
F-test
Goodness of fit
Chi-squared
G-test
Kolmogorovâ€“Smirnov
Andersonâ€“Darling
Lilliefors
Jarqueâ€“Bera
Normality (Shapiroâ€“Wilk)
Likelihood-ratio test
Model selection
Cross validation
AIC
BIC
Rank statistics
Sign
Sample median
Signed rank (Wilcoxon)
Hodgesâ€“Lehmann estimator
Rank sum (Mannâ€“Whitney)
Nonparametric anova
1-way (Kruskalâ€“Wallis)
2-way (Friedman)
Ordered alternative (Jonckheereâ€“Terpstra)
Van der Waerden test
Bayesian inference
Bayesian probability
prior
posterior
Credible interval
Bayes factor
Bayesian estimator
Maximum posterior estimator
CorrelationRegression analysisCorrelation
Pearson product-moment
Partial correlation
Confounding variable
Coefficient of determination
Regression analysis
Errors and residuals
Regression validation
Mixed effects models
Simultaneous equations models
Multivariate adaptive regression splines (MARS)
Linear regression
Simple linear regression
Ordinary least squares
General linear model
Bayesian regression
Non-standard predictors
Nonlinear regression
Nonparametric
Semiparametric
Isotonic
Robust
Heteroscedasticity
Homoscedasticity
Generalized linear model
Exponential families
Logistic (Bernoulli)Â / BinomialÂ / Poisson regressions
Partition of variance
Analysis of variance (ANOVA, anova)
Analysis of covariance
Multivariate ANOVA
Degrees of freedom
CategoricalÂ / MultivariateÂ / Time-seriesÂ / Survival analysisCategorical
Cohen's kappa
Contingency table
Graphical model
Log-linear model
McNemar's test
Cochranâ€“Mantelâ€“Haenszel statistics
Multivariate
Regression
Manova
Principal components
Canonical correlation
Discriminant analysis
Cluster analysis
Classification
Structural equation model
Factor analysis
Multivariate distributions
Elliptical distributions
Normal
Time-seriesGeneral
Decomposition
Trend
Stationarity
Seasonal adjustment
Exponential smoothing
Cointegration
Structural break
Granger causality
Specific tests
Dickeyâ€“Fuller
Johansen
Q-statistic (Ljungâ€“Box)
Durbinâ€“Watson
Breuschâ€“Godfrey
Time domain
Autocorrelation (ACF)
partial (PACF)
Cross-correlation (XCF)
ARMA model
ARIMA model (Boxâ€“Jenkins)
Autoregressive conditional heteroskedasticity (ARCH)
Vector autoregression (VAR)
Frequency domain
Spectral density estimation
Fourier analysis
Least-squares spectral analysis
Wavelet
Whittle likelihood
SurvivalSurvival function
Kaplanâ€“Meier estimator (product limit)
Proportional hazards models
Accelerated failure time (AFT) model
First hitting time
Hazard function
Nelsonâ€“Aalen estimator
Test
Log-rank test
ApplicationsBiostatistics
Bioinformatics
Clinical trialsÂ / studies
Epidemiology
Medical statistics
Engineering statistics
Chemometrics
Methods engineering
Probabilistic design
ProcessÂ / quality control
Reliability
System identification
Social statistics
Actuarial science
Census
Crime statistics
Demography
Econometrics
Jurimetrics
National accounts
Official statistics
Population statistics
Psychometrics
Spatial statistics
Cartography
Environmental statistics
Geographic information system
Geostatistics
Kriging

Category
Â Mathematics portal
Commons
 WikiProject

vteProbability distributions (list)Discrete univariatewith finite support
Benford
Bernoulli
beta-binomial
binomial
categorical
hypergeometric
negative
Poisson binomial
Rademacher
soliton
discrete uniform
Zipf
Zipfâ€“Mandelbrot
with infinite support
beta negative binomial
Borel
Conwayâ€“Maxwellâ€“Poisson
discrete phase-type
Delaporte
extended negative binomial
Floryâ€“Schulz
Gaussâ€“Kuzmin
geometric
logarithmic
mixed Poisson
negative binomial
Panjer
parabolic fractal
Poisson
Skellam
Yuleâ€“Simon
zeta
Continuous univariatesupported on a bounded interval
arcsine
ARGUS
Baldingâ€“Nichols
Bates
beta
beta rectangular
continuous Bernoulli
Irwinâ€“Hall
Kumaraswamy
logit-normal
noncentral beta
PERT
raised cosine
reciprocal
triangular
U-quadratic
uniform
Wigner semicircle
supported on a semi-infinite interval
Benini
Benktander 1st kind
Benktander 2nd kind
beta prime
Burr
chi
chi-squared
noncentral
inverse
scaled
Dagum
Davis
Erlang
hyper
exponential
hyperexponential
hypoexponential
logarithmic
F
noncentral
folded normal
FrÃ©chet
gamma
generalized
inverse
gamma/Gompertz
Gompertz
shifted
half-logistic
half-normal
Hotelling's T-squared
inverse Gaussian
generalized
Kolmogorov
LÃ©vy
log-Cauchy
log-Laplace
log-logistic
log-normal
log-t
Lomax
matrix-exponential
Maxwellâ€“Boltzmann
Maxwellâ€“JÃ¼ttner
Mittag-Leffler
Nakagami
Pareto
phase-type
Poly-Weibull
Rayleigh
relativistic Breitâ€“Wigner
Rice
truncated normal
type-2 Gumbel
Weibull
discrete
Wilks's lambda
supported on the whole real line
Cauchy
exponential power
Fisher's z
Kaniadakis Îº-Gaussian
Gaussian q
generalized normal
generalized hyperbolic
geometric stable
Gumbel
Holtsmark
hyperbolic secant
Johnson's SU
Landau
Laplace
asymmetric
logistic
noncentral t
normal (Gaussian)
normal-inverse Gaussian
skew normal
slash
stable
Student's t
Tracyâ€“Widom
variance-gamma
Voigt
with support whose type varies
generalized chi-squared
generalized extreme value
generalized Pareto
Marchenkoâ€“Pastur
Kaniadakis Îº-exponential
Kaniadakis Îº-Gamma
Kaniadakis Îº-Weibull
Kaniadakis Îº-Logistic
Kaniadakis Îº-Erlang
q-exponential
q-Gaussian
q-Weibull
shifted log-logistic
Tukey lambda
Mixed univariatecontinuous-discrete
Rectified Gaussian
Multivariate (joint)
Discrete: 
Ewens
multinomial
Dirichlet
negative
Continuous: 
Dirichlet
generalized
multivariate Laplace
multivariate normal
multivariate stable
multivariate t
normal-gamma
inverse
Matrix-valued: 
LKJ
matrix normal
matrix t
matrix gamma
inverse
Wishart
normal
inverse
normal-inverse
complex
Directional
Univariate (circular) directional
Circular uniform
univariate von Mises
wrapped normal
wrapped Cauchy
wrapped exponential
wrapped asymmetric Laplace
wrapped LÃ©vy
Bivariate (spherical)
Kent
Bivariate (toroidal)
bivariate von Mises
Multivariate
von Misesâ€“Fisher
Bingham
Degenerate and singular
Degenerate
Dirac delta function
Singular
Cantor
Families
Circular
compound Poisson
elliptical
exponential
natural exponential
locationâ€“scale
maximum entropy
mixture
Pearson
Tweedie
wrapped

 Category
 Commons




