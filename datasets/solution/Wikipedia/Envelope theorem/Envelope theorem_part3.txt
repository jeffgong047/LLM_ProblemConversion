sets: Let X denote the choice set and let the relevant parameter be t∈[0,1]∈0,1]. Letting f:X×[0,1]→R:X×0,1] denote the parameterized objective function, the value function V and the optimal choice correspondence (set-valued function) X∗^∗ are given by: V(t)=supx∈Xf(x,t)(t)=sup_xf(x,t) (1) X∗(t)=x∈X:f(x,t)=V(t)^∗(t)={x:f(x,t)=V(t)} (2) "Envelope theorems" describe sufficient conditions for the value function V to be differentiable in the parameter t and describe its derivative as V′(t)=ft(x,t)foreachx∈X∗(t),^'(t)=f_t(x,t)foreachx^∗(t), (3) where ft_t denotes the partial derivative of f with respect to t. Namely, the derivative of the value function with respect to the parameter equals the partial derivative of the objective function with respect to t holding the maximizer fixed at its optimal level. Traditional envelope theorem derivations use the first-order condition for (1), which requires that the choice set X have the convex and topological structure, and the objective function f be differentiable in the variable x. (The argument is that changes in the maximizer have only a "second-order effect" at the optimum and so can be ignored.) However, in many applications such as the analysis of incentive constraints in contract theory and game theory, nonconvex production problems, and "monotone" or "robust" comparative statics, the choice sets and objective functions generally lack the topological and convexity properties required by the traditional envelope theorems. Paul Milgrom and Segal (2002) observe that the traditional envelope formula holds for optimization problems with arbitrary choice sets at any differentiability point of the value function,[5] provided that the objective function is differentiable in the parameter: Theorem 1: Let t∈(0,1)∈(0,1) and x∈X∗(t)^∗(t). If both V′(t)^'(t) and ft(x,t)_t(x,t) exist, the envelope formula (3) holds. Proof: Equation (1) implies that for x∈X∗(t)^∗(t), maxs∈[0,1][f(x,s)−V(s)]=f(x,t)−V(t)=0.max_s∈[0,1][f(x,s)-V(s)]=f(x,t)-V(t)=0. Under the assumptions, the objective function of the displayed maximization problem is differentiable at s=t=t, and the first-order condition for this maximization is exactly equation (3). Q.E.D. While differentiability of the value function in general requires strong assumptions, in many applications weaker conditions such as absolute continuity, differentiability almost everywhere, or left- and right-differentiability, suffice. In particular, Milgrom and Segal's (2002) Theorem 2 offers a sufficient condition for V to be absolutely continuous,[5] which means that it is differentiable almost everywhere and can be represented as an integral of its derivative: Theorem 2: Suppose that f(x,⋅)(x,·) is absolutely continuous for all x∈X. Suppose also that there exists an integrable function b:[0,1]:[0,1] →→ R+ℝ_+ such that |ft(x,t)|≤b(t)|f_t(x,t)|(t) for all x∈X and almost all t∈[0,1]∈0,1]. Then V is absolutely continuous. Suppose, in addition, that f(x,⋅)(x,·) is differentiable for all x∈X, and that X∗(t)≠∅^∗(t)≠∅ almost everywhere on [0,1][0,1]. Then for any selection x∗(t)∈X∗(t)^∗(t)^∗(t), V(t)=V(0)+∫0tft(x∗(s),s)ds.(t)=V(0)+∫_0^tf_t(x^∗(s),s)ds. (4) Proof: Using (1)(1), observe that for any t′,t′′∈[0,1]^',t^''∈0,1] with t′<t′′^'<t^'', |V(t′′)−V(t′)|≤supx∈X|f(x,t′′)−f(x,t′)|=supx∈X|∫t′t′′ft(x,t)dt|≤∫t′t′′supx∈X|ft(x,t)|dt≤∫t′t′′b(t)dt.|V(t^'')-V(t^')|≤sup_x|f(x,t^'')-f(x,t^')|=sup_x|∫_t^'^t^''f_t(x,t)dt|≤∫_t^'^t^''sup_x|f_t(x,t)|dt≤∫_t^'^t^''b(t)dt. This implies that V is absolutely continuous. Therefore, V is differentiable almost everywhere, and using (3) yields (4). Q.E.D. This result dispels the common misconception that nice behavior of the value function requires correspondingly nice behavior of the maximizer. Theorem 2 ensures the absolute continuity of the value function even though the maximizer may be discontinuous. In a similar vein, Milgrom and Segal's (2002) Theorem 3 implies that the value function must be differentiable at t=t0=t_0 and hence satisfy the envelope formula (3) when the family f(x,⋅)x∈X{f(x,·)}_x is equi-differentiable at t0∈(0,1)_0∈(0,1) and ft(X∗(t),t0)_t(X^∗(t),t_0) is single-valued and continuous at t=t0=t_0, even if the maximizer is not differentiable at t0_0 (e.g., if X is described by a set of inequality constraints and the set of binding constraints changes at t0_0).[5]