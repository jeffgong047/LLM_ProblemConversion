Conditions for switching order of integration in calculus
For the Fubini theorem for category, see Kuratowski–Ulam theorem.
This article may be too technical for most readers to understand. Relevant discussion may be found on the talk page. Please help improve it to make it understandable to non-experts, without removing the technical details. (August 2020) (Learn how and when to remove this template message)
In mathematical analysis, Fubini's theorem is a result that gives conditions under which it is possible to compute a double integral by using an iterated integral, introduced by Guido Fubini in 1907. One may switch the order of integration if the double integral yields a finite answer when the integrand is replaced by its absolute value.
∬X×Yf(x,y)d(x,y)=∫X(∫Yf(x,y)dy)dx=∫Y(∫Xf(x,y)dx)dyif∬X×Y|f(x,y)|d(x,y)<+∞. ∬_Xf(x,y) d(x,y)=∫_X(∫_Yf(x,y) dy)dx=∫_Y(∫_Xf(x,y) dx)dy    if    ∬_X|f(x,y)| d(x,y)<+∞.
Fubini's theorem implies that two iterated integrals are equal to the corresponding double integral across its integrands. Tonelli's theorem, introduced by Leonida Tonelli in 1909, is similar, but applies to a non-negative measurable function rather than one integrable over their domains.
A related theorem is often called Fubini's theorem for infinite series,[1] which states that if am,nm=1,n=1∞{a_m,n}_m=1,n=1^∞ is a doubly-indexed sequence of real numbers, and if ∑(m,n)∈N×Nam,n∑_(m,n)∈ℕ×ℕa_m,n is absolutely convergent, then
∑(m,n)∈N×Nam,n=∑m=1∞∑n=1∞am,n=∑n=1∞∑m=1∞am,n∑_(m,n)∈ℕ×ℕa_m,n=∑_m=1^∞∑_n=1^∞a_m,n=∑_n=1^∞∑_m=1^∞a_m,n
Although Fubini's theorem for infinite series is a special case of the more general Fubini's theorem, it is not appropriate to characterize it as a logical consequence of Fubini's theorem. This is because some properties of measures, in particular sub-additivity, are often proved using Fubini's theorem for infinite series.[2]  In this case, Fubini's general theorem is a logical consequence of Fubini's theorem for infinite series.


History[edit]
The special case of Fubini's theorem for continuous functions on a product of closed bounded subsets of real vector spaces was known to Leonhard Euler in the 18th century. Henri Lebesgue (1904) extended this to bounded measurable functions on a product of intervals.[3] Levi conjectured that the theorem could be extended to functions that were integrable rather than bounded,[citation needed] and this was proved by Fubini (1907).[4] Leonida Tonelli (1909) gave a variation of Fubini's theorem that applies to non-negative functions rather than integrable functions.[5]

Product measures[edit]
If X and Y are measure spaces with measures, there are several natural ways to define a product measure on their product.
The product X × Y of measure spaces (in the sense of category theory) has as its measurable sets the σ-algebra generated by the products A × B of measurable subsets of X and Y.
A measure μ on X × Y is called a product measure if μ(A × B) = μ1(A)μ2(B) for measurable subsets A ⊂ X and B ⊂ Y and measures µ1 on X and µ2 on Y. In general there may be many different product measures on X × Y. Fubini's theorem and Tonelli's theorem both need technical conditions to avoid this complication; the most common way is to assume all measure spaces are σ-finite, in which case there is a unique product measure on X×Y. There is always a unique maximal product measure on X × Y, where the measure of a measurable set is the inf of the measures of sets containing it that are countable unions of products of measurable sets. The maximal product measure can be constructed by applying Carathéodory's extension theorem to the additive function μ such that μ(A × B) = μ1(A)μ2(B) on the ring of sets generated by products of measurable sets. (Carathéodory's extension theorem gives a measure on a measure space that in general contains more measurable sets than the measure space X × Y, so strictly speaking the measure should be restricted to the σ-algebra generated by the products A × B of measurable subsets of X and Y.)
The product of two complete measure spaces is not usually complete. For example, the product of the Lebesgue measure on the unit interval I with itself is not the Lebesgue measure on the square I × I. There is a variation of Fubini's theorem for complete measures, which uses the completion of the product of measures rather than the uncompleted product.

For integrable functions[edit]
Suppose X and Y are σ-finite measure spaces, and suppose that X × Y is given the product measure (which is unique as X and Y are σ-finite). Fubini's theorem states that if f is X × Y integrable, meaning that f is a measurable function and
∫X×Y|f(x,y)|d(x,y)<∞,∫_X|f(x,y)| d(x,y)<∞,
then
∫X(∫Yf(x,y)dy)dx=∫Y(∫Xf(x,y)dx)dy=∫X×Yf(x,y)d(x,y).∫_X(∫_Yf(x,y) dy) dx=∫_Y(∫_Xf(x,y) dx) dy=∫_Xf(x,y) d(x,y).
The first two integrals are iterated integrals with respect to two measures, respectively, and the third is an integral with respect to the product measure. The partial integrals ∫Yf(x,y)dy∫_Yf(x,y) dy and ∫Xf(x,y)dx∫_Xf(x,y) dx need not be defined everywhere, but this does not matter as the points where they are not defined form a set of measure 0.
If the above integral of the absolute value is not finite, then the two iterated integrals may have different values.  See below for an illustration of this possibility.
The condition that X and Y are σ-finite is usually harmless because in practice almost all measure spaces one wishes to use Fubini's theorem for are σ-finite.
Fubini's theorem has some rather technical extensions to the case when X and Y are not assumed to be σ-finite (Fremlin 2003). The main extra complication in this case is that there may be more than one product measure on X×Y. Fubini's theorem continues to hold for the maximal product measure, but can fail for other product measures. For example, there is a product measure and a non-negative measurable function f for which the double integral of |f| is zero but the two iterated integrals have different values; see the section on counterexamples below for an example of this. Tonelli's theorem and the Fubini–Tonelli theorem (stated below) can fail on non σ-finite spaces even for the maximal product measure.

Tonelli's theorem for non-negative measurable functions[edit]
Tonelli's theorem (named after Leonida Tonelli) is a successor of Fubini's theorem. The conclusion of Tonelli's theorem is identical to that of Fubini's theorem, but the assumption that |f||f| has a finite integral is replaced by the assumption that f is a non-negative measurable function.
Tonelli's theorem states that if (X, A, μ) and (Y, B, ν) are σ-finite measure spaces, while f from X×Y to [0,∞] is non-negative measurable function, then
∫X(∫Yf(x,y)dy)dx=∫Y(∫Xf(x,y)dx)dy=∫X×Yf(x,y)d(x,y).∫_X(∫_Yf(x,y) dy) dx=∫_Y(∫_Xf(x,y) dx) dy=∫_Xf(x,y) d(x,y).
A special case of Tonelli's theorem is in the interchange of the summations, as in ∑x∑yaxy=∑y∑xaxy∑_x∑_ya_xy=∑_y∑_xa_xy, where axy_xy are non-negative for all x and y. The crux of the theorem is that the interchange of order of summation holds even if the series diverges. In effect, the only way a change in order of summation can change the sum is when there exist some subsequences that diverge to +∞+∞ and others diverging to −∞-∞. With all elements non-negative, this does not happen in the stated example.
Without the condition that the measure spaces are σ-finite it is possible for all three of these integrals to have different values. 
Some authors give generalizations of Tonelli's theorem to some measure spaces that are not σ-finite but these generalizations often add conditions that immediately reduce the problem to the σ-finite case.  For example, one could take the σ-algebra on A×B to be that generated by the product of subsets of finite measure, rather than that generated by all products of measurable subsets, though this has the undesirable consequence that the projections from the product to its factors A and B are not measurable. Another way is to add the condition that the support of f is contained in a countable union of products of sets of finite measure. Fremlin (2003) gives some rather technical extensions of Tonelli's theorem to some non σ-finite spaces. None of these generalizations have found any significant applications outside abstract measure theory, largely because almost all measure spaces of practical interest are σ-finite.

Fubini–Tonelli theorem[edit]
Combining Fubini's theorem with Tonelli's theorem gives
the Fubini–Tonelli theorem (often just called Fubini's theorem), which states that if X and Y are σ-finite measure spaces, and if f is a measurable function, then
∫X(∫Y|f(x,y)|dy)dx=∫Y(∫X|f(x,y)|dx)dy=∫X×Y|f(x,y)|d(x,y)∫_X(∫_Y|f(x,y)| dy) dx=∫_Y(∫_X|f(x,y)| dx) dy=∫_X|f(x,y)| d(x,y)
Besides if any one of these integrals is finite, then
∫X(∫Yf(x,y)dy)dx=∫Y(∫Xf(x,y)dx)dy=∫X×Yf(x,y)d(x,y).∫_X(∫_Yf(x,y) dy) dx=∫_Y(∫_Xf(x,y) dx) dy=∫_Xf(x,y) d(x,y).
The absolute value of f in the conditions above can be replaced by either the positive or the negative part of f; these forms include Tonelli's theorem as a special case as the negative part of a non-negative function is zero and so has finite integral. Informally all these conditions say that the double integral of f is well defined, though possibly infinite.
The advantage of the Fubini–Tonelli over Fubini's theorem is that the repeated integrals of |f||f| may be easier to study than the double integral. As in Fubini's theorem, the single integrals may fail to be defined on a measure 0 set.

For complete measures[edit]
The versions of Fubini's and Tonelli's theorems above do not apply to integration on the product of the real line Rℝ with itself with Lebesgue measure.  The problem is that Lebesgue measure on R×Rℝ×ℝ is not the product of Lebesgue measure on Rℝ with itself, but rather the completion of this: a product of two complete measure spaces X and Y is not in general complete.  For this reason one sometimes uses versions of Fubini's theorem for complete measures: roughly speaking one just replaces all measures by their completions.  The various versions of Fubini's theorem are similar to the versions above, with the following minor differences:

Instead of taking a product X×Y of two measure spaces, one takes the completion of some product.
If f is measurable on the completion of X×Y then its restrictions to vertical or horizontal lines may be non-measurable for a measure zero subset of lines, so one has to allow for the possibility that the vertical or horizontal integrals are undefined on a set of measure 0 because they involve integrating non-measurable functions. This makes little difference, because they can already be undefined due to the functions not being integrable.
One generally also assumes that the measures on X and Y are complete, otherwise the two partial integrals along vertical or horizontal lines may be well-defined but not measurable. For example, if f is the characteristic function of a product of a measurable set and a non-measurable set contained in a measure 0 set then its single integral is well defined everywhere but non-measurable.
Proofs[edit]
Proofs of the Fubini and Tonelli theorems are necessarily somewhat technical, as they have to use a hypothesis related to σ-finiteness. Most proofs involve building up to the full theorems by proving them for increasingly complicated functions with the steps as follows.

Use the fact that the measure on the product is a product measure to prove the theorems for the characteristic functions of rectangles.
Use the condition that the spaces are σ-finite (or some related condition) to prove the theorem for the characteristic functions of measurable sets. This also covers the case of simple measurable functions (measurable functions taking only a finite number of values).
Use the condition that the functions are measurable to prove the theorems for positive measurable functions by approximating them by simple measurable functions.  This proves Tonelli's theorem.
Use the condition that the functions are integrable to write them as the difference of two positive integrable functions, and apply Tonelli's theorem to each of these. This proves Fubini's theorem.
Riemann integrals[edit]
For Riemann integrals, Fubini's theorem is proven by refining the partitions along the x-axis and y-axis as to create a joint partition of the form [xi,xi+1]×[yj,yj+1][x_i,x_i+1]×[y_j,y_j+1], which is a partition over X×Y. This is used to show that the double integrals of either order are equal to the integral over X×Y.

Counterexamples[edit]
The following examples show how Fubini's theorem and Tonelli's theorem can fail if any of their hypotheses are omitted.

Failure of Tonelli's theorem for non σ-finite spaces[edit]
Suppose that X is the unit interval with the Lebesgue measurable sets and Lebesgue measure, and Y is the unit interval with all subsets measurable and the counting measure, so that Y is not σ-finite. If f is the characteristic function of the diagonal of X×Y, then integrating f along X gives the 0 function on Y, but integrating f along Y gives the function 1 on X. So the two iterated integrals are different. This shows that Tonelli's theorem can fail for spaces that are not σ-finite no matter what product measure is chosen. The measures are both decomposable, showing that Tonelli's theorem fails for decomposable measures (which are slightly more general than σ-finite measures).

Failure of Fubini's theorem for non-maximal product measures[edit]
Fubini's theorem holds for spaces even if they are not assumed to be σ-finite provided one uses the maximal product measure.
In the example above, for the maximal product measure, the diagonal has infinite measure so the double integral of |f| is infinite, and Fubini's theorem holds vacuously.
However, if we give X×Y the product measure such that the measure of a set is the sum of the Lebesgue measures of its horizontal sections, then the double integral of |f| is zero, but the two iterated integrals still have different values. This gives an example of a product measure where Fubini's theorem fails.
This gives an example of two different product measures on the same product of two measure spaces. For products of two σ-finite measure spaces, there is only one product measure.

Failure of Tonelli's theorem for non-measurable functions[edit]
Suppose that X is the first uncountable ordinal, with the finite measure where the measurable sets are either countable (with measure 0) or the sets of countable complement (with measure 1). The (non-measurable) subset E of X×X given by pairs (x,y) with x<y is countable on every horizontal line and has countable complement on every vertical line. If f is the characteristic function of E then the two iterated integrals of f are defined and have different values 1 and 0. The function f is not measurable. This shows that Tonelli's theorem can fail for non-measurable functions.

Failure of Fubini's theorem for non-measurable functions[edit]
A variation of the example above shows that Fubini's theorem can fail for non-measurable functions even if |f| is integrable and both repeated integrals are well defined: if we take f to be 1 on E and –1 on the complement of E, then |f| is integrable on the product with integral 1, and both repeated integrals are well defined, but have different values 1 and –1.
Assuming the continuum hypothesis, one can identify X with the unit interval I, so there is a bounded non-negative function on I×I whose two iterated integrals (using Lebesgue measure) are both defined but unequal. This example was found by Wacław Sierpiński (1920).[6]
The stronger versions of Fubini's theorem on a product of two unit intervals with Lebesgue measure, where the function is no longer assumed to be measurable but merely that the two iterated integrals are well defined and exist, are independent of the standard Zermelo–Fraenkel axioms of set theory.  The continuum hypothesis and Martin's axiom both imply that there exists a function on the unit square whose iterated integrals are not equal, while Harvey Friedman (1980) showed that it is consistent with ZFC that a strong Fubini-type theorem for [0, 1] does hold, and whenever the two iterated integrals exist they are equal.[7] See List of statements undecidable in ZFC.

Failure of Fubini's theorem for non-integrable functions[edit]
Fubini's theorem tells us that (for measurable functions on a product of σ-finite measure spaces) if the integral of the absolute value is finite, then the order of integration does not matter; if we integrate first with respect to x and then with respect to y, we get the same result as if we integrate first with respect to y and then with respect to x.  The assumption that the integral of the absolute value is finite is "Lebesgue integrability", and without it the two repeated integrals can have different values.
A simple example to show that the repeated integrals can be different in general is to take the two measure spaces to be the positive integers, and to take the function f(x,y) to be 1 if x = y, −1 if x = y + 1, and 0 otherwise. Then the two repeated integrals have different values 0 and 1.
Another example is as follows for the function
x2−y2(x2+y2)2=−∂2∂x∂yarctan⁡(y/x).x^2-y^2/(x^2+y^2)^2=-∂^2/ arctan(y/x).
The iterated integrals
∫x=01(∫y=01x2−y2(x2+y2)2dy)dx=π4∫_x=0^1(∫_y=0^1x^2-y^2/(x^2+y^2)^2 dy) dx=π/4
and
∫y=01(∫x=01x2−y2(x2+y2)2dx)dy=−π4∫_y=0^1(∫_x=0^1x^2-y^2/(x^2+y^2)^2 dx) dy=-π/4
have different values. The corresponding double integral does not converge absolutely (in other words the integral of the absolute value is not finite):
∫01∫01|x2−y2(x2+y2)2|dydx=∞.∫_0^1∫_0^1|x^2-y^2/(x^2+y^2)^2| dy dx=∞.

See also[edit]
Cavalieri's principle – Geometry concept − an early particular case
Coarea formula − generalization to geometric measure theory
Disintegration theorem – theorem in measure theory − a restricted converse to Fubini's theorem
Fubini's theorem for distributions – Mathematical analysis term similar to generalized functionPages displaying short descriptions of redirect targets
Kuratowski–Ulam theorem – analog of Fubini's theorem for arbitrary second countable Baire spaces
Symmetry of second derivatives − analogue for differentiation
References[edit]


^ Tao, Terence (2016), Analysis I, p. 188, ISBN 9789811017896

^ Royden, Halsey (2010), Real Analysis, p. 34, ISBN 9780131437470

^ Lebesgue, Henri (1904), Leçons sur l'intégration et la recherche des fonctions primitives, Paris: Gauthier-Villars

^ Fubini, Guido (1907), "Sugli integrali multipli", Rom. Acc. L. Rend. (5), 16 (1): 608–614, JFM 38.0343.02 Reprinted in Fubini, G. (1958), Opere scelte, vol. 2, Cremonese, pp. 243–249

^ Tonelli, Leonida (1909). "Sull'integrazione per parti". Atti della Accademia Nazionale dei Lincei. (5). 18 (2): 246–253.

^ Sierpiński, Wacław (1920), "Sur un problème concernant les ensembles mesurables superficiellement", Fundamenta Mathematicae, 1 (1): 112–115, doi:10.4064/fm-1-1-112-115

^ Friedman, Harvey (1980), "A Consistent Fubini-Tonelli Theorem for Nonmeasurable Functions", Illinois Journal of Mathematics, 24 (3): 390–395, doi:10.1215/ijm/1256047607, MR 0573474


Further reading[edit]
Billingsley, Patrick (1995), "Product Measure and Fubini's Theorem", Probability and Measure, New York: Wiley, pp. 231–240, ISBN 0-471-00710-2
DiBenedetto, Emmanuele (2002), Real Analysis, Birkhäuser Advanced Texts: Basler Lehrbücher, Boston: Birkhäuser, doi:10.1007/978-1-4612-0117-5, ISBN 0-8176-4231-5, MR 1897317
Fremlin, D. H. (2003), Measure theory, vol. 2, Colchester: Torres Fremlin, ISBN 0-9538129-2-8, MR 2462280
Weir, Alan J. (1973), "Fubini's Theorem", Lebesgue Integration and Measure, Cambridge: Cambridge University Press, pp. 83–92, ISBN 0-521-08728-7
External links[edit]
Kudryavtsev, L.D. (2001) [1994], "Fubini theorem", Encyclopedia of Mathematics, EMS Press


vteMeasure theoryBasic concepts
Absolute continuity of measures
Lebesgue integration
Lp spaces
Measure
Measure space
Probability space
Measurable space/function
Sets
Almost everywhere
Atom
Baire set
Borel set
equivalence relation
Borel space
Carathéodory's criterion
Cylindrical σ-algebra
Cylinder set
𝜆-system
Essential range
infimum/supremum
Locally measurable
π-system
σ-algebra
Non-measurable set
Vitali set
Null set
Support
Transverse measure
Universally measurable
Types of Measures
Atomic
Baire
Banach
Besov
Borel
Brown
Complex
Complete
Content
(Logarithmically) Convex
Decomposable
Discrete
Equivalent
Finite
Inner
(Quasi-) Invariant
Locally finite
Maximising
Metric outer
Outer
Perfect
Pre-measure
(Sub-) Probability
Projection-valued
Radon
Random
Regular
Borel regular
Inner regular
Outer regular
Saturated
Set function
σ-finite
s-finite
Signed
Singular
Spectral
Strictly positive
Tight
Vector
Particular measures
Counting
Dirac
Euler
Gaussian
Haar
Harmonic
Hausdorff
Intensity
Lebesgue
Infinite-dimensional
Logarithmic
Product
Projections
Pushforward
Spherical measure
Tangent
Trivial
Young
Maps
Measurable function
Bochner
Strongly
Weakly
Convergence: almost everywhere
of measures
in measure
of random variables
in distribution
in probability
Cylinder set measure
Random: compact set
element
measure
process
variable
vector
Projection-valued measure
Main results
Carathéodory's extension theorem
Convergence theorems
Dominated
Monotone
Vitali
Decomposition theorems
Hahn
Jordan
Maharam's
Egorov's
Fatou's lemma
Fubini's
Fubini–Tonelli
Hölder's inequality
Minkowski inequality
Radon–Nikodym
Riesz–Markov–Kakutani representation theorem
Other results
Disintegration theorem
Lifting theory
Lebesgue's density theorem
Lebesgue differentiation theorem
Sard's theorem
For Lebesgue measure
Isoperimetric inequality
Brunn–Minkowski theorem
Milman's reverse
Minkowski–Steiner formula
Prékopa–Leindler inequality
Vitale's random Brunn–Minkowski inequality
Applications & related
Convex analysis
Descriptive set theory
Probability theory
Real analysis
Spectral theory




