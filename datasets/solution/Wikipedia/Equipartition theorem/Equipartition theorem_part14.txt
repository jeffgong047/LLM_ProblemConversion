gases: See also: Special relativity, White dwarf, and Neutron star Equipartition was used above to derive the classical ideal gas law from Newtonian mechanics. However, relativistic effects become dominant in some systems, such as white dwarfs and neutron stars,[10] and the ideal gas equations must be modified. The equipartition theorem provides a convenient way to derive the corresponding laws for an extreme relativistic ideal gas.[6] In such cases, the kinetic energy of a single particle is given by the formula Hkin≈cp=cpx2+py2+pz2._kin=c√(p_x^2+p_y^2+p_z^2). Taking the derivative of H with respect to the px momentum component gives the formula px∂Hkin∂px=cpx2px2+py2+pz2_x_kin/_x=cp_x^2/√(p_x^2+p_y^2+p_z^2) and similarly for the py and pz components. Adding the three components together gives ⟨Hkin⟩=⟨cpx2+py2+pz2px2+py2+pz2⟩=⟨px∂Hkin∂px⟩+⟨py∂Hkin∂py⟩+⟨pz∂Hkin∂pz⟩=3kBT_kin⟩ =p_x^2+p_y^2+p_z^2/√(p_x^2+p_y^2+p_z^2)⟩ =_x^kin/_x⟩+_y^kin/_y⟩+_z^kin/_z⟩ =3k_BT where the last equality follows from the equipartition formula. Thus, the average total energy of an extreme relativistic gas is twice that of the non-relativistic case: for N particles, it is 3 NkBT. Non-ideal