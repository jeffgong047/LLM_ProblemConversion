physics: See also: Astrophysics and Stellar structure The equipartition theorem and the related virial theorem have long been used as a tool in astrophysics.[40] As examples, the virial theorem may be used to estimate stellar temperatures or the Chandrasekhar limit on the mass of white dwarf stars.[41][42] The average temperature of a star can be estimated from the equipartition theorem.[43] Since most stars are spherically symmetric, the total gravitational potential energy can be estimated by integration Hgrav=−∫0R4πr2GrM(r)ρ(r)dr,_grav=-∫_0^R4^2G/rM(r) ρ(r) dr, where M(r) is the mass within a radius r and ρ(r) is the stellar density at radius r; G represents the gravitational constant and R the total radius of the star. Assuming a constant density throughout the star, this integration yields the formula Hgrav=−3GM25R,_grav=-3GM^2/5R, where M is the star's total mass. Hence, the average potential energy of a single particle is ⟨Hgrav⟩=HgravN=−3GM25RN,_grav⟩=H_grav/N=-3GM^2/5RN, where N is the number of particles in the star. Since most stars are composed mainly of ionized hydrogen, N equals roughly M/mp, where mp is the mass of one proton. Application of the equipartition theorem gives an estimate of the star's temperature ⟨r∂Hgrav∂r⟩=⟨−Hgrav⟩=kBT=3GM25RN._grav/⟩=⟨-H_grav⟩=k_BT=3GM^2/5RN. Substitution of the mass and radius of the Sun yields an estimated solar temperature of T = 14 million kelvins, very close to its core temperature of 15 million kelvins. However, the Sun is much more complex than assumed by this model—both its temperature and density vary strongly with radius—and such excellent agreement (≈7% relative error) is partly fortuitous.[44] Star