matrices: In general Woodbury's identity is not valid if one or more inverses are replaced by (Moore–Penrose) pseudoinverses. However, if A and C are positive semidefinite, and V=UH=U^H (implying that A+UCV+UCV is itself positive semidefinite), then the following formula provides a generalization:[9][10] (XXH+YYH)+=(ZZH)++(I−YZ+)HX+HEX+(I−YZ+),Z=(I−XX+)Y,E=I−X+Y(I−Z+Z)F−1(X+Y)H,F=I+(I−Z+Z)YH(XXH)+Y(I−Z+Z),(XX^H+YY^H)^+ =(ZZ^H)^++(I-YZ^+)^HX^+HEX^+(I-YZ^+), Z =(I-XX^+)Y, E =I-X^+Y(I-Z^+Z)F^-1(X^+Y)^H, F =I+(I-Z^+Z)Y^H(XX^H)^+Y(I-Z^+Z), where A+UCUH+UCU^H can be written as XXH+YYH^H+YY^H because any positive semidefinite matrix is equal to MMH^H for some M.