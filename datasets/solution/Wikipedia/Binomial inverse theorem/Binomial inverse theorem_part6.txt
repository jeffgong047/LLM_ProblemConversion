theorem: If A, B, U, V are matrices of sizes n×n, k×k, n×k, k×n, respectively, then (A+UBV)−1=A−1−A−1UB(B+BVA−1UB)−1BVA−1(A+UBV)^-1=A^-1-A^-1UB(B+BVA^-1UB)^-1BVA^-1 provided A and B + BVA−1UB are nonsingular. Nonsingularity of the latter requires that B−1 exist since it equals B(I + VA−1UB) and the rank of the latter cannot exceed the rank of B.[7] Since B is invertible, the two B terms flanking the parenthetical quantity inverse in the right-hand side can be replaced with (B−1)−1, which results in the original Woodbury identity. A variation for when B is singular and possibly even non-square:[7] (A+UBV)−1=A−1−A−1U(I+BVA−1U)−1BVA−1.(A+UBV)^-1=A^-1-A^-1U(I+BVA^-1U)^-1BVA^-1. Formulas also exist for certain cases in which A is singular.[8] Pseudoinverse with positive semidefinite