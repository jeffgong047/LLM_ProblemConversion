proofs: Algebraic proof First consider these useful identities, U+UCVA−1U=UC(C−1+VA−1U)=(A+UCV)A−1U(A+UCV)−1UC=A−1U(C−1+VA−1U)−1U+UCVA^-1U =UC(C^-1+VA^-1U)=(A+UCV)A^-1U (A+UCV)^-1UC =A^-1U(C^-1+VA^-1U)^-1 Now, A−1=(A+UCV)−1(A+UCV)A−1=(A+UCV)−1(I+UCVA−1)=(A+UCV)−1+(A+UCV)−1UCVA−1=(A+UCV)−1+A−1U(C−1+VA−1U)−1VA−1.A^-1 =(A+UCV)^-1(A+UCV)A^-1 =(A+UCV)^-1(I+UCVA^-1) =(A+UCV)^-1+(A+UCV)^-1UCVA^-1 =(A+UCV)^-1+A^-1U(C^-1+VA^-1U)^-1VA^-1. Derivation via blockwise elimination Deriving the Woodbury matrix identity is easily done by solving the following block matrix inversion problem [AUV−C−1][XY]=[I0].[ A U; V -C^-1 ][ X; Y ]=[ I; 0 ]. Expanding, we can see that the above reduces to AX+UY=IVX−C−1Y=0AX+UY=I VX-C^-1Y=0 which is equivalent to (A+UCV)X=I(A+UCV)X=I. Eliminating the first equation, we find that X=A−1(I−UY)=A^-1(I-UY), which can be substituted into the second to find VA−1(I−UY)=C−1Y^-1(I-UY)=C^-1Y. Expanding and rearranging, we have VA−1=(C−1+VA−1U)Y^-1=(C^-1+VA^-1U)Y, or (C−1+VA−1U)−1VA−1=Y(C^-1+VA^-1U)^-1VA^-1=Y. Finally, we substitute into our AX+UY=I+UY=I, and we have AX+U(C−1+VA−1U)−1VA−1=I+U(C^-1+VA^-1U)^-1VA^-1=I. Thus, (A+UCV)−1=X=A−1−A−1U(C−1+VA−1U)−1VA−1.(A+UCV)^-1=X=A^-1-A^-1U(C^-1+VA^-1U)^-1VA^-1. We have derived the Woodbury matrix identity. Derivation from LDU decomposition We start by the matrix [AUVC][ A U; V C ] By eliminating the entry under the A (given that A is invertible) we get [I0−VA−1I][AUVC]=[AU0C−VA−1U][ I 0; -VA^-1 I ][ A U; V C ]=[ A U; 0 C-VA^-1U ] Likewise, eliminating the entry above C gives [AUVC][I−A−1U0I]=[A0VC−VA−1U][ A U; V C ][ I -A^-1U; 0 I ]=[ A 0; V C-VA^-1U ] Now combining the above two, we get [I0−VA−1I][AUVC][I−A−1U0I]=[A00C−VA−1U][ I 0; -VA^-1 I ][ A U; V C ][ I -A^-1U; 0 I ]=[ A 0; 0 C-VA^-1U ] Moving to the right side gives [AUVC]=[I0VA−1I][A00C−VA−1U][IA−1U0I][ A U; V C ]=[ I 0; VA^-1 I ][ A 0; 0 C-VA^-1U ][ I A^-1U; 0 I ] which is the LDU decomposition of the block matrix into an upper triangular, diagonal, and lower triangular matrices. Now inverting both sides gives [AUVC]−1=[IA−1U0I]−1[A00C−VA−1U]−1[I0VA−1I]−1=[I−A−1U0I][A−100(C−VA−1U)−1][I0−VA−1I]=[A−1+A−1U(C−VA−1U)−1VA−1−A−1U(C−VA−1U)−1−(C−VA−1U)−1VA−1(C−VA−1U)−1](1)[ A U; V C ]^-1 =[ I A^-1U; 0 I ]^-1[ A 0; 0 C-VA^-1U ]^-1[ I 0; VA^-1 I ]^-1 =[ I -A^-1U; 0 I ][ A^-1 0; 0 (C-VA^-1U)^-1 ][ I 0; -VA^-1 I ] =[ A^-1+A^-1U(C-VA^-1U)^-1VA^-1 -A^-1U(C-VA^-1U)^-1; -(C-VA^-1U)^-1VA^-1 (C-VA^-1U)^-1 ] (1) We could equally well have done it the other way (provided that C is invertible) i.e. [AUVC]=[IUC−10I][A−UC−1V00C][I0C−1VI][ A U; V C ]=[ I UC^-1; 0 I ][ A-UC^-1V 0; 0 C ][ I 0; C^-1V I ] Now again inverting both sides, [AUVC]−1=[I0C−1VI]−1[A−UC−1V00C]−1[IUC−10I]−1=[I0−C−1VI][(A−UC−1V)−100C−1][I−UC−10I]=[(A−UC−1V)−1−(A−UC−1V)−1UC−1−C−1V(A−UC−1V)−1C−1+C−1V(A−UC−1V)−1UC−1](2)[ A U; V C ]^-1 =[ I 0; C^-1V I ]^-1[ A-UC^-1V 0; 0 C ]^-1[ I UC^-1; 0 I ]^-1 =[ I 0; -C^-1V I ][ (A-UC^-1V)^-1 0; 0 C^-1 ][ I -UC^-1; 0 I ] =[ (A-UC^-1V)^-1 -(A-UC^-1V)^-1UC^-1; -C^-1V(A-UC^-1V)^-1 C^-1+C^-1V(A-UC^-1V)^-1UC^-1 ] (2) Now comparing elements (1, 1) of the RHS of (1) and (2) above gives the Woodbury formula (A−UC−1V)−1=A−1+A−1U(C−VA−1U)−1VA−1.(A-UC^-1V)^-1=A^-1+A^-1U(C-VA^-1U)^-1VA^-1.