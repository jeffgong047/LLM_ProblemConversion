lemma: We begin by establishing the key lemma stated in the "overview" section above. Endow g with an inner product (e.g., the Hilbert–Schmidt inner product), and let h be the Lie algebra of H defined as h = {X ∈ Mn(R) = g | etX ∈ H ∀t ∈ R}. Let s = {S ∈ g | (S, T) = 0 ∀T ∈ h}, the orthogonal complement of h. Then g decomposes as the direct sum g = s ⊕ h, so each X ∈ g is uniquely expressed as X = S + T with S ∈ s, T ∈ h. Define a map Φ : g → GL(n, R) by (S, T) ↦ eSeT. Expand the exponentials, Φ(S,T)=etSetT=I+tS+tT+O(t2),Φ(S,T)=e^tSe^tT=I+tS+tT+O(t^2), and the pushforward or differential at 0, Φ∗(S, T) = d/dtΦ(tS, tT)|t = 0 is seen to be S + T, i.e. Φ∗ = Id, the identity. The hypothesis of the inverse function theorem is satisfied with Φ analytic, and thus there are open sets U1 ⊂ g, V1 ⊂ GL(n, R) with 0 ∈ U1 and I ∈ V1 such that Φ is a real-analytic bijection from U1 to V1 with analytic inverse. It remains to show that U1 and V1 contain open sets U and V such that the conclusion of the theorem holds. Consider a countable neighborhood basis Β at 0 ∈ g, linearly ordered by reverse inclusion with B1 ⊂ U1.[25] Suppose for the purpose of obtaining a contradiction that for all i, Φ(Bi) ∩ H contains an element hi that is not on the form hi = eTi,Ti ∈ h. Then, since Φ is a bijection on the Bi, there is a unique sequence Xi = Si + Ti, with 0 ≠ Si ∈ s and Ti ∈ h such that Xi ∈ Bi converging to 0 because Β is a neighborhood basis, with eSieTi = hi. Since eTi ∈ H and hi ∈ H, eSi ∈ H as well. Normalize the sequence in s, Yi = Si/||Si||. It takes its values in the unit sphere in s and since it is compact, there is a convergent subsequence converging to Y ∈ s.[26] The index i henceforth refers to this subsequence. It will be shown that etY ∈ H, ∀t ∈ R. Fix t and choose a sequence mi of integers such that mi||Si|| → t as i → ∞. For example, mi such that mi||Si|| ≤ t ≤ (mi + 1)||Si|| will do, as Si → 0. Then (eSi)mi=emiSi=emi‖Si‖Yi→etY.(e^S_i)^m_i=e^m_iS_i=e^m_iS_iY_i^tY. Since H is a group, the left hand side is in H for all i. Since H is closed, etY ∈ H, ∀t,[27] hence Y ∈ h. This is a contradiction. Hence, for some i the sets U = Βi and V = Φ(Βi) satisfy e(U ∩ h) = H ∩ V and the exponential restricted to the open set (U ∩ h) ⊂ h is in analytic bijection with the open set Φ(U) ∩ H ⊂ H. This proves the lemma. Proof of the