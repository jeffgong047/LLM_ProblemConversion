error: In the introduction, we mentioned that the truncated Karhunenâ€“Loeve expansion was the best approximation of the original process in the sense that it reduces the total mean-square error resulting of its truncation. Because of this property, it is often said that the KL transform optimally compacts the energy. More specifically, given any orthonormal basis {fk} of L2([a, b]), we may decompose the process Xt as: Xt(Ï‰)=âˆ‘k=1âˆAk(Ï‰)fk(t)_t(Ï‰)=âˆ‘_k=1^âˆA_k(Ï‰)f_k(t) where Ak(Ï‰)=âˆ«abXt(Ï‰)fk(t)dt_k(Ï‰)=âˆ«_a^bX_t(Ï‰)f_k(t) dt and we may approximate Xt by the finite sum X^t(Ï‰)=âˆ‘k=1NAk(Ï‰)fk(t)XÌ‚_t(Ï‰)=âˆ‘_k=1^NA_k(Ï‰)f_k(t) for some integer N. Claim. Of all such approximations, the KL approximation is the one that minimizes the total mean square error (provided we have arranged the eigenvalues in decreasing order). Proof Consider the error resulting from the truncation at the N-th term in the following orthonormal expansion: ÎµN(t)=âˆ‘k=N+1âˆAk(Ï‰)fk(t)Îµ_N(t)=âˆ‘_k=N+1^âˆA_k(Ï‰)f_k(t) The mean-square error ÎµN2(t) can be written as: ÎµN2(t)=E[âˆ‘i=N+1âˆâˆ‘j=N+1âˆAi(Ï‰)Aj(Ï‰)fi(t)fj(t)]=âˆ‘i=N+1âˆâˆ‘j=N+1âˆE[âˆ«abâˆ«abXtXsfi(t)fj(s)dsdt]fi(t)fj(t)=âˆ‘i=N+1âˆâˆ‘j=N+1âˆfi(t)fj(t)âˆ«abâˆ«abKX(s,t)fi(t)fj(s)dsdtÎµ_N^2(t) =ğ„[âˆ‘_i=N+1^âˆâˆ‘_j=N+1^âˆA_i(Ï‰)A_j(Ï‰)f_i(t)f_j(t)] =âˆ‘_i=N+1^âˆâˆ‘_j=N+1^âˆğ„[âˆ«_a^bâˆ«_a^bX_tX_sf_i(t)f_j(s) ds dt]f_i(t)f_j(t) =âˆ‘_i=N+1^âˆâˆ‘_j=N+1^âˆf_i(t)f_j(t)âˆ«_a^bâˆ«_a^bK_X(s,t)f_i(t)f_j(s) ds dt We then integrate this last equality over [a, b]. The orthonormality of the fk yields: âˆ«abÎµN2(t)dt=âˆ‘k=N+1âˆâˆ«abâˆ«abKX(s,t)fk(t)fk(s)dsdtâˆ«_a^bÎµ_N^2(t) dt=âˆ‘_k=N+1^âˆâˆ«_a^bâˆ«_a^bK_X(s,t)f_k(t)f_k(s) ds dt The problem of minimizing the total mean-square error thus comes down to minimizing the right hand side of this equality subject to the constraint that the fk be normalized. We hence introduce Î²k, the Lagrangian multipliers associated with these constraints, and aim at minimizing the following function: Er[fk(t),kâˆˆN+1,â€¦]=âˆ‘k=N+1âˆâˆ«abâˆ«abKX(s,t)fk(t)fk(s)dsdtâˆ’Î²k(âˆ«abfk(t)fk(t)dtâˆ’1)[f_k(t),kâˆˆ{N+1,â€¦}]=âˆ‘_k=N+1^âˆâˆ«_a^bâˆ«_a^bK_X(s,t)f_k(t)f_k(s) ds dt-Î²_k(âˆ«_a^bf_k(t)f_k(t) dt-1) Differentiating with respect to fi(t) (this is a functional derivative) and setting the derivative to 0 yields: âˆ‚Erâˆ‚fi(t)=âˆ«ab(âˆ«abKX(s,t)fi(s)dsâˆ’Î²ifi(t))dt=0/_i(t)=âˆ«_a^b(âˆ«_a^bK_X(s,t)f_i(s) ds-Î²_if_i(t)) dt=0 which is satisfied in particular when âˆ«abKX(s,t)fi(s)ds=Î²ifi(t).âˆ«_a^bK_X(s,t)f_i(s) ds=Î²_if_i(t). In other words, when the fk are chosen to be the eigenfunctions of TKX, hence resulting in the KL expansion. Explained