Proofs: One proof proceeds as follows: Every finitely generated module over a PID is also finitely presented because a PID is Noetherian, an even stronger condition than coherence. Take a presentation, which is a map Rr→Rg^r^g (relations to generators), and put it in Smith normal form. This yields the invariant factor decomposition, and the diagonal entries of Smith normal form are the invariant factors. Another outline of a proof: Denote by tM the torsion submodule of M. Then M/tM is a finitely generated torsion free module, and such a module over a commutative PID is a free module of finite rank, so it is isomorphic to Rn^n for a positive integer n. This free module can be embedded as a submodule F of M, such that the embedding splits (is a right inverse of) the projection map; it suffices to lift each of the generators of F into M. As a consequence M=tM⊕F=tM. For a prime element p in R we can then speak of Np=m∈tM∣∃i,mpi=0_p={m|,mp^i=0}. This is a submodule of tM, and it turns out that each Np is a direct sum of cyclic modules, and that tM is a direct sum of Np for a finite number of distinct primes p. Putting the previous two steps together, M is decomposed into cyclic modules of the indicated types.