Combinatorial and geometric result used in measure theory of Euclidean spaces
In mathematics, the Vitali covering lemma is a combinatorial and geometric result commonly used in measure theory of Euclidean spaces. This lemma is an intermediate step, of independent interest, in the proof of the Vitali covering theorem. The covering theorem is credited to the Italian mathematician Giuseppe Vitali.[1] The theorem states that it is possible to cover, up to a Lebesgue-negligible set, a given subset E of Rd by a disjoint family extracted from a Vitali covering of E.


Vitali covering lemma[edit]
Visualization of the lemma in R1â„^1.
On the top: a collection of balls; the green balls are the disjoint subcollection. On the bottom: the subcollection with three times the radius covers all the balls.There are two basic version of the lemma, a finite version and an infinite version. Both lemmas can be proved in the general setting of a metric space, typically these results are applied to the special case of the Euclidean space Rdâ„^d. In both theorems we will use the following notation: if B=B(x,r)=B(x,r) is a ball and câˆˆRâˆˆâ„, we will write cB for the ball B(x,cr)(x,cr).
Finite version[edit]
Theorem (Finite Covering Lemma). Let B1,â€¦,Bn_1,â€¦,B_n be any finite collection of balls  contained in an arbitrary metric space. Then there exists a subcollection Bj1,Bj2,â€¦,Bjm_j_1,B_j_2,â€¦,B_j_m of these balls which are disjoint and satisfy B1âˆªB2âˆªâ‹¯âˆªBnâŠ†3Bj1âˆª3Bj2âˆªâ‹¯âˆª3Bjm._1_2âˆªâ€¦_nâŠ†3B_j_1âˆª3B_j_2âˆªâ€¦âˆª3B_j_m.Proof: Without loss of generality, we assume that the collection of balls is not empty; that is, nÂ > 0. Let Bj1_j_1 be the ball of largest radius. Inductively, assume that Bj1,â€¦,Bjk_j_1,â€¦,B_j_k have been chosen. If there is some ball in B1,â€¦,Bn_1,â€¦,B_n that is disjoint from Bj1âˆªBj2âˆªâ‹¯âˆªBjk_j_1_j_2âˆªâ€¦_j_k, let Bjk+1_j_k+1 be such ball with maximal radius (breaking ties arbitrarily), otherwise, we set mÂ := k and terminate the inductive definition.
Now set X:=â‹ƒk=1m3Bjk:=â‹ƒ_k=1^m3 B_j_k. It remains to show that BiâŠ‚X_i for every i=1,2,â€¦,n=1,2,â€¦,n. This is clear if iâˆˆj1,â€¦,jmâˆˆ{j_1,â€¦,j_m}. Otherwise, there necessarily is some kâˆˆ1,â€¦,mâˆˆ{1,â€¦,m} such that Bi_i intersects Bjk_j_k and the radius of Bjk_j_k is at least as large as that of Bi_i. The triangle inequality then easily implies that BiâŠ‚3BjkâŠ‚X_iâŠ‚3 B_j_k, as needed. This completes the proof of the finite version.

Infinite version[edit]
Theorem (Infinite Covering Lemma). Let Fğ… be an arbitrary collection of balls in a separable metric space such that R:=suprad(B):BâˆˆF<âˆ:=sup {rad(B):Bâˆˆğ…}<âˆ where rad(B)rad(B) denotes the radius of the ball B. Then there exists a countable sub-collection GâŠ‚Fğ†âŠ‚ğ… such that the balls of Gğ† are pairwise disjoint, and satisfyâ‹ƒBâˆˆFBâŠ†â‹ƒCâˆˆG5C.â‹ƒ_Bâˆˆğ…BâŠ†â‹ƒ_Câˆˆğ†5 C.And moreover, each BâˆˆFâˆˆğ… intersects some CâˆˆGâˆˆğ† with BâŠ‚5CâŠ‚5C.
Proof: Consider the partition of F into subcollections Fn, nÂ â‰¥ 0, defined by
Fn=BâˆˆF:2âˆ’nâˆ’1R<rad(B)â‰¤2âˆ’nR.ğ…_n={Bâˆˆğ…:2^-n-1R<rad(B)â‰¤2^-nR}.
That is, Fnğ…_n consists of the balls B whose radius is in (2âˆ’nâˆ’1R, 2âˆ’nR].  A sequence Gn, with GnÂ âŠ‚ Fn, is defined inductively as follows.  First, set H0Â = F0 and let G0 be a maximal disjoint subcollection of H0 (such a subcollection exists by Zorn's lemma). Assuming that G0,...,Gn have been selected, let

Hn+1=BâˆˆFn+1:Bâˆ©C=âˆ…,âˆ€CâˆˆG0âˆªG1âˆªâ‹¯âˆªGn,ğ‡_n+1={Bâˆˆğ…_n+1:=âˆ…,
âˆˆğ†_0âˆªğ†_1âˆªâ€¦âˆªğ†_n},
and let Gn+1 be a maximal disjoint subcollection of  Hn+1. The subcollection

G:=â‹ƒn=0âˆGnğ†:=â‹ƒ_n=0^âˆğ†_n
of F satisfies the requirements of the theorem: G is a disjoint collection, and is thus countable since the given metric space is separable. Moreover, every ball BÂ âˆˆ F intersects a ball CÂ âˆˆ G such that BÂ âŠ‚Â 5Â C.
Indeed, if we are given some BâˆˆFâˆˆğ…, there must be some n be such that B belongs to Fn.  Either B does not belong to Hn, which implies nÂ > 0 and means that B intersects a ball from the union of G0, ..., Gnâˆ’1, or BÂ âˆˆ Hn and by maximality of Gn, B intersects a ball in  Gn.  In any case, B intersects a ball C that belongs to the union of G0, ..., Gn.  Such a ball C must have a radius larger than 2âˆ’nâˆ’1R.  Since the radius of B is less than or equal to 2âˆ’nR, we can conclude by the triangle inequality that BÂ âŠ‚ 5Â C, as claimed. From this â‹ƒBâˆˆFBâŠ†â‹ƒCâˆˆG5Câ‹ƒ_Bâˆˆğ…BâŠ†â‹ƒ_Câˆˆğ†5 C immediately follows, completing the proof.[2]
Remarks

In the infinite version, the initial collection of balls can be countable or uncountable. In a separable metric space, any pairwise disjoint collection of balls must be countable. In a non-separable space, the same argument shows a pairwise disjoint subfamily exists, but that family need not be countable.
The result may fail if the radii are not bounded: consider the family of all balls centered at 0 in Rd; any disjoint subfamily consists of only one ball B, and 5Â B does not contain all the balls in this family.
The constant 5 is not optimal. If the scale câˆ’n, cÂ > 1, is used instead of 2âˆ’n for defining Fn, the final value is 1Â +Â 2c instead of 5. Any constant larger than 3 gives a correct statement of the lemma, but not 3.
Using a finer analysis, when the original collection F is a Vitali covering of a subset E of Rd, one shows that the subcollection G, defined in the above proof, covers E up to a Lebesgue-negligible set.[3]
Applications and method of use[edit]
An application of the Vitali lemma is in proving the Hardyâ€“Littlewood maximal inequality. As in this proof, the Vitali lemma is frequently used when we are, for instance, considering the d-dimensional Lebesgue measure, Î»dÎ»_d, of a set EÂ âŠ‚ Rd, which we know is contained in the union of a certain collection of balls Bj:jâˆˆJ{B_j:j}, each of which has a measure we can more easily compute, or has a special property one would like to exploit. Hence, if we compute the measure of this union, we will have an upper bound on the measure of E. However, it is difficult to compute the measure of the union of all these balls if they overlap. By the Vitali lemma, we may choose a subcollection Bj:jâˆˆJâ€²{B_j:j'} which is disjoint and such that â‹ƒjâˆˆJâ€²5BjâŠƒâ‹ƒjâˆˆJBjâŠƒEâ‹ƒ_j'5B_jâŠƒâ‹ƒ_jB_j. Therefore,

Î»d(E)â‰¤Î»d(â‹ƒjâˆˆJBj)â‰¤Î»d(â‹ƒjâˆˆJâ€²5Bj)â‰¤âˆ‘jâˆˆJâ€²Î»d(5Bj).Î»_d(E)â‰¤Î»_d(â‹ƒ_jB_j)â‰¤Î»_d(â‹ƒ_j'5B_j)â‰¤âˆ‘_j'Î»_d(5B_j).
Now, since increasing the radius of a d-dimensional ball by a factor of five increases its volume by a factor of 5d, we know that

âˆ‘jâˆˆJâ€²Î»d(5Bj)=5dâˆ‘jâˆˆJâ€²Î»d(Bj)âˆ‘_j'Î»_d(5B_j)=5^dâˆ‘_j'Î»_d(B_j)
and thus

Î»d(E)â‰¤5dâˆ‘jâˆˆJâ€²Î»d(Bj).Î»_d(E)â‰¤5^dâˆ‘_j'Î»_d(B_j).
Vitali covering theorem[edit]
In the covering theorem, the aim is to cover, up to a "negligible set", a given set EÂ âŠ†Â Rd by a disjoint subcollection extracted from a Vitali covering forÂ EÂ : a Vitali class or Vitali covering Vğ’± for E is a collection of sets such that, for every xÂ âˆˆÂ E and Î´Â >Â 0, there is a set U in the collection Vğ’± such that xÂ âˆˆÂ U and the diameter of U is non-zero and less thanÂ Î´.
In the classical setting of Vitali,[1] the negligible set is a Lebesgue negligible set, but measures other than the Lebesgue measure, and spaces other than Rd have also been considered, as is shown in the relevant section below.
The following observation is useful: if Vğ’± is a Vitali covering for E and if E is contained in an open set Î©Â âŠ†Â Rd, then the subcollection of sets U in Vğ’± that are contained in Î© is also a Vitali covering for E.

Vitali's covering theorem for the Lebesgue measure[edit]
The next covering theorem for the Lebesgue measure Î»d is due to Lebesgue (1910). A collection Vğ’± of measurable subsets of Rd is a regular family (in the sense of Lebesgue) if there exists a constant C such that

diamâ¡(V)dâ‰¤CÎ»d(V)diam(V)^d Î»_d(V)
for every set V in the collection Vğ’±.
The family of cubes is an example of regular family Vğ’±, as is the family V(m)ğ’±(m) of rectangles in R2 such that the ratio of sides stays between mâˆ’1 and m, for some fixed mÂ â‰¥Â 1. If an arbitrary norm is given on Rd, the family of balls for the metric associated to the norm is another example. To the contrary, the family of all rectangles in R2 is not regular.


TheoremÂ â€”Â  Let EÂ âŠ†Â Rd be a measurable set with finite Lebesgue measure, and let Vğ’± be a regular family of closed subsets of Rd that is a Vitali covering for E. Then there exists a finite or countably infinite disjoint subcollection UjâŠ†V{U_j}âŠ†ğ’± such that
Î»d(Eâˆ–â‹ƒjUj)=0.Î»_d(Eâˆ–â‹ƒ_jU_j)=0.


The original result of Vitali (1908) is a special case of this theorem, in which dÂ = 1 and Vğ’± is a collection of intervals that is a Vitali covering for a measurable subset E of the real line having finite measure.

The theorem above remains true without assuming that E has finite measure. This is obtained by applying the covering result in the finite measure case, for every integer nÂ â‰¥Â 0, to the portion of E contained in the open annulus Î©n of points x such that nÂ < |x|Â < n+1.[4]
A somewhat related covering theorem is the Besicovitch covering theorem. To each point a of a subset AÂ âŠ†Â Rd, a Euclidean ball B(a,Â ra) with center a and positive radius ra is assigned. Then, as in the Vitali theorem, a subcollection of these balls is selected in order to cover A in a specific way. The main differences with the Vitali covering theorem are that on one hand, the disjointness requirement of Vitali is relaxed to the fact that the number Nx of the selected balls containing an arbitrary point xÂ âˆˆÂ Rd is bounded by a constant Bd depending only upon the dimension d; on the other hand, the selected balls do cover the set A of all the given centers.[5]

Vitali's covering theorem for the Hausdorff measure[edit]
One may have a similar objective when considering Hausdorff measure instead of Lebesgue measure. The following theorem applies in that case.[6]


TheoremÂ â€”Â  Let Hs denote s-dimensional Hausdorff measure, let EÂ âŠ†Â Rd be an Hs-measurable set and Vğ’± a Vitali class
of closed sets for E. Then there exists a (finite or countably infinite) disjoint subcollection UjâŠ†V{U_j}âŠ†ğ’± such that either
Hs(Eâˆ–â‹ƒjUj)=0^s(Eâˆ–â‹ƒ_jU_j)=0 or âˆ‘jdiamâ¡(Uj)s=âˆ.âˆ‘_jdiam(U_j)^s=âˆ.


Furthermore, if E has finite s-dimensional Hausdorff measure, then for any ÎµÂ >Â 0, we may choose this subcollection {Uj} such that

Hs(E)â‰¤âˆ‘jdiam(Uj)s+Îµ.^s(E)â‰¤âˆ‘_jdiam(U_j)^s+Îµ.
This theorem implies the result of Lebesgue given above. Indeed, when sÂ = d, the Hausdorff measure Hs on Rd coincides with a multiple of the d-dimensional Lebesgue measure. If a disjoint collection Uj{U_j} is regular and contained in a measurable region B with finite Lebesgue measure, then

âˆ‘jdiamâ¡(Uj)dâ‰¤Câˆ‘jÎ»d(Uj)â‰¤CÎ»d(B)<+âˆâˆ‘_jdiam(U_j)^dâˆ‘_jÎ»_d(U_j) Î»_d(B)<+âˆ
which excludes the second possibility in the first assertion of the previous theorem. It follows that E is covered, up to a Lebesgue-negligible set, by the selected disjoint subcollection.

From the covering lemma to the covering theorem[edit]
The covering lemma can be used as intermediate step in the proof of the following basic form of the Vitali covering theorem.


TheoremÂ â€”Â For every subset E of Rd and every Vitali cover of E by a collection F of closed balls, there exists a disjoint subcollection G which covers E up to a Lebesgue-negligible set.


Proof: Without loss of generality, one can assume that all balls in F are nondegenerate and have radius less than or equal toÂ 1. By the infinite form of the covering lemma, there exists a countable disjoint subcollection Gğ† of F such that every ball BÂ âˆˆ F intersects a ball CÂ âˆˆ G for which BÂ âŠ‚Â 5Â C. Let rÂ > 0 be given, and let Z denote the set of points zÂ âˆˆ E that are not contained in any ball from G and belong to the open ball B(r) of radius r, centered at 0. It is enough to show that Z is Lebesgue-negligible, for every given r.
Let Gr=Cnnğ†_r={C_n}_n denote the subcollection of those balls in G that meet B(r). Note that Grğ†_r may be finite or countably infinite. Let zÂ âˆˆ Z be fixed. For each N, z does not belong to the closed set K=â‹ƒnâ‰¤NCn=â‹ƒ_nC_n by the definition of Z. But by the Vitali cover property, one can find a ball BÂ âˆˆ F containing z, contained in B(r), and disjoint from K. By the property of G, the ball B intersects some ball CiâˆˆG_iâˆˆğ† and is contained in 5Ci5C_i. But because K and B are disjoint, we must have i > N. So zâˆˆ5Ciâˆˆ5C_i for some i > N, and therefore

ZâŠ‚â‹ƒn>N5Cn.âŠ‚â‹ƒ_n>N5C_n.
This gives for every N the inequality

Î»d(Z)â‰¤âˆ‘n>NÎ»d(5Cn)=5dâˆ‘n>NÎ»d(Cn).Î»_d(Z)â‰¤âˆ‘_n>NÎ»_d(5C_n)=5^dâˆ‘_n>NÎ»_d(C_n).
But since the balls of Grğ†_r are contained in B(r+2), and these balls are disjoint we see

âˆ‘nÎ»d(Cn)<âˆ.âˆ‘_nÎ»_d(C_n)<âˆ.
Therefore, the term on the right side of the above inequality converges to 0 as N goes to infinity, which shows that Z is negligible as needed.[7]

Infinite-dimensional spaces[edit]
The Vitali covering theorem is not valid in infinite-dimensional settings. The first result in this direction was given by David Preiss in 1979:[8] there exists a Gaussian measure Î³ on an (infinite-dimensional) separable Hilbert space H so that the Vitali covering theorem fails for (H,Â Borel(H),Â Î³). This result was strengthened in 2003 by Jaroslav TiÅ¡er: the Vitali covering theorem in fact fails for every infinite-dimensional Gaussian measure on any (infinite-dimensional) separable Hilbert space.[9]

See also[edit]
Besicovitch covering theorem
Notes[edit]


^ a b (Vitali 1908).

^ The proof given is based on (Evans & Gariepy 1992, section 1.5.1)

^ See the "From the covering lemma to the covering theorem" section of this entry.

^ See (Evans & Gariepy 1992).

^ Vitali (1908) allowed a negligible error.

^ (Falconer 1986).

^ The proof given is based on (Natanson 1955), with some notation taken from (Evans & Gariepy 1992).

^ (Preiss 1979).

^ (TiÅ¡er 2003).


References[edit]
Evans, Lawrence C.; Gariepy, Ronald F. (1992), Measure Theory and Fine Properties of Functions, Studies in Advanced Mathematics, Boca Raton, FL: CRC Press, pp.Â viii+268, ISBNÂ 0-8493-7157-0, MRÂ 1158660, ZblÂ 0804.28001
Falconer, Kenneth J. (1986), The geometry of fractal sets, Cambridge Tracts in Mathematics, vol.Â 85, Cambridge: Cambridge University Press, pp.Â xiv+162, ISBNÂ 0-521-25694-1, MRÂ 0867284, ZblÂ 0587.28004
"Vitali theorem", Encyclopedia of Mathematics, EMS Press, 2001 [1994]
Lebesgue, Henri (1910), "Sur l'intÃ©gration des fonctions discontinues", Annales Scientifiques de l'Ã‰cole Normale SupÃ©rieure, 27: 361â€“450, doi:10.24033/asens.624, JFMÂ 41.0457.01
Natanson, I. P (1955), Theory of functions of a real variable, New York: Frederick Ungar Publishing Co., p.Â 277, MRÂ 0067952, ZblÂ 0064.29102
Preiss, David (1979), "Gaussian measures and covering theorems", Commentatione Mathematicae Universitatis Carolinae, 20 (1): 95â€“99, ISSNÂ 0010-2628, MRÂ 0526149, ZblÂ 0386.28015
Stein, Elias M.; Shakarchi, Rami (2005), Real analysis. Measure theory, integration, and Hilbert spaces, Princeton Lectures in Analysis, III, Princeton, NJ: Princeton University Press, pp.Â xx+402, ISBNÂ 0-691-11386-6, MRÂ 2129625, ZblÂ 1081.28001
TiÅ¡er, Jaroslav (2003), "Vitali covering theorem in Hilbert space", Transactions of the American Mathematical Society, 355 (8): 3277â€“3289 (electronic), doi:10.1090/S0002-9947-03-03296-3, MRÂ 1974687, ZblÂ 1042.28014
Vitali, Giuseppe (1908) [17 December 1907], "Sui gruppi di punti e sulle funzioni di variabili reali", Atti dell'Accademia delle Scienze di Torino (in Italian), 43: 75â€“92, JFMÂ 39.0101.05 (Title translation) "On groups of points and functions of real variables" is the paper containing the first proof of Vitali covering theorem.



