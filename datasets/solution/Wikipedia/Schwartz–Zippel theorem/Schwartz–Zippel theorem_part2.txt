lemma: Theorem 1 (Schwartz, Zippel). Let P∈R[x1,x2,…,xn][x_1,x_2,…,x_n] be a non-zero polynomial of total degree d ≥ 0 over an integral domain R. Let S be a finite subset of R and let r1, r2, ..., rn be selected at random independently and uniformly from S. Then Pr[P(r1,r2,…,rn)=0]≤d|S|.[P(r_1,r_2,…,r_n)=0]≤d/|S|. Equivalently, the Lemma states that for any finite subset S of R, if Z(P) is the zero set of P, then |Z(P)∩Sn|≤d⋅|S|n−1.|Z(P)^n|·|S|^n-1. Proof. The proof is by mathematical induction on n. For n = 1, as was mentioned before, P can have at most d roots. This gives us the base case. Now, assume that the theorem holds for all polynomials in n − 1 variables. We can then consider P to be a polynomial in x1 by writing it as P(x1,…,xn)=∑i=0dx1iPi(x2,…,xn).(x_1,…,x_n)=∑_i=0^dx_1^iP_i(x_2,…,x_n). Since P is not identically 0, there is some i such that Pi_i is not identically 0. Take the largest such i. Then deg⁡Pi≤d−i_i-i, since the degree of x1iPi_1^iP_i is at most d. Now we randomly pick r2,…,rn_2,…,r_n from S. By the induction hypothesis, Pr[Pi(r2,…,rn)=0]≤d−i|S|.[P_i(r_2,…,r_n)=0]≤d-i/|S|. If Pi(r2,…,rn)≠0_i(r_2,…,r_n)≠0, then P(x1,r2,…,rn)(x_1,r_2,…,r_n) is of degree i (and thus not identically zero) so Pr[P(r1,r2,…,rn)=0|Pi(r2,…,rn)≠0]≤i|S|.[P(r_1,r_2,…,r_n)=0|P_i(r_2,…,r_n)≠0]≤i/|S|. If we denote the event P(r1,r2,…,rn)=0(r_1,r_2,…,r_n)=0 by A, the event Pi(r2,…,rn)=0_i(r_2,…,r_n)=0 by B, and the complement of B by Bc^c, we have Pr[A]=Pr[A∩B]+Pr[A∩Bc]=Pr[B]Pr[A|B]+Pr[Bc]Pr[A|Bc]≤Pr[B]+Pr[A|Bc]≤d−i|S|+i|S|=d|S|[A] =[A]+[A^c] =[B][A|B]+[B^c][A|B^c] ≤[B]+[A|B^c] ≤d-i/|S|+i/|S|=d/|S|