Proof: Claim: Let X be a standard Gaussian in Rnℝ^n, then for any symmetric matrices Q,Q′,Q', if XTQX^TQX and XTQ′X^TQ'X have the same distribution, then Q,Q′,Q' have the same eigenvalues (up to multiplicity). Proof Let the eigenvalues of Q be λ1,...,λnλ_1,...,λ_n, then calculate the characteristic function of XTQX^TQX. It comes out to be ϕ(t)=(∏j(1−2iλjt))−1/2ϕ(t)=(∏_j(1-2iλ_jt))^-1/2 (To calculate it, first diagonalize Q, change into that frame, then use the fact that the characteristic function of the sum of independent variables is the product of their characteristic functions.) For XTQX^TQX and XTQ′X^TQ'X to be equal, their characteristic functions must be equal, so Q,Q′,Q' have the same eigenvalues (up to multiplicity). Claim: I=∑iBi=∑_iB_i. Proof UT(I−∑iBi)U=0^T(I-∑_iB_i)U=0. Since (I−∑iBi)(I-∑_iB_i) is symmetric, and UT(I−∑iBi)U=dUT0U^T(I-∑_iB_i)U=^dU^T0U, by the previous claim, (I−∑iBi)(I-∑_iB_i) has the same eigenvalues as 0. Lemma: If ∑iMi=I∑_iM_i=I, all Mi_i symmetric, and have eigenvalues 0, 1, then they are simultaneously diagonalizable. Proof Fix i, and consider the eigenvectors v of Mi_i such that Miv=v_iv=v. Then we have vTv=vTIv=vTv+∑j≠ivTMjv^Tv=v^TIv=v^Tv+∑_jv^TM_jv, so all vTMjv=0^TM_jv=0. Thus we obtain a split of RNℝ^N into V⊕V⊥^⊥, such that V is the 1-eigenspace of Mi_i, and in the 0-eigenspaces of all other Mj_j. Now induct by moving into V⊥^⊥. Now we prove the original theorem. We prove that the three cases are equivalent by proving that each case implies the next one in a cycle (1→2→3→11→2→3→1). Proof Case: All Qi_i are independent Fix some i, define Ci=I−Bi=∑j≠iBj_i=I-B_i=∑_jB_j, and diagonalize Bi_i by an orthogonal transform O. Then consider OCiOT=I−OBiOT_iO^T=I-OB_iO^T. It is diagonalized as well. Let W=OU=OU, then it is also standard Gaussian. Then we have Qi=WT(OBiOT)W;∑j≠iQj=WT(I−OBiOT)W_i=W^T(OB_iO^T)W; ∑_jQ_j=W^T(I-OB_iO^T)W Inspect their diagonal entries, to see that Qi⊥∑j≠iQj_i⊥∑_jQ_j implies that their nonzero diagonal entries are disjoint. Thus all eigenvalues of Bi_i are 0, 1, so Qi_i is a χ2χ^2 dist with ri_i degrees of freedom. Case: Each Qi_i is a χ2(ri)χ^2(r_i) distribution. Fix any i, diagonalize it by orthogonal transform O, and reindex, so that OBiOT=diag(λ1,...,λri,0,...,0)_iO^T=diag(λ_1,...,λ_r_i,0,...,0). Then Qi=∑jλjU′j2_i=∑_jλ_jU'_j^2 for some Uj′'_j, a spherical rotation of Ui_i. Since Qi∼χ2(ri)_i∼χ^2(r_i), we get all λj=1λ_j=1. So all Bi⪰0_i≽0, and have eigenvalues 0,10,1. So diagonalize them simultaneously, add them up, to find ∑iri=N∑_ir_i=N. Case: r1+⋯+rk=N_1+⋯+r_k=N. We first show that the matrices B(i) can be simultaneously diagonalized by an orthogonal matrix and that their non-zero eigenvalues are all equal to +1. Once that's shown, take this orthogonal transform to this simultaneous eigenbasis, in which the random vector [U1,...,UN]T[U_1,...,U_N]^T becomes [U1′,...,UN′]T[U'_1,...,U'_N]^T, but all Ui′_i' are still independent and standard Gaussian. Then the result follows. Each of the matrices B(i) has rank ri and thus ri non-zero eigenvalues. For each i, the sum C(i)≡∑j≠iB(j)^(i)≡∑_jB^(j) has at most rank ∑j≠irj=N−ri∑_jr_j=N-r_i. Since B(i)+C(i)=IN×N^(i)+C^(i)=I_N, it follows that C(i) has exactly rank N − ri. Therefore B(i) and C(i) can be simultaneously diagonalized. This can be shown by first diagonalizing B(i), by the spectral theorem. In this basis, it is of the form: [λ100⋯⋯00λ20⋯⋯000⋱⋮⋮⋮λri⋮⋮00⋮⋱00…0].[ λ_1 0 0 ⋯ ⋯ 0; 0 λ_2 0 ⋯ ⋯ 0; 0 0 ⋱ ⋮; ⋮ ⋮ λ_r_i; ⋮ ⋮ 0; 0 ⋮ ⋱; 0 0 … 0 ]. Thus the lower (N−ri)(N-r_i) rows are zero. Since C(i)=I−B(i)^(i)=I-B^(i), it follows that these rows in C(i) in this basis contain a right block which is a (N−ri)×(N−ri)(N-r_i)×(N-r_i) unit matrix, with zeros in the rest of these rows. But since C(i) has rank N − ri, it must be zero elsewhere. Thus it is diagonal in this basis as well. It follows that all the non-zero eigenvalues of both B(i) and C(i) are +1. This argument applies for all i, thus all B(i) are positive semidefinite. Moreover, the above analysis can be repeated in the diagonal basis for C(1)=B(2)+∑j>2B(j)^(1)=B^(2)+∑_j>2B^(j). In this basis C(1)^(1) is the identity of an (N−r1)×(N−r1)(N-r_1)×(N-r_1) vector space, so it follows that both B(2) and ∑j>2B(j)∑_j>2B^(j) are simultaneously diagonalizable in this vector space (and hence also together with B(1)). By iteration it follows that all B-s are simultaneously diagonalizable. Thus there exists an orthogonal matrix S such that for all i, STB(i)S≡B(i)′^TB^(i)S^(i)' is diagonal, where any entry Bx,y(i)′_x,y^(i)' with indices x=y=y, ∑j=1i−1rj<x=y≤∑j=1irj∑_j=1^i-1r_j<x=y≤∑_j=1^ir_j, is equal to 1, while any entry with other indices is equal to 0.