forests: Kirchhoff's theorem can be generalized to count k-component spanning forests in an unweighted graph.[2] A k-component spanning forest is a subgraph with k connected components that contains all vertices and is cycle-free, i.e., there is at most one path between each pair of vertices. Given such a forest F with connected components F1,…,Fk_1,…,F_k, define its weight w(F)=|V(F1)|⋅⋯⋅|V(Fk)|(F)=|V(F_1)|·…·|V(F_k)| to be the product of the number of vertices in each component. Then ∑Fw(F)=qk,∑_Fw(F)=q_k, where the sum is over all k-component spanning forests and qk_k is the coefficient of xk^k of the polynomial (x+λ1)…(x+λn−1)x.(x+λ_1)…(x+λ_n-1)x. The last factor in the polynomial is due to the zero eigenvalue λn=0λ_n=0. More explicitly, the number qk_k can be computed as qk=∑i1,…,in−k⊂1…n−1λi1…λin−k._k=∑_{i_1,…,i_n-k}⊂{1-1}λ_i_1…λ_i_n-k. where the sum is over all n–k-element subsets of 1,…,n{1,…,n}. For example qn−1=λ1+⋯+λn−1=trQ=2|E|qn−2=λ1λ2+λ1λ3+⋯+λn−2λn−1q2=λ1…λn−2+λ1…λn−3λn−1+⋯+λ2…λn−1q1=λ1…λn−1q_n-1 =λ_1+…+λ_n-1=trQ=2|E| q_n-2 =λ_1λ_2+λ_1λ_3+…+λ_n-2λ_n-1 q_2 =λ_1…λ_n-2+λ_1…λ_n-3λ_n-1+…+λ_2…λ_n-1 q_1 =λ_1…λ_n-1 Since a spanning forest with n–1 components corresponds to a single edge, the k = n – 1 case states that the sum of the eigenvalues of Q is twice the number of edges. The k = 1 case corresponds to the original Kirchhoff theorem since the weight of every spanning tree is n. The proof can be done analogously to the proof of Kirchhoff's theorem. An invertible (n−k)×(n−k)(n-k)×(n-k) submatrix of the incidence matrix corresponds bijectively to a k-component spanning forest with a choice of vertex for each component. The coefficients qk_k are up to sign the coefficients of the characteristic polynomial of Q. See