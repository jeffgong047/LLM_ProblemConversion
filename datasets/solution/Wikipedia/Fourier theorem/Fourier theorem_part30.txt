Bravais-lattice-periodic-function: A three-dimensional Bravais lattice is defined as the set of vectors of the form: R=n1a1+n2a2+n3a3𝐑=n_1𝐚_1+n_2𝐚_2+n_3𝐚_3 where ni_i are integers and ai𝐚_i are three linearly independent vectors. Assuming we have some function, f(r)(𝐫), such that it obeys the condition of periodicity for any Bravais lattice vector R𝐑, f(r)=f(R+r)(𝐫)=f(𝐑+𝐫), we could make a Fourier series of it. This kind of function can be, for example, the effective potential that one electron "feels" inside a periodic crystal. It is useful to make the Fourier series of the potential when applying Bloch's theorem. First, we may write any arbitrary position vector r𝐫 in the coordinate-system of the lattice: r=x1a1a1+x2a2a2+x3a3a3,𝐫=x_1𝐚_1/a_1+x_2𝐚_2/a_2+x_3𝐚_3/a_3, where ai≜|ai|,_i≜|𝐚_i|, meaning that ai_i is defined to be the magnitude of ai𝐚_i, so ai^=aiai𝐚̂_̂î=𝐚_i/a_i is the unit vector directed along ai𝐚_i. Thus we can define a new function, g(x1,x2,x3)≜f(r)=f(x1a1a1+x2a2a2+x3a3a3).(x_1,x_2,x_3)(𝐫)=f(x_1𝐚_1/a_1+x_2𝐚_2/a_2+x_3𝐚_3/a_3). This new function, g(x1,x2,x3)(x_1,x_2,x_3), is now a function of three-variables, each of which has periodicity a1_1, a2_2, and a3_3 respectively: g(x1,x2,x3)=g(x1+a1,x2,x3)=g(x1,x2+a2,x3)=g(x1,x2,x3+a3).(x_1,x_2,x_3)=g(x_1+a_1,x_2,x_3)=g(x_1,x_2+a_2,x_3)=g(x_1,x_2,x_3+a_3). This enables us to build up a set of Fourier coefficients, each being indexed by three independent integers m1,m2,m3_1,m_2,m_3. In what follows, we use function notation to denote these coefficients, where previously we used subscripts. If we write a series for g on the interval [0,a1][0,a_1] for x1_1, we can define the following: hone(m1,x2,x3)≜1a1∫0a1g(x1,x2,x3)⋅e−i2πm1a1x1dx1^one(m_1,x_2,x_3)≜1/a_1∫_0^a_1g(x_1,x_2,x_3)^-i2πm_1/a_1x_1 dx_1 And then we can write: g(x1,x2,x3)=∑m1=−∞∞hone(m1,x2,x3)⋅ei2πm1a1x1(x_1,x_2,x_3)=∑_m_1=-∞^∞h^one(m_1,x_2,x_3)^i2πm_1/a_1x_1 Further defining: htwo(m1,m2,x3)≜1a2∫0a2hone(m1,x2,x3)⋅e−i2πm2a2x2dx2=1a2∫0a2dx21a1∫0a1dx1g(x1,x2,x3)⋅e−i2π(m1a1x1+m2a2x2)h^two(m_1,m_2,x_3) ≜1/a_2∫_0^a_2h^one(m_1,x_2,x_3)^-i2πm_2/a_2x_2 dx_2 =1/a_2∫_0^a_2dx_21/a_1∫_0^a_1dx_1g(x_1,x_2,x_3)^-i2π(m_1/a_1x_1+m_2/a_2x_2) We can write g once again as: g(x1,x2,x3)=∑m1=−∞∞∑m2=−∞∞htwo(m1,m2,x3)⋅ei2πm1a1x1⋅ei2πm2a2x2(x_1,x_2,x_3)=∑_m_1=-∞^∞∑_m_2=-∞^∞h^two(m_1,m_2,x_3)^i2πm_1/a_1x_1^i2πm_2/a_2x_2 Finally applying the same for the third coordinate, we define: hthree(m1,m2,m3)≜1a3∫0a3htwo(m1,m2,x3)⋅e−i2πm3a3x3dx3=1a3∫0a3dx31a2∫0a2dx21a1∫0a1dx1g(x1,x2,x3)⋅e−i2π(m1a1x1+m2a2x2+m3a3x3)h^three(m_1,m_2,m_3) ≜1/a_3∫_0^a_3h^two(m_1,m_2,x_3)^-i2πm_3/a_3x_3 dx_3 =1/a_3∫_0^a_3dx_31/a_2∫_0^a_2dx_21/a_1∫_0^a_1dx_1g(x_1,x_2,x_3)^-i2π(m_1/a_1x_1+m_2/a_2x_2+m_3/a_3x_3) We write g as: g(x1,x2,x3)=∑m1=−∞∞∑m2=−∞∞∑m3=−∞∞hthree(m1,m2,m3)⋅ei2πm1a1x1⋅ei2πm2a2x2⋅ei2πm3a3x3(x_1,x_2,x_3)=∑_m_1=-∞^∞∑_m_2=-∞^∞∑_m_3=-∞^∞h^three(m_1,m_2,m_3)^i2πm_1/a_1x_1^i2πm_2/a_2x_2^i2πm_3/a_3x_3 Re-arranging: g(x1,x2,x3)=∑m1,m2,m3∈Zhthree(m1,m2,m3)⋅ei2π(m1a1x1+m2a2x2+m3a3x3).(x_1,x_2,x_3)=∑_m_1,m_2,m_3∈ℤh^three(m_1,m_2,m_3)^i2π(m_1/a_1x_1+m_2/a_2x_2+m_3/a_3x_3). Now, every reciprocal lattice vector can be written (but does not mean that it is the only way of writing) as G=m1g1+m2g2+m3g3𝐆=m_1𝐠_1+m_2𝐠_2+m_3𝐠_3, where mi_i are integers and gi𝐠_i are reciprocal lattice vectors to satisfy gi⋅aj=2πδij𝐠_𝐢·𝐚_𝐣=2πδ_ij (δij=1δ_ij=1 for i=j=j, and δij=0δ_ij=0 for i≠j). Then for any arbitrary reciprocal lattice vector G𝐆 and arbitrary position vector r𝐫 in the original Bravais lattice space, their scalar product is: G⋅r=(m1g1+m2g2+m3g3)⋅(x1a1a1+x2a2a2+x3a3a3)=2π(x1m1a1+x2m2a2+x3m3a3).𝐆·𝐫=(m_1𝐠_1+m_2𝐠_2+m_3𝐠_3)·(x_1𝐚_1/a_1+x_2𝐚_2/a_2+x_3𝐚_3/a_3)=2π(x_1m_1/a_1+x_2m_2/a_2+x_3m_3/a_3). So it is clear that in our expansion of g(x1,x2,x3)=f(r)(x_1,x_2,x_3)=f(𝐫), the sum is actually over reciprocal lattice vectors: f(r)=∑Gh(G)⋅eiG⋅r,(𝐫)=∑_𝐆h(𝐆)^i𝐆·𝐫, where h(G)=1a3∫0a3dx31a2∫0a2dx21a1∫0a1dx1f(x1a1a1+x2a2a2+x3a3a3)⋅e−iG⋅r.(𝐆)=1/a_3∫_0^a_3dx_3 1/a_2∫_0^a_2dx_2 1/a_1∫_0^a_1dx_1 f(x_1𝐚_1/a_1+x_2𝐚_2/a_2+x_3𝐚_3/a_3)^-i𝐆·𝐫. Assuming r=(x,y,z)=x1a1a1+x2a2a2+x3a3a3,𝐫=(x,y,z)=x_1𝐚_1/a_1+x_2𝐚_2/a_2+x_3𝐚_3/a_3, we can solve this system of three linear equations for x, y, and z in terms of x1_1, x2_2 and x3_3 in order to calculate the volume element in the original rectangular coordinate system. Once we have x, y, and z in terms of x1_1, x2_2 and x3_3, we can calculate the Jacobian determinant: |∂x1∂x∂x1∂y∂x1∂z∂x2∂x∂x2∂y∂x2∂z∂x3∂x∂x3∂y∂x3∂z|_1 _1 _1 _2 _2 _2 _3 _3 _3 which after some calculation and applying some non-trivial cross-product identities can be shown to be equal to: a1a2a3a1⋅(a2×a3)a_1a_2a_3/𝐚_1·(𝐚_2×𝐚_3) (it may be advantageous for the sake of simplifying calculations, to work in such a rectangular coordinate system, in which it just so happens that a1𝐚_1 is parallel to the x axis, a2𝐚_2 lies in the xy-plane, and a3𝐚_3 has components of all three axes). The denominator is exactly the volume of the primitive unit cell which is enclosed by the three primitive-vectors a1𝐚_1, a2𝐚_2 and a3𝐚_3. In particular, we now know that dx1dx2dx3=a1a2a3a1⋅(a2×a3)⋅dxdydz._1 dx_2 dx_3=a_1a_2a_3/𝐚_1·(𝐚_2×𝐚_3) dy dz. We can write now h(G)(𝐆) as an integral with the traditional coordinate system over the volume of the primitive cell, instead of with the x1_1, x2_2 and x3_3 variables: h(G)=1a1⋅(a2×a3)∫Cdrf(r)⋅e−iG⋅r(𝐆)=1/𝐚_1·(𝐚_2×𝐚_3)∫_Cd𝐫f(𝐫)^-i𝐆·𝐫 writing dr𝐫 for the volume element dxdydz dy dz; and where C is the primitive unit cell, thus, a1⋅(a2×a3)𝐚_1·(𝐚_2×𝐚_3) is the volume of the primitive unit cell. Hilbert space