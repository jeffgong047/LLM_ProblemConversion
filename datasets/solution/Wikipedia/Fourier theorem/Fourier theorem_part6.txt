form: The Fourier series in amplitude-phase form is: Fourier series, amplitude-phase form s(x)∼A02+∑n=1∞An⋅cos⁡(2πnPx−φn)(x)∼A_0/2+∑_n=1^∞A_n·cos(2πnPx-φ_n) (Eq. 5) Its nth^th harmonic is An⋅cos⁡(2πnPx−φn)_n·cos(2πnPx-φ_n). An_n is the nth^th harmonic's amplitude and φnφ_n is its phase shift. The fundamental frequency of sN(x)_(x) is the term for when n equals 1, and can be referred to as the 1st1^st harmonic. A02A_02 is sometimes called the 0th0^th harmonic or DC component. It is the mean value of s(x)(x). Clearly Eq. 5 can represent functions that are just a sum of one or more of the harmonic frequencies. The remarkable thing, for those not yet familiar with this concept, is that it can also represent the intermediate frequencies and/or non-sinusoidal functions because of the potentially infinite number of terms (N). Fig 2. The blue curve is the cross-correlation of a square wave and a cosine function, as the phase lag of the cosine varies over one cycle. The amplitude and phase lag at the maximum value are the polar coordinates of one harmonic in the Fourier series expansion of the square wave. The corresponding rectangular coordinates can be determined by evaluating the cross-correlation at just two phase lags separated by 90º. The coefficients An_n and φnφ_n can be understood and derived in terms of the cross-correlation between s(x)(x) and a sinusoid at frequency nPnP. For a general frequency f,, and an analysis interval [x0,x0+P],[x_0,x_0+P], the cross-correlation function: Xf(τ)=2P∫Ps(x)⋅cos⁡(2πf(x−τ))dx;τ∈[0,2πf]X_f(τ)=2P∫_Ps(x)·cos(2(x-τ)) dx; τ∈[0,2πf] (Eq. 6) is essentially a matched filter, with template cos⁡(2πfx)cos(2).[B] Here ∫P∫_P denotes ∫x0x0+P.∫_x_0^x_0+P. If s(x)(x) is P-periodic, x0_0 is arbitrary, often chosen to be 00 or −P2.-P2. But in general, the Fourier series can also be used to represent a non-periodic function on just a finite interval, as depicted in Fig.1. The maximum of Xf(τ)X_f(τ) is a measure of the amplitude (a)(a) of frequency f in the function s(x)(x), and the value of ττ at the maximum determines the phase (φ)(φ) of that frequency. Figure 2 is an example, where s(x)(x) is a square wave (not shown), and frequency f is the 4th4^th harmonic. It is also an example of deriving the maximum from just two samples, instead of searching the entire function. That is made possible by a trigonometric identity:Equivalence of polar and rectangular forms cos⁡(2πnPx−φn)≡cos⁡(φn)⋅cos⁡(2πnPx)+sin⁡(φn)⋅sin⁡(2πnPx)cos(2πnPx-φ_n) equiv cos(φ_n)·cos(2πnPx)+sin(φ_n)·sin(2πnPx) (Eq. 7) Combining this with Eq. 6 gives: Xn(φ)=2P∫Ps(x)⋅cos⁡(2πnPx−φ)dx;φ∈[0,2π]=cos⁡(φ)⋅2P∫Ps(x)⋅cos⁡(2πnPx)dx⏟An+sin⁡(φ)⋅2P∫Ps(x)⋅sin⁡(2πnPx)dx⏟Bn=cos⁡(φ)⋅An+sin⁡(φ)⋅BnX_n(φ) =2P∫_Ps(x)·cos(2πnPx-φ) dx; φ∈[0,2π] =cos(φ)·2P∫_Ps(x)·cos(2πnPx) dx_A_n+sin(φ)·2P∫_Ps(x)·sin(2πnPx) dx_B_n =cos(φ)_n+sin(φ)_n which introduces the definitions of An_n and Bn_n.[5] And we note for later reference that a0_0 and b0_0 can be simplified: A0=2P∫Ps(x)dx,B0=0._0=2P∫_Ps(x)dx ,_0=0 .The derivative of Xn(φ)X_n(φ) is zero at the phase of maximum correlation.Xn′(φn)=sin⁡(φn)⋅An−cos⁡(φn)⋅Bn=0⟶tan⁡(φn)=BnAn⟶φn=arctan⁡(Bn,An)X'_n(φ_n)=sin(φ_n)_n-cos(φ_n)_n=0 ⟶ tan(φ_n)=B_n/A_n ⟶ φ_n=arctan(B_n,A_n)And the correlation peak value is: an=Xn(φn)=cos⁡(φn)⋅An+sin⁡(φn)⋅Bn=AnAn2+Bn2⋅An+BnAn2+Bn2⋅Bn=An2+Bn2An2+Bn2=An2+Bn2.a_n=X_n(φ_n)&=cos(φ_n)_n+sin(φ_n)_n =A_n/√(A_n^2+B_n^2)_n+B_n/√(A_n^2+B_n^2)_n=A_n^2+B_n^2/√(A_n^2+B_n^2) =√(A_n^2+B_n^2). Therefore An_n and Bn_n are the rectangular coordinates of a vector with polar coordinates an_n and φn.φ_n. Extensions to non-periodic