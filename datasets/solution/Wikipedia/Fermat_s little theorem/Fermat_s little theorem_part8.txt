test: The Miller–Rabin primality test uses the following extension of Fermat's little theorem:[14] If p is an odd prime and p − 1 = 2sd with s > 0 and d odd > 0, then for every a coprime to p, either ad ≡ 1 (mod p) or there exists r such that 0 ≤ r < s and a2rd ≡ −1 (mod p). This result may be deduced from Fermat's little theorem by the fact that, if p is an odd prime, then the integers modulo p form a finite field, in which 1 modulo p has exactly two square roots, 1 and −1 modulo p. Note that ad ≡ 1 (mod p) holds trivially for a ≡ 1 (mod p), because the congruence relation is compatible with exponentiation. And ad = a20d ≡ −1 (mod p) holds trivially for a ≡ −1 (mod p) since d is odd, for the same reason. That is why one usually chooses a random a in the interval 1 < a < p − 1. The Miller–Rabin test uses this property in the following way: given an odd integer p for which primality has to be tested, write p − 1 = 2sd with s > 0 and d odd > 0, and choose a random a such that 1 < a < p − 1; then compute b = ad mod p; if b is not 1 nor −1, then square it repeatedly modulo p until you get −1 or have squared s − 1 times. If b ≠ 1 and −1 has not been obtained by squaring, then p is a composite and a is a witness for the compositeness of p. Otherwise, p is a strong probable prime to base a; that is, it may be prime or not. If p is composite, the probability that the test declares it a strong probable prime anyway is at most 1⁄4, in which case p is a strong pseudoprime, and a is a strong liar. Therefore after k non-conclusive random tests, the probability that p is composite is at most 4−k, and may thus be made as low as desired by increasing k. In summary, the test either proves that a number is composite, or asserts that it is prime with a probability of error that may be chosen as low as desired. The test is very simple to implement and computationally more efficient than all known deterministic tests. Therefore, it is generally used before starting a proof of primality. See