3: The final example is one where integration would be extremely difficult. This is the case of the Wishart distribution, which is defined over matrices. Even taking derivatives is a bit tricky, as it involves matrix calculus, but the respective identities are listed in that article. From the above table, we can see that the natural parameter is given by η1=−12V−1,η_1=-1/2𝐕^-1, η2=n−p−12,η_2=n-p-1/2, the reverse substitutions are V=−12η1−1,𝐕=-1/2η_1^-1, n=2η2+p+1,=2η_2+p+1, and the sufficient statistics are (X,log⁡|X|).(𝐗,log|𝐗|). The log-partition function is written in various forms in the table, to facilitate differentiation and back-substitution. We use the following forms: A(η1,n)=−n2log⁡|−η1|+log⁡Γp(n2),(η_1,n)=-n/2log|-η_1|+logΓ_p(n/2), A(V,η2)=(η2+p+12)(plog⁡2+log⁡|V|)+log⁡Γp(η2+p+12).(𝐕,η_2)=(η_2+p+1/2)(plog2+log|𝐕|)+logΓ_p(η_2+p+1/2). Expectation of X (associated with η1) To differentiate with respect to η1, we need the following matrix calculus identity: ∂log⁡|aX|∂X=(X−1)T∂log|a𝐗|/∂𝐗=(𝐗^-1)^T Then: E⁡[X]=∂A(η1,…)∂η1=∂∂η1[−n2log⁡|−η1|+log⁡Γp(n2)]=−n2(η1−1)T=n2(−η1−1)T=n(V)T=nVE[𝐗] =(η_1,…)/∂η_1 =∂/∂η_1[-n/2log|-η_1|+logΓ_p(n/2)] =-n/2(η_1^-1)^T =n/2(-η_1^-1)^T =n(𝐕)^T =n𝐕 The last line uses the fact that V is symmetric, and therefore it is the same when transposed. Expectation of log |X| (associated with η2) Now, for η2, we first need to expand the part of the log-partition function that involves the multivariate gamma function: log⁡Γp(a)=log⁡(πp(p−1)4∏j=1pΓ(a+1−j2))=p(p−1)4log⁡π+∑j=1plog⁡Γ[a+1−j2]logΓ_p(a)=log(π^p(p-1)/4∏_j=1^pΓ(a+1-j/2))=p(p-1)/4logπ+∑_j=1^plogΓ[a+1-j/2] We also need the digamma function: ψ(x)=ddxlog⁡Γ(x).ψ(x)=d/dxlogΓ(x). Then: E⁡[log⁡|X|]=∂A(…,η2)∂η2=∂∂η2[−(η2+p+12)(plog⁡2+log⁡|V|)+log⁡Γp(η2+p+12)]=∂∂η2[(η2+p+12)(plog⁡2+log⁡|V|)+p(p−1)4log⁡π+∑j=1plog⁡Γ(η2+p+12+1−j2)]=plog⁡2+log⁡|V|+∑j=1pψ(η2+p+12+1−j2)=plog⁡2+log⁡|V|+∑j=1pψ(n−p−12+p+12+1−j2)=plog⁡2+log⁡|V|+∑j=1pψ(n+1−j2)E[log|𝐗|] =(…,η_2)/∂η_2 =∂/∂η_2[-(η_2+p+1/2)(plog2+log|𝐕|)+logΓ_p(η_2+p+1/2)] =∂/∂η_2[(η_2+p+1/2)(plog2+log|𝐕|)+p(p-1)/4logπ+∑_j=1^plogΓ(η_2+p+1/2+1-j/2)] =plog2+log|𝐕|+∑_j=1^pψ(η_2+p+1/2+1-j/2) =plog2+log|𝐕|+∑_j=1^pψ(n-p-1/2+p+1/2+1-j/2) =plog2+log|𝐕|+∑_j=1^pψ(n+1-j/2) This latter formula is listed in the Wishart distribution article. Both of these expectations are needed when deriving the variational Bayes update equations in a Bayes network involving a Wishart distribution (which is the conjugate prior of the multivariate normal distribution). Computing these formulas using integration would be much more difficult. The first one, for example, would require matrix integration.