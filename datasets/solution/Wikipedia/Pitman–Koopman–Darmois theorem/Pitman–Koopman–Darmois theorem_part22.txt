3: The final example is one where integration would be extremely difficult. This is the case of the Wishart distribution, which is defined over matrices. Even taking derivatives is a bit tricky, as it involves matrix calculus, but the respective identities are listed in that article. From the above table, we can see that the natural parameter is given by Î·1=âˆ’12Vâˆ’1,Î·_1=-1/2ğ•^-1, Î·2=nâˆ’pâˆ’12,Î·_2=n-p-1/2, the reverse substitutions are V=âˆ’12Î·1âˆ’1,ğ•=-1/2Î·_1^-1, n=2Î·2+p+1,=2Î·_2+p+1, and the sufficient statistics are (X,logâ¡|X|).(ğ—,log|ğ—|). The log-partition function is written in various forms in the table, to facilitate differentiation and back-substitution. We use the following forms: A(Î·1,n)=âˆ’n2logâ¡|âˆ’Î·1|+logâ¡Î“p(n2),(Î·_1,n)=-n/2log|-Î·_1|+logÎ“_p(n/2), A(V,Î·2)=(Î·2+p+12)(plogâ¡2+logâ¡|V|)+logâ¡Î“p(Î·2+p+12).(ğ•,Î·_2)=(Î·_2+p+1/2)(plog2+log|ğ•|)+logÎ“_p(Î·_2+p+1/2). Expectation of X (associated with Î·1) To differentiate with respect to Î·1, we need the following matrix calculus identity: âˆ‚logâ¡|aX|âˆ‚X=(Xâˆ’1)Tâˆ‚log|ağ—|/âˆ‚ğ—=(ğ—^-1)^T Then: Eâ¡[X]=âˆ‚A(Î·1,â€¦)âˆ‚Î·1=âˆ‚âˆ‚Î·1[âˆ’n2logâ¡|âˆ’Î·1|+logâ¡Î“p(n2)]=âˆ’n2(Î·1âˆ’1)T=n2(âˆ’Î·1âˆ’1)T=n(V)T=nVE[ğ—] =(Î·_1,â€¦)/âˆ‚Î·_1 =âˆ‚/âˆ‚Î·_1[-n/2log|-Î·_1|+logÎ“_p(n/2)] =-n/2(Î·_1^-1)^T =n/2(-Î·_1^-1)^T =n(ğ•)^T =nğ• The last line uses the fact that V is symmetric, and therefore it is the same when transposed. Expectation of log |X| (associated with Î·2) Now, for Î·2, we first need to expand the part of the log-partition function that involves the multivariate gamma function: logâ¡Î“p(a)=logâ¡(Ï€p(pâˆ’1)4âˆj=1pÎ“(a+1âˆ’j2))=p(pâˆ’1)4logâ¡Ï€+âˆ‘j=1plogâ¡Î“[a+1âˆ’j2]logÎ“_p(a)=log(Ï€^p(p-1)/4âˆ_j=1^pÎ“(a+1-j/2))=p(p-1)/4logÏ€+âˆ‘_j=1^plogÎ“[a+1-j/2] We also need the digamma function: Ïˆ(x)=ddxlogâ¡Î“(x).Ïˆ(x)=d/dxlogÎ“(x). Then: Eâ¡[logâ¡|X|]=âˆ‚A(â€¦,Î·2)âˆ‚Î·2=âˆ‚âˆ‚Î·2[âˆ’(Î·2+p+12)(plogâ¡2+logâ¡|V|)+logâ¡Î“p(Î·2+p+12)]=âˆ‚âˆ‚Î·2[(Î·2+p+12)(plogâ¡2+logâ¡|V|)+p(pâˆ’1)4logâ¡Ï€+âˆ‘j=1plogâ¡Î“(Î·2+p+12+1âˆ’j2)]=plogâ¡2+logâ¡|V|+âˆ‘j=1pÏˆ(Î·2+p+12+1âˆ’j2)=plogâ¡2+logâ¡|V|+âˆ‘j=1pÏˆ(nâˆ’pâˆ’12+p+12+1âˆ’j2)=plogâ¡2+logâ¡|V|+âˆ‘j=1pÏˆ(n+1âˆ’j2)E[log|ğ—|] =(â€¦,Î·_2)/âˆ‚Î·_2 =âˆ‚/âˆ‚Î·_2[-(Î·_2+p+1/2)(plog2+log|ğ•|)+logÎ“_p(Î·_2+p+1/2)] =âˆ‚/âˆ‚Î·_2[(Î·_2+p+1/2)(plog2+log|ğ•|)+p(p-1)/4logÏ€+âˆ‘_j=1^plogÎ“(Î·_2+p+1/2+1-j/2)] =plog2+log|ğ•|+âˆ‘_j=1^pÏˆ(Î·_2+p+1/2+1-j/2) =plog2+log|ğ•|+âˆ‘_j=1^pÏˆ(n-p-1/2+p+1/2+1-j/2) =plog2+log|ğ•|+âˆ‘_j=1^pÏˆ(n+1-j/2) This latter formula is listed in the Wishart distribution article. Both of these expectations are needed when deriving the variational Bayes update equations in a Bayes network involving a Wishart distribution (which is the conjugate prior of the multivariate normal distribution). Computing these formulas using integration would be much more difficult. The first one, for example, would require matrix integration.