Method to find local maxima and minima of differentiable functions on open sets
This article is about Fermat's theorem concerning the maximums and minimums of functions. For other theorems also named after Pierre de Fermat, see Fermat's theorem.
This article needs additional citations for verification. Please help improve this article by adding citations to reliable sources. Unsourced material may be challenged and removed.Find sources: "Fermat's theorem" stationary points – news · newspapers · books · scholar · JSTOR (July 2019) (Learn how and when to remove this template message)
In mathematics, Fermat's theorem (also known as interior extremum theorem) is a method to find local maxima and minima of differentiable functions on open sets by showing that every local extremum of the function is a stationary point (the function's derivative is zero at that point).  Fermat's theorem is a theorem in real analysis, named after Pierre de Fermat.
By using Fermat's theorem, the potential extrema of a function f, with derivative f′', are found by solving an equation in f′'. Fermat's theorem gives only a necessary condition for extreme function values, as some stationary points are inflection points (not a maximum or minimum). The function's second derivative, if it exists, can sometimes be used to determine whether a stationary point is a maximum or minimum.


Statement[edit]
One way to state Fermat's theorem is that, if a function has a local extremum at some point and is differentiable there, then the function's derivative at that point must be zero. In precise mathematical language:

Let f:(a,b)→R(a,b)→ℝ be a function and suppose that x0∈(a,b)_0∈(a,b) is a point where f has a local extremum. If f is differentiable at x0_0, then f′(x0)=0'(x_0)=0.
Another way to understand the theorem is via the contrapositive statement: if the derivative of a function at any point is not zero, then there is not a local extremum at that point. Formally:

If f is differentiable at x0∈(a,b)_0∈(a,b), and f′(x0)≠0'(x_0)≠0, then x0_0 is not a local extremum of f.
Corollary[edit]
The global extrema of a function f on a domain A occur only at boundaries, non-differentiable points, and stationary points.
If x0_0 is a global extremum of f, then one of the following is true:

boundary: x0_0 is in the boundary of A
non-differentiable: f is not differentiable at x0_0
stationary point: x0_0 is a stationary point of f
Extension[edit]
In higher dimensions, exactly the same statement holds; however, the proof is slightly more complicated. The complication is that in 1 dimension, one can either move left or right from a point, while in higher dimensions, one can move in many directions. Thus, if the derivative does not vanish, one must argue that there is some direction in which the function increases – and thus in the opposite direction the function decreases. This is the only change to the proof or the analysis.
The statement can also be extended to differentiable manifolds. If f:M→R:M→ℝ is a differentiable function on a manifold M, then its local extrema must be critical points of f, in particular points where the exterior derivative df is zero.[1][better source needed]

Applications[edit]
See also: Maxima and minima
Fermat's theorem is central to the calculus method of determining maxima and minima: in one dimension, one can find extrema by simply computing the stationary points (by computing the zeros of the derivative), the non-differentiable points, and the boundary points, and then investigating this set to determine the extrema.
One can do this either by evaluating the function at each point and taking the maximum, or by analyzing the derivatives further, using the first derivative test, the second derivative test, or the higher-order derivative test.

Intuitive argument[edit]
Intuitively, a differentiable function is approximated by its derivative – a differentiable function behaves infinitesimally like a linear function a+bx,+bx, or more precisely, f(x0)+f′(x0)(x−x0).(x_0)+f'(x_0)(x-x_0). Thus, from the perspective that "if f is differentiable and has non-vanishing derivative at x0,_0, then it does not attain an extremum at x0,_0," the intuition is that if the derivative at x0_0 is positive, the function is increasing near x0,_0, while if the derivative is negative, the function is decreasing near x0._0. In both cases, it cannot attain a maximum or minimum, because its value is changing. It can only attain a maximum or minimum if it "stops" – if the derivative vanishes (or if it is not differentiable, or if one runs into the boundary and cannot continue). However, making "behaves like a linear function" precise requires careful analytic proof.
More precisely, the intuition can be stated as: if the derivative is positive, there is some point to the right of x0_0 where f is greater, and some point to the left of x0_0 where f is less, and thus f attains neither a maximum nor a minimum at x0._0. Conversely, if the derivative is negative, there is a point to the right which is lesser, and a point to the left which is greater. Stated this way, the proof is just translating this into equations and verifying "how much greater or less".
The intuition is based on the behavior of polynomial functions. Assume that function f has a maximum at x0, the reasoning being similar for a function minimum. If x0∈(a,b)_0∈(a,b) is a local maximum then, roughly, there is a (possibly small) neighborhood of x0_0 such as the function "is increasing before" and "decreasing after"[note 1] x0_0. As the derivative is positive for an increasing function and negative for a decreasing function, f′' is positive before and negative after x0_0. f′' doesn't skip values (by Darboux's theorem), so it has to be zero at some point between the positive and negative values. The only point in the neighbourhood where it is possible to have f′(x)=0'(x)=0 is x0_0.
The theorem (and its proof below) is more general than the intuition in that it doesn't require the function to be differentiable over a neighbourhood around x0_0. It is sufficient for the function to be differentiable only in the extreme point.

Proof[edit]
Proof 1: Non-vanishing derivatives implies not extremum[edit]
Suppose that f is differentiable at x0∈(a,b),_0∈(a,b), with derivative K, and assume without loss of generality that K>0,>0, so the tangent line at x0_0 has positive slope (is increasing). Then there is a neighborhood of x0_0 on which the secant lines through x0_0 all have positive slope, and thus to the right of x0,_0, f is greater, and to the left of x0,_0, f is lesser.
The schematic of the proof is:

an infinitesimal statement about derivative (tangent line) at x0_0 implies
a local statement about difference quotients (secant lines) near x0,_0, which implies
a local statement about the value of f near x0._0.
Formally, by the definition of derivative, f′(x0)=K'(x_0)=K means that

limε→0f(x0+ε)−f(x0)ε=K.lim_ε→0f(x_0+ε)-f(x_0)/ε=K.
In particular, for sufficiently small εε (less than some ε0ε_0), the quotient must be at least K/2,/2, by the definition of limit. Thus on the interval (x0−ε0,x0+ε0)(x_0-ε_0,x_0+ε_0) one has:

f(x0+ε)−f(x0)ε>K/2;f(x_0+ε)-f(x_0)/ε>K/2;
one has replaced the equality in the limit (an infinitesimal statement) with an inequality on a neighborhood (a local statement). Thus, rearranging the equation, if ε>0,ε>0, then:

f(x0+ε)>f(x0)+(K/2)ε>f(x0),(x_0+ε)>f(x_0)+(K/2)ε>f(x_0),
so on the interval to the right, f is greater than f(x0),(x_0), and if ε<0,ε<0, then:

f(x0+ε)<f(x0)+(K/2)ε<f(x0),(x_0+ε)<f(x_0)+(K/2)ε<f(x_0),
so on the interval to the left, f is less than f(x0).(x_0).
Thus x0_0 is not a local or global maximum or minimum of f.

Proof 2: Extremum implies derivative vanishes[edit]
Alternatively, one can start by assuming that x0_0 is a local maximum, and then prove that the derivative is 0.
Suppose that x0_0 is a local maximum (a similar proof applies if x0_0 is a local minimum). Then there exists δ>0δ>0 such that (x0−δ,x0+δ)⊂(a,b)(x_0-δ,x_0+δ)⊂(a,b) and such that we have f(x0)≥f(x)(x_0)(x) for all x with |x−x0|<δ|x-x_0|<δ. Hence for any h∈(0,δ)∈(0,δ) we have

f(x0+h)−f(x0)h≤0.f(x_0+h)-f(x_0)/h≤0.
Since the limit of this ratio as h gets close to 0 from above exists and is equal to f′(x0)'(x_0) we conclude that f′(x0)≤0'(x_0)≤0. On the other hand, for h∈(−δ,0)∈(-δ,0) we notice that

f(x0+h)−f(x0)h≥0f(x_0+h)-f(x_0)/h≥0
but again the limit as h gets close to 0 from below exists and is equal to f′(x0)'(x_0) so we also have f′(x0)≥0'(x_0)≥0.
Hence we conclude that f′(x0)=0.'(x_0)=0.

Cautions[edit]
A subtle misconception that is often held in the context of Fermat's theorem is to assume that it makes a stronger statement about local behavior than it does. Notably, Fermat's theorem does not say that functions (monotonically) "increase up to" or "decrease down from" a local maximum. This is very similar to the misconception that a limit means "monotonically getting closer to a point". For "well-behaved functions" (which here means continuously differentiable), some intuitions hold, but in general functions may be ill-behaved, as illustrated below. The moral is that derivatives determine infinitesimal behavior, and that continuous derivatives determine local behavior.

Continuously differentiable functions[edit]
If f is continuously differentiable (C1)(C^1) on an open neighborhood of the point x0_0, then f′(x0)>0'(x_0)>0 does mean that f is increasing on a neighborhood of x0,_0, as follows.
If f′(x0)=K>0'(x_0)=K>0 and f∈C1,^1, then by continuity of the derivative, there is some ε0>0ε_0>0 such that f′(x)>K/2'(x)>K/2 for all x∈(x0−ε0,x0+ε0)∈(x_0-ε_0,x_0+ε_0). Then f is increasing on this interval, by the mean value theorem: the slope of any secant line is at least K/2,/2, as it equals the slope of some tangent line.
However, in the general statement of Fermat's theorem, where one is only given that the derivative at x0_0 is positive, one can only conclude that secant lines through x0_0 will have positive slope, for secant lines between x0_0 and near enough points.
Conversely, if the derivative of f at a point is zero (x0_0 is a stationary point), one cannot in general conclude anything about the local behavior of f – it may increase to one side and decrease to the other (as in x3^3), increase to both sides (as in x4^4), decrease to both sides (as in −x4-x^4), or behave in more complicated ways, such as oscillating (as in x2sin⁡(1/x)^2sin(1/x), as discussed below).
One can analyze the infinitesimal behavior via the second derivative test and higher-order derivative test, if the function is differentiable enough, and if the first non-vanishing derivative at x0_0 is a continuous function, one can then conclude local behavior (i.e., if f(k)(x0)≠0^(k)(x_0)≠0 is the first non-vanishing derivative, and f(k)^(k) is continuous, so f∈Ck^k), then one can treat f as locally close to a polynomial of degree k, since it behaves approximately as f(k)(x0)(x−x0)k,^(k)(x_0)(x-x_0)^k, but if the k-th derivative is not continuous, one cannot draw such conclusions, and it may behave rather differently.

Pathological functions[edit]
The function sin⁡(1/x)sin(1/x) – it oscillates increasingly rapidly between −1-1 and 11 as x approaches 0. Consequently, the function f(x)=(1+sin⁡(1/x))x2(x)=(1+sin(1/x))x^2 oscillates increasingly rapidly between 0 and 2x22x^2 as x approaches 0. If one extends this function by defining f(0)=0(0)=0 then the extended function is continuous and everywhere differentiable (it is differentiable at 0 with derivative 0), but has rather unexpected behavior near 0: in any neighborhood of 0 it attains 0 infinitely many times, but also equals 2x22x^2 (a positive number) infinitely often.
Continuing in this vein, one may define g(x)=(2+sin⁡(1/x))x2(x)=(2+sin(1/x))x^2, which oscillates between x2^2 and 3x23x^2.  The function has its local and global minimum at x=0=0, but on no neighborhood of 0 is it decreasing down to or increasing up from 0 – it oscillates wildly near 0.
This pathology can be understood because, while the function g is everywhere differentiable, it is not continuously differentiable: the limit of g′(x)'(x) as x→0→0 does not exist, so the derivative is not continuous at 0. This reflects the oscillation between increasing and decreasing values as it approaches 0.

See also[edit]
Optimization (mathematics)
Maxima and minima
Derivative
Extreme value
arg max
Adequality
Notes[edit]


^ This intuition is only correct for continuously differentiable (C1)(C^1) functions, while in general it is not literally correct—a function need not be increasing up to a local maximum: it may instead be oscillating, so neither increasing nor decreasing, but simply the local maximum is greater than any values in a small neighborhood to the left or right of it. See details in the pathologies.


References[edit]


^ "Is Fermat's theorem about local extrema true for smooth manifolds?". Stack Exchange. August 11, 2015. Retrieved 21 April 2017.


External links[edit]
"Fermat's Theorem (stationary points)". PlanetMath.
"Proof of Fermat's Theorem (stationary points)". PlanetMath.


vtePierre de FermatWork
Fermat's Last Theorem
Fermat number
Fermat's principle
Fermat's little theorem
Fermat polygonal number theorem
Fermat pseudoprime
Fermat point
Fermat's theorem (stationary points)
Fermat's theorem on sums of two squares
Fermat's spiral
Fermat's right triangle theorem
Related
List of things named after Pierre de Fermat
Wiles's proof of Fermat's Last Theorem
Fermat's Last Theorem in fiction
Fermat Prize
Fermat's Last Tango (2000 musical)
Fermat's Last Theorem (popular science book)




