Proof: While there are several proofs of this theorem, a common one is given below: For p = ∞, the inequality is trivial (since the average of a function is no larger than its essential supremum). For 1 < p < ∞, first we shall use the following version of the Vitali covering lemma to prove the weak-type estimate. (See the article for the proof of the lemma.) Lemma. Let X be a separable metric space and Fℱ a family of open balls with bounded diameter. Then Fℱ has a countable subfamily F′ℱ' consisting of disjoint balls such that ⋃B∈FB⊂⋃B∈F′5B⋃_B∈ℱB⊂⋃_B∈ℱ'5B where 5B is B with 5 times radius. If Mf(x) > t, then, by definition, we can find a ball Bx centered at x such that ∫Bx|f|dy>t|Bx|.∫_B_x|f|dy>t|B_x|. By the lemma, we can find, among such balls, a sequence of disjoint balls Bj such that the union of 5Bj covers {Mf > t}. It follows: |Mf>t|≤5d∑j|Bj|≤5dt∫|f|dy.|{Mf>t}|≤5^d∑_j|B_j|≤5^d∫|f|dy. This completes the proof of the weak-type estimate. We next deduce from this the Lp bounds. Define b by b(x) = f(x) if |f(x)| > t/2 and 0 otherwise. By the weak-type estimate applied to b, we have: |Mf>t|≤2Ct∫|f|>t2|f|dx,|{Mf>t}|≤2C∫_|f|>t/2|f|dx, with C = 5d. Then ‖Mf‖pp=∫∫0Mf(x)ptp−1dtdx=p∫0∞tp−1|Mf>t|dtMf_p^p=∫∫_0^Mf(x)pt^p-1dtdx=p∫_0^∞t^p-1|{Mf>t}|dt By the estimate above we have: ‖Mf‖pp≤p∫0∞tp−1(2Ct∫|f|>t2|f|dx)dt=2Cp∫0∞∫|f|>t2tp−2|f|dxdt=Cp‖f‖ppMf_p^p∫_0^∞t^p-1(2C∫_|f|>t/2|f|dx)dt=2Cp∫_0^∞∫_|f|>t/2t^p-2|f|dxdt=C_pf_p^p where the constant Cp depends only on p and d. This completes the proof of the theorem. Note that the constant C=5d=5^d in the proof can be improved to 3d3^d by using the inner regularity of the Lebesgue measure, and the finite version of the Vitali covering lemma. See the Discussion section below for more about optimizing the constant.