derivation: Although the virial theorem depends on averaging the total kinetic and potential energies, the presentation here postpones the averaging to the last step. For a collection of N point particles, the scalar moment of inertia I about the origin is defined by the equation I=∑k=1Nmk|rk|2=∑k=1Nmkrk2=∑_k=1^Nm_k|𝐫_k|^2=∑_k=1^Nm_kr_k^2 where mk and rk represent the mass and position of the kth particle. rk = |rk| is the position vector magnitude. The scalar G is defined by the equation G=∑k=1Npk⋅rk=∑_k=1^N𝐩_k·𝐫_k where pk is the momentum vector of the kth particle.[4] Assuming that the masses are constant, G is one-half the time derivative of this moment of inertia 12dIdt=12ddt∑k=1Nmkrk⋅rk=∑k=1Nmkdrkdt⋅rk=∑k=1Npk⋅rk=G.1/2dI/dt =1/2d/dt∑_k=1^Nm_k𝐫_k·𝐫_k =∑_k=1^Nm_k d𝐫_k/dt·𝐫_k =∑_k=1^N𝐩_k·𝐫_k=G . In turn, the time derivative of G can be written dGdt=∑k=1Npk⋅drkdt+∑k=1Ndpkdt⋅rk=∑k=1Nmkdrkdt⋅drkdt+∑k=1NFk⋅rk=2T+∑k=1NFk⋅rkdG/dt =∑_k=1^N𝐩_k·d𝐫_k/dt+∑_k=1^Nd𝐩_k/dt·𝐫_k =∑_k=1^Nm_kd𝐫_k/dt·d𝐫_k/dt+∑_k=1^N𝐅_k·𝐫_k =2T+∑_k=1^N𝐅_k·𝐫_k where mk is the mass of the kth particle, Fk = dpk/dt is the net force on that particle, and T is the total kinetic energy of the system according to the vk = drk/dt velocity of each particle T=12∑k=1Nmkvk2=12∑k=1Nmkdrkdt⋅drkdt.=1/2∑_k=1^Nm_kv_k^2=1/2∑_k=1^Nm_kd𝐫_k/dt·d𝐫_k/dt. Connection with the potential energy between