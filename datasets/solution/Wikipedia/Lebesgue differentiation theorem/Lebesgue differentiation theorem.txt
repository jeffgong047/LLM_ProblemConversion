Mathematical theorem in real analysis
In mathematics, the Lebesgue differentiation theorem is a theorem of real analysis, which states that for almost every point, the value of an integrable function is the limit of infinitesimal averages taken about the point. The theorem is named for Henri Lebesgue.


Statement[edit]
For a Lebesgue integrable real or complex-valued function f on Rn, the indefinite integral is a set function which maps a measurable set A to the Lebesgue integral of fâ‹…1AÂ·1_A, where 1A1_A denotes the characteristic function of the set A. It is usually written
Aâ†¦âˆ«AfdÎ»,â†¦âˆ«_Af
mathrmdÎ», 
with Î» the nâ€“dimensional Lebesgue measure.
The derivative of this integral at x is defined to be
limBâ†’x1|B|âˆ«BfdÎ»,lim_B1/|B|âˆ«_Bf dÎ»,
where |B| denotes the volume (i.e., the Lebesgue measure) of a ball Bâ€‰ centered at x, and BÂ â†’ x means that the diameter of Bâ€‰ tends to 0. 
The Lebesgue differentiation theorem (Lebesgue 1910) states that this derivative exists and is equal to f(x) at almost every point xÂ âˆˆ Rn.[1] In fact a slightly stronger statement is true. Note that:
|1|B|âˆ«Bf(y)dÎ»(y)âˆ’f(x)|=|1|B|âˆ«B(f(y)âˆ’f(x))dÎ»(y)|â‰¤1|B|âˆ«B|f(y)âˆ’f(x)|dÎ»(y).|1/|B|âˆ«_Bf(y) dÎ»(y)-f(x)|=|1/|B|âˆ«_B(f(y)-f(x)) dÎ»(y)|â‰¤1/|B|âˆ«_B|f(y)-f(x)| dÎ»(y).
The stronger assertion is that the right hand side tends to zero for almost every point x. The points x for which this is true are called the Lebesgue points of f.
A more general version also holds. One may replace the balls Bâ€‰ by a family Vð’± of sets Uâ€‰ of bounded eccentricity. This means that there exists some fixed cÂ > 0 such that each set Uâ€‰ from the family is contained in a ball Bâ€‰  with |U|â‰¥c|B||U| |B|.  It is also assumed that every point x âˆˆ Rn is contained in arbitrarily small sets from Vð’±. When these sets shrink to x, the same result holds: for almost every point x,
f(x)=limUâ†’x,UâˆˆV1|U|âˆ«UfdÎ».(x)=lim_U, Uâˆˆð’±1/|U|âˆ«_Uf dÎ».
The family of cubes is an example of such a family Vð’±, as is the family Vð’±(m) of rectangles in R2 such that the ratio of sides stays between mâˆ’1 and m, for some fixed mÂ â‰¥Â 1. If an arbitrary norm is given on Rn, the family of balls for the metric associated to the norm is another example.
The one-dimensional case was proved earlier by Lebesgue (1904). If f is integrable on the real line, the function
F(x)=âˆ«(âˆ’âˆž,x]f(t)dt(x)=âˆ«_(-âˆž,x]f(t) dt
is almost everywhere differentiable, with Fâ€²(x)=f(x).'(x)=f(x). Were F defined by a Riemann integral this would be essentially the fundamental theorem of calculus, but Lebesgue proved that it remains true when using the Lebesgue integral.[2]

Proof[edit]
The theorem in its stronger formâ€”that almost every point is a Lebesgue point of a locally integrable function fâ€”can be proved as a consequence of the weakâ€“L1 estimates for the Hardyâ€“Littlewood maximal function.  The proof below follows the standard treatment that can be found in Benedetto & Czaja (2009), Stein & Shakarchi (2005),  Wheeden & Zygmund (1977) and Rudin (1987).
Since the statement is local in character, f can be assumed to be  zero outside some ball of finite radius and hence integrable. It is then sufficient to prove that the set 

EÎ±=xâˆˆRn:limsup|B|â†’0,xâˆˆB1|B||âˆ«Bf(y)âˆ’f(x)dy|>2Î±_Î±={xâˆˆð‘^n:lim sup_|B|â†’0, x1/|B||âˆ«_Bf(y)-f(x) dy|>2Î±}
has measure 0 for all Î±Â >Â 0.
Let ÎµÂ >Â 0 be given. Using the density of continuous functions of compact support in L1(Rn), one can find such a function g satisfying

â€–fâˆ’gâ€–L1=âˆ«Rn|f(x)âˆ’g(x)|dx<Îµ.f-g_L^1=âˆ«_ð‘^n|f(x)-g(x)| dx<Îµ.
It is then helpful to rewrite the main difference as 

1|B|âˆ«Bf(y)dyâˆ’f(x)=(1|B|âˆ«B(f(y)âˆ’g(y))dy)+(1|B|âˆ«Bg(y)dyâˆ’g(x))+(g(x)âˆ’f(x)).1/|B|âˆ«_Bf(y) dy-f(x)=(1/|B|âˆ«_B(f(y)-g(y)) dy)+(1/|B|âˆ«_Bg(y) dy-g(x))+(g(x)-f(x)).
The first term can be bounded by the value at x of the maximal function for fÂ âˆ’Â g, denoted here by (fâˆ’g)âˆ—(x)(f-g)^*(x):

1|B|âˆ«B|f(y)âˆ’g(y)|dyâ‰¤supr>01|Br(x)|âˆ«Br(x)|f(y)âˆ’g(y)|dy=(fâˆ’g)âˆ—(x).1/|B|âˆ«_B|f(y)-g(y)| dyâ‰¤sup_r>01/|B_r(x)|âˆ«_B_r(x)|f(y)-g(y)| dy=(f-g)^*(x).
The second term disappears in the limit since g is a continuous function, and the third term is bounded by |f(x)Â âˆ’ g(x)|. For the absolute value of the original difference to be greater than 2Î± in the limit, at least one of the first or third terms must be greater than Î± in absolute value. However, the estimate on the Hardyâ€“Littlewood function says that

|x:(fâˆ’g)âˆ—(x)>Î±|â‰¤AnÎ±â€–fâˆ’gâ€–L1<AnÎ±Îµ,|{x:(f-g)^*(x)>Î±}|â‰¤A_n/Î± f-g_L^1<A_n/Î± Îµ,
for some constant An depending only upon the dimension n.  The Markov inequality (also called Tchebyshev's inequality) says that 

|x:|f(x)âˆ’g(x)|>Î±|â‰¤1Î±â€–fâˆ’gâ€–L1<1Î±Îµ|{x:|f(x)-g(x)|>Î±}|â‰¤1/Î± f-g_L^1<1/Î± Îµ
whence 

|EÎ±|â‰¤An+1Î±Îµ.|E_Î±|â‰¤A_n+1/Î± Îµ.
Since Îµ was arbitrary, it can be taken to be arbitrarily small, and the theorem follows.

Discussion of proof[edit]
The Vitali covering lemma is vital to the proof of this theorem; its role lies in proving the estimate for the Hardyâ€“Littlewood maximal function.
The theorem also holds if balls are replaced, in the definition of the derivative, by families of  sets with diameter tending to zero satisfying the Lebesgue's regularity condition, defined above as family of sets with bounded eccentricity. This follows since the same substitution can be made in the statement of the Vitali covering lemma.

Discussion[edit]
This is an analogue, and a generalization, of the fundamental theorem of calculus, which equates a Riemann integrable function and the derivative of its (indefinite) integral. It is also possible to show a converse â€“ that every differentiable function is equal to the integral of its derivative, but this requires a Henstockâ€“Kurzweil integral in order to be able to integrate an arbitrary derivative.
A special case of the Lebesgue differentiation theorem is the Lebesgue density theorem, which is equivalent to the differentiation theorem for characteristic functions of measurable sets. The density theorem is usually proved using a simpler method (e.g. see Measure and Category).
This theorem is also true for every finite Borel measure on Rn instead of Lebesgue measure (a proof can be found in e.g. (Ledrappier & Young 1985)). More generally, it is true of any finite Borel measure on a separable metric space such that at least one of the following holds:

the metric space is a Riemannian manifold,
the metric space is a locally compact ultrametric space,
the measure is doubling.
A proof of these results can be found in sections 2.8â€“2.9 of (Federer 1969).

See also[edit]
Lebesgue's density theorem
References[edit]


^ Folland, G. B. (1999). Real analysisÂ : modern techniques and their applications (2Â ed.). New York: Wiley. pp.Â Chapter 3. ISBNÂ 0-471-31716-0. OCLCÂ 39849337.

^ McDonald, John N. (2013). A course in real analysis. N. A. Weiss (2Â ed.). Boston, Mass.: Academic Press/Elsevier. ISBNÂ 978-0-12-387774-1. OCLCÂ 754105634.


Lebesgue, Henri (1904). LeÃ§ons sur l'IntÃ©gration et la recherche des fonctions primitives. Paris: Gauthier-Villars.
Lebesgue, Henri (1910). "Sur l'intÃ©gration des fonctions discontinues". Annales Scientifiques de l'Ã‰cole Normale SupÃ©rieure. 27: 361â€“450. doi:10.24033/asens.624.
Wheeden, Richard L.; Zygmund, Antoni (1977). Measure and Integral â€“ An introduction to Real Analysis. Marcel Dekker.
Oxtoby, John C. (1980). Measure and Category. Springer Verlag.
Stein, Elias M.; Shakarchi, Rami (2005). Real analysis. Princeton Lectures in Analysis, III. Princeton, NJ: Princeton University Press. pp.Â xx+402. ISBNÂ 0-691-11386-6. MR2129625
Benedetto, John J.; Czaja, Wojciech (2009). Integration And Modern Analysis. BirkhÃ¤user Advanced Texts. Springer. pp.Â 361â€“364. ISBNÂ 978-0817643065.
Rudin, Walter (1987). Real and complex analysis. International Series in Pure and Applied Mathematics (3rdÂ ed.). McGrawâ€“Hill. ISBNÂ 0070542341.
Ledrappier, F.; Young, L.S. (1985). "The Metric Entropy of Diffeomorphisms: Part I: Characterization of Measures Satisfying Pesin's Entropy Formula". Annals of Mathematics. 122 (3): 509â€“539. doi:10.2307/1971328. JSTORÂ 1971328.
Federer, Herbert (1969). Geometric measure theory. Die Grundlehren der mathematischen Wissenschaften, Band. Vol.Â 153. New York: Springer-Verlag New York Inc.
vteMeasure theoryBasic concepts
Absolute continuityÂ of measures
Lebesgue integration
Lp spaces
Measure
Measure space
Probability space
Measurable space/function
Sets
Almost everywhere
Atom
Baire set
Borel set
equivalence relation
Borel space
CarathÃ©odory's criterion
Cylindrical Ïƒ-algebra
Cylinder set
ðœ†-system
Essential range
infimum/supremum
Locally measurable
Ï€-system
Ïƒ-algebra
Non-measurable set
Vitali set
Null set
Support
Transverse measure
Universally measurable
Types of Measures
Atomic
Baire
Banach
Besov
Borel
Brown
Complex
Complete
Content
(Logarithmically)Â Convex
Decomposable
Discrete
Equivalent
Finite
Inner
(Quasi-)Â Invariant
Locally finite
Maximising
Metric outer
Outer
Perfect
Pre-measure
(Sub-)Â Probability
Projection-valued
Radon
Random
Regular
Borel regular
Inner regular
Outer regular
Saturated
Set function
Ïƒ-finite
s-finite
Signed
Singular
Spectral
Strictly positive
Tight
Vector
Particular measures
Counting
Dirac
Euler
Gaussian
Haar
Harmonic
Hausdorff
Intensity
Lebesgue
Infinite-dimensional
Logarithmic
Product
Projections
Pushforward
Spherical measure
Tangent
Trivial
Young
Maps
Measurable function
Bochner
Strongly
Weakly
Convergence: almost everywhere
of measures
in measure
of random variables
in distribution
in probability
Cylinder set measure
Random: compact set
element
measure
process
variable
vector
Projection-valued measure
Main results
CarathÃ©odory's extension theorem
Convergence theorems
Dominated
Monotone
Vitali
Decomposition theorems
Hahn
Jordan
Maharam's
Egorov's
Fatou's lemma
Fubini's
Fubiniâ€“Tonelli
HÃ¶lder's inequality
Minkowski inequality
Radonâ€“Nikodym
Rieszâ€“Markovâ€“Kakutani representation theorem
Other results
Disintegration theorem
Lifting theory
Lebesgue's density theorem
Lebesgue differentiation theorem
Sard's theorem
For Lebesgue measure
Isoperimetric inequality
Brunnâ€“Minkowski theorem
Milman's reverse
Minkowskiâ€“Steiner formula
PrÃ©kopaâ€“Leindler inequality
Vitale's random Brunnâ€“Minkowski inequality
ApplicationsÂ &Â related
Convex analysis
Descriptive set theory
Probability theory
Real analysis
Spectral theory




