codes: For 1 ≤ i ≤ n let si denote the word length of each possible xi. Define qi=a−si/C_i=a^-s_i/C, where C is chosen so that q1 + ... + qn = 1. Then H(X)=−∑i=1npilog2⁡pi≤−∑i=1npilog2⁡qi=−∑i=1npilog2⁡a−si+∑i=1npilog2⁡C=−∑i=1npilog2⁡a−si+log2⁡C≤−∑i=1n−sipilog2⁡a=ESlog2⁡aH(X) =-∑_i=1^np_ilog_2p_i ≤-∑_i=1^np_ilog_2q_i =-∑_i=1^np_ilog_2a^-s_i+∑_i=1^np_ilog_2C =-∑_i=1^np_ilog_2a^-s_i+log_2C ≤-∑_i=1^n-s_ip_ilog_2a =𝔼Slog_2a where the second line follows from Gibbs' inequality and the fifth line follows from Kraft's inequality: C=∑i=1na−si≤1=∑_i=1^na^-s_i≤1 so log C ≤ 0. For the second inequality we may set si=⌈−loga⁡pi⌉_i=⌈-log_ap_i⌉ so that −loga⁡pi≤si<−loga⁡pi+1-log_ap_i_i<-log_ap_i+1 and so a−si≤pi^-s_i_i and ∑a−si≤∑pi=1^-s_i≤_i=1 and so by Kraft's inequality there exists a prefix-free code having those word lengths. Thus the minimal S satisfies ES=∑pisi<∑pi(−loga⁡pi+1)=∑−pilog2⁡pilog2⁡a+1=H(X)log2⁡a+1𝔼S =_is_i <_i(-log_ap_i+1) =∑-p_ilog_2p_i/log_2a+1 =H(X)/log_2a+1 Extension to non-stationary independent