formalism: As usual in many-body electronic structure calculations, the nuclei of the treated molecules or clusters are seen as fixed (the Born–Oppenheimer approximation), generating a static external potential V, in which the electrons are moving. A stationary electronic state is then described by a wavefunction Ψ(r1, …, rN) satisfying the many-electron time-independent Schrödinger equation H^Ψ=[T^+V^+U^]Ψ=[∑i=1N(−ℏ22mi∇i2)+∑i=1NV(ri)+∑i<jNU(ri,rj)]Ψ=EΨ,ĤΨ=[T̂+V̂+Û]Ψ=[∑_i=1^N(-ħ^2/2m_i∇_i^2)+∑_i=1^NV(𝐫_i)+∑_i<j^NU(𝐫_i,𝐫_j)]Ψ=EΨ, where, for the N-electron system, Ĥ is the Hamiltonian, E is the total energy, T^T̂ is the kinetic energy, V^V̂ is the potential energy from the external field due to positively charged nuclei, and Û is the electron–electron interaction energy. The operators T^T̂ and Û are called universal operators, as they are the same for any N-electron system, while V^V̂ is system-dependent. This complicated many-particle equation is not separable into simpler single-particle equations because of the interaction term Û. There are many sophisticated methods for solving the many-body Schrödinger equation based on the expansion of the wavefunction in Slater determinants. While the simplest one is the Hartree–Fock method, more sophisticated approaches are usually categorized as post-Hartree–Fock methods. However, the problem with these methods is the huge computational effort, which makes it virtually impossible to apply them efficiently to larger, more complex systems. Here DFT provides an appealing alternative, being much more versatile, as it provides a way to systematically map the many-body problem, with Û, onto a single-body problem without Û. In DFT the key variable is the electron density n(r), which for a normalized Ψ is given by n(r)=N∫d3r2⋯∫d3rNΨ∗(r,r2,…,rN)Ψ(r,r2,…,rN).(𝐫)=N∫d^3𝐫_2⋯∫d^3𝐫_N Ψ^*(𝐫,𝐫_2,…,𝐫_N)Ψ(𝐫,𝐫_2,…,𝐫_N). This relation can be reversed, i.e., for a given ground-state density n0(r) it is possible, in principle, to calculate the corresponding ground-state wavefunction Ψ0(r1, …, rN). In other words, Ψ is a unique functional of n0,[14] Ψ0=Ψ[n0],Ψ_0=Ψ[n_0], and consequently the ground-state expectation value of an observable Ô is also a functional of n0: O[n0]=⟨Ψ[n0]|O^|Ψ[n0]⟩.[n_0]=⟨Ψ[n_0]|Ô|Ψ[n_0]⟩. In particular, the ground-state energy is a functional of n0: E0=E[n0]=⟨Ψ[n0]|T^+V^+U^|Ψ[n0]⟩,_0=E[n_0]=⟨Ψ[n_0]|T̂+V̂+Û|Ψ[n_0]⟩, where the contribution of the external potential ⟨Ψ[n0]|V^|Ψ[n0]⟩⟨Ψ[n_0]|V̂|Ψ[n_0]⟩ can be written explicitly in terms of the ground-state density n0_0: V[n0]=∫V(r)n0(r)d3r.[n_0]=(𝐫)n_0(𝐫) d^3𝐫. More generally, the contribution of the external potential ⟨Ψ|V^|Ψ⟩⟨Ψ|V̂|Ψ⟩ can be written explicitly in terms of the density n: V[n]=∫V(r)n(r)d3r.[n]=(𝐫)n(𝐫) d^3𝐫. The functionals T[n] and U[n] are called universal functionals, while V[n] is called a non-universal functional, as it depends on the system under study. Having specified a system, i.e., having specified V^V̂, one then has to minimize the functional E[n]=T[n]+U[n]+∫V(r)n(r)d3r[n]=T[n]+U[n]+(𝐫)n(𝐫) d^3𝐫 with respect to n(r), assuming one has reliable expressions for T[n] and U[n]. A successful minimization of the energy functional will yield the ground-state density n0 and thus all other ground-state observables. The variational problems of minimizing the energy functional E[n] can be solved by applying the Lagrangian method of undetermined multipliers.[17] First, one considers an energy functional that does not explicitly have an electron–electron interaction energy term, Es[n]=⟨Ψs[n]|T^+V^s|Ψs[n]⟩,_s[n]=⟨Ψ_s[n]|T̂+V̂_s|Ψ_s[n]⟩, where T^T̂ denotes the kinetic-energy operator, and V^sV̂_s is an effective potential in which the particles are moving. Based on Es_s, Kohn–Sham equations of this auxiliary noninteracting system can be derived: [−ℏ22m∇2+Vs(r)]φi(r)=εiφi(r),[-ħ^2/2m∇^2+V_s(𝐫)]φ_i(𝐫)=ε_iφ_i(𝐫), which yields the orbitals φi that reproduce the density n(r) of the original many-body system n(r)=∑i=1N|φi(r)|2.(𝐫)=∑_i=1^N|φ_i(𝐫)|^2. The effective single-particle potential can be written as Vs(r)=V(r)+∫n(r′)|r−r′|d3r′+VXC[n(r)],_s(𝐫)=V(𝐫)+∫n(𝐫')/|𝐫-𝐫'| d^3𝐫'+V_XC[n(𝐫)], where V(r)(𝐫) is the external potential, the second term is the Hartree term describing the electron–electron Coulomb repulsion, and the last term VXC is the exchange–correlation potential. Here, VXC includes all the many-particle interactions. Since the Hartree term and VXC depend on n(r), which depends on the φi, which in turn depend on Vs, the problem of solving the Kohn–Sham equation has to be done in a self-consistent (i.e., iterative) way. Usually one starts with an initial guess for n(r), then calculates the corresponding Vs and solves the Kohn–Sham equations for the φi. From these one calculates a new density and starts again. This procedure is then repeated until convergence is reached. A non-iterative approximate formulation called Harris functional DFT is an alternative approach to this. Notes The one-to-one correspondence between electron density and single-particle potential is not so smooth. It contains kinds of non-analytic structure. Es[n] contains kinds of singularities, cuts and branches. This may indicate a limitation of our hope for representing exchange–correlation functional in a simple analytic form. It is possible to extend the DFT idea to the case of the Green function G instead of the density n. It is called as Luttinger–Ward functional (or kinds of similar functionals), written as E[G]. However, G is determined not as its minimum, but as its extremum. Thus we may have some theoretical and practical difficulties. There is no one-to-one correspondence between one-body density matrix n(r, r′) and the one-body potential V(r, r′). (All the eigenvalues of n(r, r′) are 1.) In other words, it ends up with a theory similar to the Hartree–Fock (or hybrid) theory. Relativistic formulation (ab initio functional