
View
Online
Export
CitationCrossMarkMARCH 01 2023
A shorter path to some action variables 
Juan F . Zanella Béguelin  
Am. J. Phys.  91, 177–181 (2023)
https://doi.org/10.1 119/5.01 18683
Articles Y ou May Be Interested In
On the cohomology of Leibniz conformal algebras
J. Math. Phys.  (April 2015)
On the Leibniz bracket, the Schouten bracket and the Laplacian
J. Math. Phys.  (May 2004)
On a class of n-Leibniz deformations of the simple Filippov algebras
J. Math. Phys.  (February 201 1) 04 October 2023 22:50:03
A shorter path to some action variables
Juan F . Zanella B /C19eguelina)
Departamento de F /C19ısica, Facultad de Ciencias Exactas y Naturales, Universidad de Buenos Aires,
Ciudad Universitaria, 1428 Buenos Aires, Argentina
(Received 5 August 2022; accepted 13 January 2023)
This paper shows how to apply Leibniz’s integral rule to calculate the action variables for the
Kepler problem. This method offers an attractive alternative to the usual technique of complex
contour integration. The method presented here to calculate deﬁnite integrals has a broad scope andis especially suitable for undergraduates who are unfamiliar with complex analysis.
#2023 Published
under an exclusive license by American Association of Physics Teachers.
https://doi.org/10.1119/5.0118683
I. INTRODUCTION
This paper presents a method of calculating the action var-
iables in the Kepler problem that is simple and concise
enough to use during a lecture. The method, commonly
known as Feynman’s trick,1is based on Leibniz’s rule for
differentiating an integral.2–5It is a powerful tool for the
evaluation of deﬁnite integrals in that it can be simpler thancontour integration. Furthermore, its scope goes far beyondaction variables; for numerous examples and variations, seeRef. 1.
The idea is certainly as old as calculus, dating back to
Leibniz. It was brought back to light following the circulation
of Feynman’s memoir “Surely you’re joking, Mr. Feynman!”.As he recalled:
That book
3also showed how to differentiate
parameters under the integral sign … It turns outthat’s not taught very much in the universities …So because I was self-taught using that book, I hadpeculiar methods of doing integrals.
The result was, when guys at MIT or Princeton
had trouble doing a certain integral, it was becausethey couldn’t do it with the standard methods … Ifit was contour integration, they would have foundit; if it was a simple series expansion, they would
have found it. Then I come along and try
differentiating under the integral sign, and often itworked. So I got a great reputation for doingintegrals.
6
While students should be able to integrate without the aid
of tables or symbolic manipulators, those who put too muchconﬁdence in symbolic computation systems may be unableto discern whether or not the answers given by such systemsare sound. Feynman’s trick gives students another tool totackle difﬁcult integrals. It can also be very useful in class-
room settings, since without a simple method to compute the
Kepler action variables, a lecturer must choose between twounappealing options: carrying out the calculation in detail(which may lose the students’ attention) or stating the resultwithout derivation (which may leave students feeling dissat-isﬁed). Using Feynman’s trick, however, the action variablescan be calculated almost immediately.
This paper is organized as follows: Sec. IIoutlines the
Kepler problem in spherical coordinates, presents the integrals
that deﬁne the action variables, and summarizes the usualways in which these integrals are handled in the literature.Section IIIpresents Leibniz’s integral rule and its use forevaluating deﬁnite integrals. Section IVcontains the main
results, namely, the application of this method to calculate theaction variables in the Kepler problem. Section Vgives further
examples of the applicability of this method to other relatedproblems in the literature. Section VIadds some ﬁnal insight.
II. THE KEPLER PROBLEM IN ACTION-ANGLE
VARIABLES
Recall that when we transform from arbitrary canonical vari-
ables fq;pgto action-angle variables fJ;wg, the Hamiltonian
becomes a function of the action variables only
H¼HðJÞ: (1)
The motion of the system is given as follows:
_J
i¼0;
_wi¼xiðJÞ;(2)
where the constants
xiðJÞ¼@HðJÞ
@Ji(3)
are called the angular frequencies of the system. The motiva-
tion for this name is that any one-valued function of thefq;pgvariables is a multiply periodic function of the angle
variables w, and its period in each variable is 2 p. Equation
(1)encodes most of the global dynamical properties of the
system, hence its importance.
7
The bound motion in the Kepler problem is the key exam-
ple used to present action-angle variables for systems with
more than one degree of freedom.8In spherical coordinates,
the Hamiltonian for the Kepler problem is given as follows:
H¼1
2mp2
rþp2
h
r2þp2
u
r2sin2h !
/C0k
r; (4)
with k>0 and where pr,ph, and puare the conjugate
momenta. The Hamilton–Jacobi equation is completely sepa-rable and leads to the following relationships between themomenta and the separation constants a
1,a2, and E:
pu¼a1; (5)
p2
r
2mþa2
2
2mr2/C0k
r¼E; (6)
p2
hþa2
1
sin2h¼a2
2: (7)
177 Am. J. Phys. 91(3), March 2023 http://aapt.org/ajp #2023 Published under an exclusive license by AAPT 177 04 October 2023 22:50:03
Every pair of conjugate variables determines a plane in the
phase space. We may refer, for example, to the ðr;prÞplane.
Each of Eqs. (5)–(7) then deﬁnes an orbit in the correspond-
ing ( q,p) plane. For bound motion, Emust be negative. We
will assume that both a2
1anda2
2are strictly positive and,
moreover, because only a2
2appears in these equations, with-
out loss of generality we can assume that a2>0.
For each coordinate q, the action variable Jqis deﬁned as
the line integral of pover a complete period in the ( q,p)
plane
Ju¼1
2pþ
dupu¼a1; (8)
Jr¼1
2pþ
dr p r¼1
2pþ
drﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2mE þk
r/C0a2
2
2mr2/C18/C19s
; (9)
Jh¼1
2pþ
dhph¼1
2pþ
dhﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
a2
2/C0a21
sin2hs
: (10)
It is understood that at each point in the orbits, the square
roots have the same sign as the associated momenta. In prac-tice, the last two integrals are expressed as deﬁnite integralswith limits given by the turning points of randh. Taking
into account that these integrals are over closed and symmet-ric orbits, we have
J
r¼1
pðrþ
r/C0drﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2mE þk
r/C0a2
2
2mr2/C18/C19s
; (11)
Jh¼1
pðhþ
h/C0dhﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
a2
2/C0a21
sin2hs
; (12)
where r6andh6are the zeroes of each integrand, that is, the
values of randhfor which prandphare zero. These satisfy
0<r/C0/C20rþand 0 <h/C0/C20p=2/C20hþ<p. The integration
limits are, thus, functions of a1,a2, and E. A fact generally
overlooked is that it is not always necessary to calculatethese limits; all that one needs to know is that they are thezeroes of a particular function.
9
A survey of textbooks reveals that many authors avoid cal-
culating the integrals (11) and(12) altogether; only Calkin
presents a truly elementary way to compute both integrals,although this depends on invoking an ingenious manipula-tion of the integrands.
10In order to compute Jh, most authors
resort to elementary but cumbersome means. On the otherhand, the action J
ris normally calculated using contour inte-
gration. This method was introduced by Sommerfeld11and
Born12in the context of the old quantum theory. A remark
by Goldstein along this line is representative; he wrote thatthe integral in Eq. (9)“can be evaluated by elementary
means, but the integration is most elegantly and quickly per-formed using the method of residues.”
8Contour integration
is indeed an elegant and powerful technique, but even for
students familiar with it, its application to the Kepler prob-lem is so distinctive that in most scenarios it would requiremore lecture time than allowed. That is why it is useful tohave a straightforward method to calculate the action varia-bles without sacriﬁcing mathematical appeal.
13III. LEIBNIZ’S INTEGRAL RULE
Leibniz’s integral rule deals with deﬁnite integrals that
depend on one or more parameters.2–5The basic idea is dif-
ferentiation under the integral sign. We want to calculateintegrals of the form
jðaÞ¼ð
xþðaÞ
x/C0ðaÞdx fðx;aÞ: (13)
Leibniz’s rule asserts that
j0ðaÞ¼fðxþðaÞ;aÞdxþðaÞ
da/C0fðx/C0ðaÞ;aÞdx/C0ðaÞ
da
þðxþðaÞ
x/C0ðaÞdx@fðx;aÞ
@a: (14)
This identity holds if the last integral converges uniformly
with respect to a; see Ref. 4for a rigorous analysis. In the
case of the action variables, x/C0ðaÞand xþðaÞare the only
zeroes of f(x,a) in the interval ½x/C0ðaÞ;xþðaÞ/C138, which reduces
Eq.(14) to
j0ðaÞ¼ðxþðaÞ
x/C0ðaÞdx@fðx;aÞ
@a: (15)
Let us assume that we know how to calculate this integral, so
that j0ðaÞ¼gðaÞ. This is a differential equation that can be
solved for j(a),
jðaÞ¼ð
da gðaÞ/C17hðaÞþC: (16)
The constant of integration must be ﬁxed from a known
value of jat some given a. In particular, we know that j(a)i s
zero when x/C0ðaÞ¼xþðaÞ. Suppose that a0is the unique
value of awhich solves this equation. Then, we can write
jðaÞ¼hðaÞ/C0hða0Þ: (17)
This solves our problem.
The strategy of solving a deﬁnite integral via an ordinary
differential equation is well known in the context of Abelianintegrals;
14the resulting differential equation is called the
Picard–Fuchs equation.15The integrals calculated below can
be thought of as some of the simplest instances of this formal-ism; a more representative example can be found in Ref. 16.
IV. ACTION VARIABLES OF THE KEPLER
PROBLEM
In this section, I apply Feynman’s trick to the action varia-
bles of the Kepler problem. All subsequent calculations
involve just one elementary integral
ð
xþ
x/C0dxﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C0aþ2bx/C0cx2p ¼pﬃﬃﬃcp: (18)
The integration limits x/C0<xþ, assumed to be real, are the
zeroes of the quadratic. The integrals that we will ﬁnd belowcan be reduced to Eq. (18) by an obvious substitution.
178 Am. J. Phys., Vol. 91, No. 3, March 2023 Juan F. Zanella B /C19eguelin 178 04 October 2023 22:50:03
A. The action variable Jr
The integral we want to calculate in Eq. (11) depends on
several parameters. Rewrite it as
Jr¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2mjEjp
pðrþ
r/C0drﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C01þk
jEjr/C0a2
2
2mjEjr2s
(19)
and redeﬁne the integration variable to be dimensionless,
r¼2jEjr=k. Then,
Jr¼1
pﬃﬃﬃﬃﬃﬃﬃﬃ
mk2
2jEjs
jðaÞ; (20)
where
jðaÞ¼ðrþðaÞ
r/C0ðaÞdrﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C01þ2
r/C0a
r2r
; (21)
with
a¼2jEja2
2
mk2: (22)
The integration limits depend on a; they are the zeroes of the
argument of the square root in Eq. (21). Differentiating under
the integral sign gives
j0ðaÞ¼/C01
2ðrþðaÞ
r/C0ðaÞdr
r21ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C01þ2
r/C0a
r2r : (23)
Using the substitution x¼1=rand Eq. (18), this integral is
straightforward
j0ðaÞ¼/C01
2ðxþðaÞ
x/C0ðaÞdxﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C01þ2x/C0ax2p ¼/C0p
2ﬃﬃﬃap: (24)
This is valid even when a!1/C0. Nowhere in this chain of
substitutions, it is necessary to compute r6ðaÞorx6ðaÞ; all
we need to know is that the limits of integration are thezeroes of the argument of the square root.
Equation (24) can be solved for j(a),
jðaÞ¼ C/C0ﬃﬃﬃap/C0/C1
p: (25)
The constant of integration can be determined from the value
ofafor which integral (21) vanishes. This happens when the
integration limits r
þðaÞandr/C0ðaÞcoincide. Call a0the
solution of the equation rþðaÞ/C0r/C0ðaÞ¼0. Remember that
rþðaÞandr/C0ðaÞare the values of rat which the integrand
in Eq. (21) is zero. Because the argument of the square root
is a quadratic in 1 =r, its zeroes coincide when its discrimi-
nant,D¼4/C04a, is zero, which implies a0¼1. Therefore,
jðaÞ¼ﬃﬃﬃﬃﬃa0p/C0ﬃﬃﬃap/C0/C1
p¼1/C0ﬃﬃﬃap/C0/C1
p: (26)
Then, Eqs. (20) and(22) give
Jr¼ﬃﬃﬃﬃﬃﬃﬃﬃ
mk2
2jEjs
/C0a2: (27)In taking the square root of a, we have used that, according
to our deﬁnitions, a2>0.
Notice that instead of Eq. (21), by a different choice of the
dimensionless variable, we could just as well have deﬁned
jðaÞ¼ðrþðaÞ
r/C0ðaÞdrﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C0aþ2
r/C01
r2r
; (28)
or
jðaÞ¼ðrþðaÞ
r/C0ðaÞdrﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C01þ2a
r/C01
r2r
; (29)
in each case with a different deﬁnition of aand a different
prefactor in Eq. (20). After differentiation under the integral
sign, we would have obtained two other integrals, much sim-pler than Eq. (21) but not so simple as Eq. (23). This indi-
cates the need for some judgement in the choice of the
parameter with respect to which to take the derivative.
B. The action variable J
h
To calculate Jhin Eq. (12), rewrite it as
Jh¼ja1j
pjðaÞ; (30)
where now
jðaÞ¼ðhþðaÞ
h/C0ðaÞdhﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
a/C0csc2hp
; (31)
with a¼ða2=a1Þ2. The integration limits h/C0ðaÞ/C20hþðaÞare
the zeroes of the argument of the square root in the intervalð0;pÞ. Differentiating under the integral sign gives
j
0ðaÞ¼1
2ðhþðaÞ
h/C0ðaÞdh1ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
a/C0csc2hp ¼1
2ðhþðaÞ
h/C0ðaÞdhsinhﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
a/C01/C0acos2hp :
(32)
With the substitution x¼cosh, this integral reduces to the
one in Eq. (18)
j0ðaÞ¼1
2ðxþðaÞ
x/C0ðaÞdxﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
a/C01/C0ax2p ¼p
2ﬃﬃﬃap; (33)
which is valid even when a!1þ. Hence,
jðaÞ¼ﬃﬃﬃapþC/C0/C1
p: (34)
According to Eq. (31), the integration constant must be ﬁxed
in such a way that j(a) vanishes when atakes the value for
which h/C0ðaÞ¼hþðaÞor, equivalently, x/C0ðaÞ¼xþðaÞ.
However, x6ðaÞ¼6ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ða/C01Þ=ap
,s o j(a) is zero for a¼1.
Therefore,
jðaÞ¼ﬃﬃﬃap/C01/C0/C1
p: (35)
Then, Eq. (30) gives
Jh¼a2/C0ja1j: (36)
179 Am. J. Phys., Vol. 91, No. 3, March 2023 Juan F. Zanella B /C19eguelin 179 04 October 2023 22:50:03
Equations (8),(27), and (36) allow us to write the
Hamiltonian as a function of the action variables
HðJÞ¼/C0mk2
2JrþJhþjJuj/C0/C12: (37)
Taking the derivatives of Hwith respect to each action vari-
able, we obtain the angular frequencies of the system
xr¼xh¼ð/C02EÞ3=2
ﬃﬃﬃﬃﬃﬃﬃﬃ
mk2p /C17x;
xu¼signðJuÞx;(38)
which exhibit that the system is completely degenerate. The
motion is characterized by just one period, T¼2p=x, and
the orbit is closed. The system conﬁguration is not in factmultiply but simply periodic.
V. FURTHER EXAMPLES
A. A noncentral potential
We discuss a problem brought up by Scanio17concerning
the motion of a particle in a noncentral potential given by
Vðr;hÞ¼b2sec2h
2mr2/C0k
r: (39)
Despite the noncentrality, the Hamilton–Jacobi equation is
separable in spherical coordinates. While the radial actionvariable is the same as in the Kepler problem, the action var-iable J
hcan be expressed in terms of a dimensionless
integral
Jh¼ja2j
pI; (40)
where
I¼ðhþ
h/C0dhﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1/C0a
sin2h/C0b
cos2hr
; (41)
and where a¼ða1=a2Þ2;b¼ðb=a2Þ2with a1anda2being
the separation constants of the Hamilton–Jacobi equation. Itcan be assumed that the zeroes of the integrand, h6, satisfy
the inequalities 0 <h/C0/C20hþ<p=2. Scanio17calculated Eq.
(41) by the method of contour integration, which is not par-
ticularly brief or straightforward. In order to applyFeynman’s trick, we introduce an auxiliary parameter kand
consider Ia function of this parameter
IðkÞ¼ð
hþðkÞ
h/C0ðkÞdhﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
k/C0a
sin2h/C0b
cos2hr
: (42)
Differentiating with respect to kyields
I0ðkÞ¼1
2ðhþðkÞ
h/C0ðkÞdh1ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
k/C0a
sin2h/C0b
cos2hr : (43)
The substitution y¼sinhgives
I0ðkÞ¼1
2ðyþðkÞ
y/C0ðkÞyd yﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C0aþðkþa/C0bÞy2/C0ky4p : (44)Finally, after the substitution x¼y2, we can use Eq. (18)
I0ðkÞ¼1
4ðxþðkÞ
x/C0ðkÞdxﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
/C0aþðkþa/C0bÞx/C0kx2p ¼p
4ﬃﬃﬃ
kp:
(45)
Thus, integrating this differential equation gives
IðkÞ¼ﬃﬃﬃ
kp
þC/C0/C1p
2: (46)
The integration constant must be chosen in such a way that
IðkÞvanishes when h/C0ðkÞ¼hþðkÞor, equivalently, when
x/C0ðkÞ¼xþðkÞ. Then, a short calculation shows that
IðkÞ¼ﬃﬃﬃ
kp
/C0ﬃﬃﬃap/C0ﬃﬃﬃ
bp/C0/C1 p
2; (47)
which, in order to recover Eq. (41), should be evaluated at
k¼1. The reader is encouraged to try both contour integra-
tion and Calkin’s method.
B. Suggested problems
Other noncentral potentials for which Feynman’s trick can
be used to calculate the action Jhare of the form
Vðr;hÞ¼V1ðrÞ/C0b2fðhÞ
2mr2; (48)
with fðhÞ¼cothorfðhÞ¼cothcsch. These potentials
appear in the work of Makarov et al.18in the context of
Schr €odinger’s equation; their relevance stems from the fact
that they are separable in more than one coordinate system.The results for J
hobtained from contour integration can be
found in Ref. 19.
It is also an interesting exercise to apply the action-angle
formalism to the motion of an electric charge in the ﬁeld of acharged magnetic monopole. Here, the potential has two
components, the scalar potential VðrÞ¼/C0 k=rand the vector
potential AðrÞthat generates the monopole magnetic ﬁeld
BðrÞ¼/C15^r=r
2. One possible choice for the vector potential is
as follows:
AðrÞ¼/C0/C15coth
r^u: (49)
The Hamilton–Jacobi equation is separable: Jris the same as
in the Kepler problem, and Jhcan be calculated using
Feynman’s trick. The result can be found in Ref. 20.
VI. FINAL COMMENTS
I have always felt that the common lore that the action
variables allow us to obtain the motion frequencies with ease
was somewhat misleading. While the frequencies are easily
calculated by direct integration, action variables are not, andknowledge of the former allows a straightforward calculation
of the latter. This is especially true for the Kepler problem if
we are willing to use a priori knowledge. In the case of
bound motion, the expressions for the angular frequency and
the energy depend on the ellipse semi-major axis length a
exactly as if the orbits were circular
180 Am. J. Phys., Vol. 91, No. 3, March 2023 Juan F. Zanella B /C19eguelin 180 04 October 2023 22:50:03
mx2a¼k
a2;E¼/C0k
2a: (50)
Moreover, it is easily shown that for the actual circular orbits
Ec¼/C0mk2
2‘2; (51)
where ‘is the magnitude of the total angular momentum.
Then, we have, for any orbit [cf. Eq. (38)]
x¼ð/C02EÞ3=2
ﬃﬃﬃﬃﬃﬃﬃﬃ
mk2p : (52)
However, x¼@E=@Jr. Therefore,
Jr¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
mk2
/C02Er
þC: (53)
We also know that Jris zero for the circular orbits, because
they are isolated points in the ðr;prÞplane. Then, using Eq.
(51), we ﬁnd [cf. Eq. (27)]
Jr¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
mk2
/C02Er
/C0‘: (54)
To put things in another perspective, the following observa-
tion presents itself when one is faced with the action varia-bles: Their derivatives are simple, but the action variablesthemselves are hard to compute. Consider the expression
J
r¼1
pðrþ
r/C0drﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2mE þk
r/C0a2
2
2mr2/C18/C19s
: (55)
This integral is difﬁcult, but in practice, one is often inter-
ested in its derivative
@Jr
@E¼1
pðrþ
r/C0drﬃﬃﬃﬃﬃﬃﬃﬃﬃ
m=2p
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Eþk
r/C0a2
2
2mr2r : (56)
This integral is only moderately hard. Would it not be easier
to calculate @Jr=@Ein the ﬁrst place and then integrate in
order to obtain Jr? This works, but Eis not the only parame-
ter in Eq. (55), and calculating the derivative of Jrwith
respect a2
2would yield a truly easy integral
@Jr
@a2
2¼/C01
2pðrþ
r/C0dr
r21ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2mE þk
r/C0a2
2
2mr2/C18/C19s : (57)
This integral is trivial and can be used to calculate Jr.
It seems strange that the calculation of the action variables
has for so long remained outside the reach of Feynman’strick. Strictly it has not, but I had to examine over a hundredbooks on classical mechanics before I could ﬁnd one suchexample.
21There, the authors compute Jrfor the Kepler
problem, but they differentiate the integral with respect tothe energy, which is certainly not the most efﬁcient choice,and they are not careful about the dependence of the integra-
tion limits on the energy. Although I was anticipated in this
particular application of Feynman’s trick, I believe it is valu-
able to share this method with the community and make itmore widely known.
AUTHOR DECLARATIONS
Conflict of Interest
The author has no conﬂicts to disclose.
a)Electronic mail: zanellaj@df.uba.ar, ORCID: 0000-0003-0607-1160.
1P. J. Nahin, Inside Interesting Integrals , 2nd ed. (Springer Nature, Cham,
2020), Chap. 3.
2H. Flanders, “Differentiation under the integral sign,” Am. Math. Mon.
80(6), 615–627 (1973).
3F. S. Woods, Advanced Calculus (Ginn, Boston, 1934), Sec. 60.
4I. S. Sokolnikoff, Advanced Calculus (McGraw-Hill, New York, 1939),
Sec. 155.
5G. M. Fikhtengol’ts, The Fundamentals of Mathematical Analysis , Vol. II
(Pergamon Press, Oxford, 1965), pp. 141–147.
6R. P. Feynman, “Surely You’re Joking, Mr. Feynman!” Adventures of a
Curious Character (W. W. Norton, New York, 1985), pp. 86–87.
7J. V. Jos /C19e and E. J. Saletan, Classical Dynamics: A Contemporary
Approach (Cambridge U. P., Cambridge, 1998), Sec. 6.2.
8H. Goldstein, Classical Mechanics , 2nd ed. (Addison-Wesley, Reading,
MA, 1980), Sec. 10-7.
9However, if you intend to solve the integrals with a software system, you
will have to calculate the integration limits explicitly. And then nothing
guarantees that the system will be able to solve the deﬁnite integrals, evenwhen you provide all the needed assumptions. You can try your fortunewith the indeﬁnite integrals. If not in the most concise way, the systemwill almost surely be able to solve them, but then you should not be sur-prised if these solutions give unsound results when used to calculate thedeﬁnite integrals. This is usually because the antiderivative is not continu-
ous throughout the integration interval. See, for example, <https://blog.
wolfram.com/2008/01/19/mathematica-and-the-fundamental-theorem-of-calculus/ >
10M. G. Calkin, Lagrangian and Hamiltonian Mechanics (World Scientiﬁc,
Singapore, 1996), pp. 178–180.
11A. Sommerfeld, Atomic Structure and Spectral Lines , 3rd ed., Vol. I
(Methuen & Co. Ltd., London, 1934), p. 611.
12M. Born, The Mechanics of the Atom (G. Bell and Sons, London, 1927), p.
303.
13Another solution is possible: to consider the calculation of the action-
angle variables as a mere pretext to explain certain powerful and eleganttechniques of complex analysis.
14G. A. Bliss, Algebraic Functions (Dover Publications, Mineola, NY,
2004), Chap. V.
15M. Kreshchuk and T. Gulden, “The Picard–Fuchs equation in classical andquantum physics: Application to higher-order WKB method,” J. Phys. A:
Math. Theor. 52, 155301 (2019).
16G. Papadopoulos and H. R. Dullin, “Semi-global symplectic invariants of
the Euler top,” J. Geom. Mech. 5, 215–232 (2013).
17J. J. G. Scanio, “Beyond the Kepler problem–an action-angle example,”
Am. J. Phys. 45, 733–734 (1977).
18A. A. Makarov, J. A. Smorodinsky, K. Valiev, and P. Winternitz, “A sys-
tematic search for nonrelativistic systems with dynamical symmetries,”Nuovo Cimento A 52, 1061–1084 (1967).
19D. T. S. Perkins and R. A. Smith, “Exactness of Bohr-Sommerfeld quanti-
sation for two non-central potentials,” J. Phys. A: Math. Theor. 51, 455305
(2018).
20H. V. McIntosh and A. Cisneros, “Degeneracy in the presence of a mag-netic monopole,” J. Math. Phys. 11, 896–916 (1970).
21C. Gignoux and B. Silvestre-Brac, Solved Problems in Lagrangian
and Hamiltonian Mechanics (Springer, Dordrecht, 2009), pp.
314–315.
181 Am. J. Phys., Vol. 91, No. 3, March 2023 Juan F. Zanella B /C19eguelin 181 04 October 2023 22:50:03
