
View
Online
Export
CitationCrossMarkADVANCED TOPICS| MARCH 01 2023
Singular Lagrangians and the Dirac–Bergmann algorithm in
classical mechanics 
J. David Brown  
Am. J. Phys.  91, 214–224 (2023)
https://doi.org/10.1 119/5.0107540
Articles Y ou May Be Interested In
Bergmann ‐ Bianchi identities in field theories
AIP Conference Proceedings  (March 2005)
Presymplectic manifolds and the Dirac–Bergmann theory of constraints
J. Math. Phys.  (August 2008)
Elastic constants of plastic crystals by Schaefer ‐ Bergmann scattering
Rev Sci Instrum  (October 1984) 04 October 2023 22:50:20
ADVANCED TOPICS SECTION
The Advanced Topics Section is meant for articles that deal with physics more advanced than is typical of
regular articles in AJP. Though advanced, these articles have been judged to give clear presentations of
material useful to a segment of AJP readers.
Singular Lagrangians and the Dirac–Bergmann algorithm in classical
mechanics
J. David Browna)
Department of Physics, North Carolina State University, Raleigh, North Carolina 27695
(Received 5 July 2022; accepted 20 November 2022)
Textbook treatments of classical mechanics typically assume that the Lagrangian is nonsingular;
that is, the matrix of second derivatives of the Lagrangian with respect to the velocities is
invertible. This assumption ensures that (i) Lagrange’s equations can be solved for theaccelerations as functions of coordinates and velocities, and (ii) the deﬁnitions of the conjugate
momenta can be inverted to solve for the velocities as functions of coordinates and momenta. This
assumption, however, is unnecessarily restrictive—there are interesting classical dynamicalsystems with singular Lagrangians. The algorithm for analyzing such systems was developed by
Dirac and Bergmann in the 1950s. After a brief review of the Dirac–Bergmann algorithm, several
examples are presented using familiar components: point masses connected by massless springs,rods, cords, and pulleys.
#2023 Published under an exclusive license by American Association of Physics Teachers.
https://doi.org/10.1119/5.0107540
I. INTRODUCTION
The central focus of any advanced book on classical
mechanics is the Lagrangian formulation of dynamics. Withfew exceptions, these books assume that the LagrangianLðq;_qÞis nonsingular. That is, the matrix
L
ij/C17@2L
@_qi@_qj(1)
of second derivatives of Lwith respect to the velocities _qi
/C17dqi=dtis invertible. If Lijis not invertible, we cannot solve
Lagrange’s equations for the accelerations as functions ofthe coordinates and velocities.
The starting point for the Hamiltonian formulation of
mechanics is the Lagrangian. If L
ijis not invertible, the deﬁ-
nitions of momenta in terms of coordinates and velocitiescannot be inverted for the velocities as functions of coordi-
nates and momenta. The Hamiltonian theory cannot be con-
structed in the usual way.
The purpose of this article is to point out that there are, in
fact, physically interesting classical dynamical systems withsingular Lagrangians. The formalism for treating such systems
was developed in the 1950s by Dirac
1–5a n db yB e r g m a n na n d
collaborators,6–11following earlier work by Rosenfeld.12This
formalism is referred to as the Dirac–Bergmann algorithm. Tobe more precise, Dirac and Bergmann, and also Rosenfeld,13
showed that a singular Lagrangian system can be placed in theform of a “constrained Hamiltonian system” in which the evo-lution is constrained to a subspace of phase space. The singu-lar nature of the system is most clearly exhibited in the
Hamiltonian form.
The primary motivation for Dirac and Bergmann was to under-
stand the structure of ﬁeld theories such as electromagnetism andgeneral relativity. These theories, as well as Yang–Mills the-
ory and string theory, are gauge theories—they containdegrees of freedom that do not alter the physical state of thesystem. Gauge theories are described by singularLagrangians, but (as will be seen in the examples) not all sin-gular Lagrangian systems are gauge theories.
In Sec. II, we outline the Dirac–Bergmann algorithm, the
steps for converting a singular Lagrangian system into a con-strained Hamiltonian system. The detailed reasoning isspelled out in numerous books
14–21and review
articles.13,22,23Section IIIcontains a number of physical
examples of singular systems constructed from familiar ele-ments found in textbook classical mechanics problems: Pointmasses connected by massless springs, rods, cords, andpulleys.
In Sec. III A , we consider a “compound spring” obtained
by welding a spring with stiffness k
1and relaxed length ‘1to
a second spring with stiffness k2and relaxed length ‘2. The
system of Sec. III B consists of a pendulum attached to two
spring.24In Sec. III C, we analyze three masses moving on a
circular ring and connected by springs. None of these ﬁrstthree examples contain any gauge freedom.
In Sec. III D , we consider four masses ﬁxed at the centers
of freely extensible rods. The ends of the rods are connected,and the connection points (the “corners”) slide freely on thevertical posts. We consider two versions of this system: Onewith springs extending from the corners to the ceiling, theother with springs extending from the masses to the ceiling.In both cases, the system is described by a singularLagrangian, but the placement of the springs plays an impor-tant role, which is clearly revealed in the Hamiltonian formu-lation. When the springs are attached to the masses, thesystem contains gauge freedom. When the springs areattached to the corners, there is no gauge freedom.
214 Am. J. Phys. 91(3), March 2023 http://aapt.org/ajp #2023 Published under an exclusive license by AAPT 214 04 October 2023 22:50:20
The system discussed in Sec. III E consists of a single loop
of cord weaving between three pairs of pulleys. The lower
pulley of each pair is ﬁxed, while the upper pulley is attached
to a mass and a spring. This system is a gauge theory andcan be generalized to any number of pairs of pulleys.
Section IVlists two more problems described by singular
Lagrangians without solutions. These problems are left as
exercises for the reader.
The common element in each of these singular systems is
the presence of degrees of freedom with no inertial response.
Consider, for example, a two-particle system with coordi-
nates x
1,x2and Lagrangian L¼m1_x2
1=2þm2_x2
2=2
/C0Vðx1;x2Þ. The matrix of second derivatives of Lis nonsin-
gular since Lijis diagonal with entries m1andm2. Now set
the mass m1to zero so that Lbecomes singular. We can
now vary the coordinate x1without any inertial response—
changing x1does not cause any mass in the system to move.
This observation provides an intuitive test for singular sys-tems in classical mechanics. Imagine ﬁxing the location of
each mass, and ask: Is the system rigid? If not, then there are
degrees of freedom with no inertial response. TheLagrangian for such a system is singular.
Section Vcontains concluding remarks.
II. DIRAC–BERGMANN ALGORITHM
Consider a system with /C22Ngeneralized coordinates q
i,
where i¼1;…;/C22N. The velocities are denoted by _qi. The
Lagrangian Lðq;_qÞis assumed to be singular, so the rank of
the matrix Lij(the number of linearly independent rows or
columns) is less than /C22N,s a y , /C22M. We assume that the rank /C22M
is constant throughout phase space. The following is a short
summary of the Dirac–Bergmann algorithm for convertingthis system into constrained Hamiltonian form. This sum-
mary is not intended as a substitute for the more thorough
treatments given elsewhere.
13–23
•Compute the conjugate momenta pi¼@L=@_qi. Since the
Lagrangian is singular, these relations cannot be invertedfor the velocities as functions of coordinates and
momenta. This implies the existence of /C22N/C0/C22Mrelations
among the coordinates and momenta.
25These relations
are the primary constraints , denoted /aðq;pÞ¼0, with
the index aranging from 1 to /C22N/C0/C22M.
•Deﬁne the canonical Hamiltonian H Cby writing pi_qi
/C0Lðq;_qÞin terms of the q’s and p’s. It can be shown that
this is always possible. Note that HCðq;pÞis not unique,
because one can always use the constraints /aðq;pÞ¼0
to write some of the canonical variables in terms of others.
•Deﬁne the primary Hamiltonian H Pby adding the primary
constraints with Lagrange multipliers to the canonical
Hamiltonian. That is, HP¼HCþka/a, where kaare the
Lagrange multipliers.
•Impose the conditions ½/a;HP/C138¼0, referred to as
“consistency conditions,” where ½;/C138is the Poisson
bracket. These conditions ensure that the primary con-
straints are preserved under time evolution. The consis-tency conditions (one for each value of the index a) will
reduce to a combination of (i) identities when the primary
constraints /
aðq;pÞ¼0 hold; (ii) restrictions on the
Lagrange multipliers; and/or (iii) restrictions on the q’s
and p’s. The restrictions on the Lagrange multipliers
express some k’s in terms of q’s,p’s, and the remainingk’s. Restrictions on the q’s and p’s are secondary con-
straints , which we write as wmðq;pÞ¼0.
•The consistency conditions must be applied to the second-
ary constraints to ensure their preservation in time:½w
m;HP/C138¼0. This can yield identities, further restrictions
on the Lagrange multipliers, and/or tertiary constraints ,
which are further restrictions on the q’s and p’s. We
continue to apply the consistency conditions to identifyhigher–order constraints and restrictions on the Lagrangemultipliers. The process naturally stops when the consis-tency conditions have been applied to all constraints. Weextend the range of the index mand let w
mðq;pÞdenote all
of the secondary, tertiary, and higher-order constraints.
•The total Hamiltonian H Tis obtained from the primary
Hamiltonian HPby incorporating the restrictions on
Lagrange multipliers. In the most general case, a subset ofthe Lagrange multipliers will remain free.
•The primary, secondary, tertiary, etc., constraints /aand
wmare separated into ﬁrst and second class. First class
constraints have the property that their Poisson bracketwith allconstraints vanish when the constraints hold.
Second class constraints have nonvanishing Poissonbracket with at least one other constraint. Let C
ðfcÞ
adenote
the set of ﬁrst class constraints, and CðscÞ
ldenote the set of
second class constraints.
•A subset of ﬁrst class constraints can be constructed fromthe primary constraints /
aðq;pÞ. These are the primary
ﬁrst class constraints which we denote CðpfcÞ
A. It can be
shown that the total Hamiltonian can be written as
HT¼HfcþKACðpfcÞ
A, where the Lagrange multipliers KA
are free and the ﬁrst class Hamiltonian H fchas vanishing
Poisson bracket with all of the constraints (when the con-straints hold).
Before continuing, a few comments are in order. The
equations of motion generated by the total Hamiltonian H
T
through the Poisson bracket are equivalent to Lagrange’s
equations for the original Lagrangian system. Since theLagrange multipliers K
Aare completely arbitrary, the phase
space transformations generated by the primary ﬁrst classconstraints CðpfcÞ
Ado not change the physical state of the sys-
tem. We refer to such transformations as gauge transforma-
tions .26Therefore, primary ﬁrst class constraints generate
gauge transformations.
The Dirac conjecture14says that allﬁrst class constraints
CðfcÞ
agenerate gauge transformations. Counterexamples to
this conjecture have been described in the literature by anumber of researchers.
18,31–37Other researchers have argued
against these counterexamples, citing subtleties in the waythat the constraints are written.
19,38The Dirac conjecture is
often taken as an assumption.39
Here is the next step in the algorithm:
•Assuming the Dirac conjecture holds, each of the ﬁrstclass constraints has the status of a gauge generator. Theseconstraints can be treated on an equal footing by con-structing the extended Hamiltonian H
E¼HfcþKaCðfcÞ
a.
This is the sum of the ﬁrst class Hamiltonian Hfcand a lin-
ear combination of all ﬁrst class constraints with unre-stricted Lagrange multipliers K
a. The equations of motion
deﬁned by the extended Hamiltonian are not strictlyequivalent to the original Lagrangian equations of motion.Nevertheless, the theories agree for the evolution of
215 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 215 04 October 2023 22:50:20
physical variables (variables that are invariant under
gauge transformations.)
Phase space functions Fare evolved in time with either
the extended Hamiltonian, _F¼½F;HE/C138, or the total
Hamiltonian, _F¼½F;HT/C138. Physical trajectories are those that
lie in the subspace of phase space where the constraints hold.
The constraint relations can be used freely after computing
Poisson brackets, but not before. For example, the con-
straints can be used to alter the equations of motion _F
¼½F;HE/C138(or _F¼½F;HT/C138) but not the functions that appears
in the Poisson bracket.
We now have options. One option:
•Eliminate the second class constraints leaving the gauge free-
dom generated by the ﬁrst class constraints intact. We do thisby replacing the Poisson bracket with the Dirac bracket,
deﬁned as follows. Let M
l/C23¼½ CðscÞ
l;CðscÞ
/C23/C138denote the matrix
of Poisson brackets among the second class constraints, andletM
l/C23denote its inverse. The Dirac bracket is
F;G½/C138/C3¼F;G½/C138 /C0F;CðscÞ
lhi
Ml/C23CðscÞ
/C23;Ghi
; (2)
where Fand Gare phase space functions. (Summation
over repeated indices is implied.)
Like the Poisson bracket, the Dirac bracket is antisymmet-
ric and obeys the Jacobi identity. It also satisﬁes ½F;CðscÞ
l/C138/C3
¼0 for any phase space function F. This allows us to use the
second class constraints to simplify FandG before comput-
ing the bracket ½F;G/C138/C3.
Because the Poisson bracket of the extended Hamiltonian
with a second class constraint will vanish when the con-straints hold, it follows that ½F;H
E/C138/C3equals ½F;HE/C138when the
constraints hold (likewise for the total Hamiltonian HT).
Thus, the equations of motion can be deﬁned using either the
Dirac bracket or the Poisson bracket.
•We can now eliminate a subset of phase space variablesby imposing the second class constraints C
ðscÞ
l¼0 and
using the Dirac bracket. In particular, we can use CðscÞ
l¼0
to eliminate variables from the extended Hamiltonian (ortotal Hamiltonian), resulting in a partially reduced
Hamiltonian H
PR. Time evolution becomes _F¼½F;HPR/C138/C3.
A second option:
•Eliminate both ﬁrst and second class constraints by impos-
ing gauge conditions. Canonical gauge conditions, likeconstraints, are restrictions on the phase space variables.Let us denote the constraints and gauge conditions, com-
bined, by C
ðallÞ
M. A good set of gauge conditions will have
the property that CðallÞ
Mare second class. That is, the matrix
of Poisson brackets MMN¼½ CðallÞ
M;CðallÞ
N/C138is invertible. Let
MMNdenote the inverse and deﬁne the Dirac bracket by
F;G½/C138/C3¼F;G½/C138 /C0F;CðallÞ
Mhi
MMNCðallÞ
N;Ghi
; (3)
where summations over MandNare implied.
•Now use the constraints and gauge conditions CðallÞ
M¼0t o
eliminate a subset of phase space variables. We can elimi-nate variables from the extended Hamiltonian (or totalHamiltonian), resulting in a fully reduced Hamiltonian
H
FR. Time evolution becomes _F¼½F;HFR/C138/C3.In Sec. III, we apply the Dirac–Bergmann algorithm to
analyze problems in classical mechanics that are described
by singular Lagrangians.
III. EXAMPLES
A. Compound spring
Form a “compound spring” by welding two springs
together, as shown in Fig. 1. One end of the compound
spring is attached to the ceiling, and a mass mhangs from
the other end. Let x1andx2denote the lengths of the two
springs, so the distance between the ceiling and the mass isx
1þx2. The Lagrangian for this system is
L¼m
2ð_x1þ_x2Þ2þmgðx1þx2Þ/C0k1
2ðx1/C0‘1Þ2
/C0k2
2ðx2/C0‘2Þ2: (4)
The matrix of second derivatives of Lwith respect to the
velocities _xi,
Lij¼mm
mm/C18/C19
; (5)
is singular with rank 1. The momenta are
p1¼@L
@_x1¼mð_x1þ_x2Þ; (6a)
p2¼@L
@_x2¼mð_x1þ_x2Þ; (6b)
and we can identify the primary constraint
//C17p2/C0p1 (7)
by inspection.
Next, construct the canonical Hamiltonian by writing
pi_xi/C0L(a sum over the repeated index iis implied) in terms
ofp’s and x’s
HCðx;pÞ¼1
2mp1p2/C0mgðx1þx2Þþk1
2ðx1/C0‘1Þ2
þk2
2ðx2/C0‘2Þ2: (8)
Fig. 1. The compound spring. The mass moves vertically with gravity acting
in the downward direction. The generalized coordinates are the lengths of
the two springs.
216 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 216 04 October 2023 22:50:20
The leading term p1p2=ð2mÞcan be written in other ways,
such as p2
1=ð2mÞorðp2
1þp2
2Þ=ð4mÞ, by invoking the con-
straint /¼0.
The primary Hamiltonian is HP¼HCþk/. The consis-
tency condition ½/;HP/C138¼0 yields the secondary constraint
w¼k1ðx1/C0‘1Þ/C0k2ðx2/C0‘2Þ; (9)
and the condition ½w;HP/C138¼0 restricts the Lagrange multi-
plier to
k¼k1p2/C0k2p1
2mðk1þk2Þ: (10)
The application of consistency conditions is now complete.
The secondary constraint w¼0 has a direct physical inter-
pretation via Newton’s third law. It tells us that the force
k1ðx1/C0‘1Þthat spring 1 exerts on spring 2 is equal but oppo-
site to the force k2ð‘2/C0x2Þthat spring 2 exerts on spring 1.
The total Hamiltonian is obtained by using the result (10)
forkin the primary Hamiltonian
HT¼1
2mp1p2þk1p2/C0k2p1
2mðk1þk2Þðp2/C0p1Þ
/C0mgðx1þx2Þþk1
2ðx1/C0‘1Þ2þk2
2ðx2/C0‘2Þ2: (11)
The two constraints are second class, since ½/;w/C138¼k1þk2
is nonzero. There are no ﬁrst class constraints, so the system
has no gauge freedom and the total Hamiltonian, ﬁrst class
Hamiltonian, and extended Hamiltonian coincide: HT
¼Hfc¼HE.
LetCðscÞ
l¼f/;wgdenote the set of second class con-
straints. The matrix Ml/C23¼½ CðscÞ
l;CðscÞ
/C23/C138is invertible with
inverse
Ml/C23¼1
k1þk20/C01
10/C18/C19
: (12)
We now construct the Dirac bracket as in Eq. (2). The non-
zero brackets among the phase space variables are
x1;p1½/C138/C3¼x1;p2½/C138/C3¼k2=ðk1þk2Þ; (13a)
x2;p1½/C138/C3¼x2;p2½/C138/C3¼k1=ðk1þk2Þ: (13b)
We can use the constraints to eliminate two of the phase
space variables. For example, solving /¼w¼0 for x2and
p2, we ﬁnd
x2¼‘2þk1
k2ðx1/C0‘1Þ; (14a)
p2¼p1; (14b)
and the Hamiltonian reduces to
HR¼p2
1
2m/C0mg
k2ðk1þk2Þx1þk2‘2/C0k1‘1 ½/C138
þ1
2ðk1þk2
1=k2Þðx1/C0‘1Þ2: (15)
Note that in the absence of ﬁrst class constraints, the partially
and fully reduced Hamiltonians coincide. Here, we use HRto
denote this reduced Hamiltonian.The time evolution of any function of the phase space var-
iables x1,p1,x2,p2can be obtained from HRand the Dirac
bracket. In particular, we have
_x1¼x1;HR ½/C138/C3¼k2
mðk1þk2Þp1; (16a)
_p1¼p1;HR ½/C138/C3¼/C0k1ðx1/C0‘1Þþmg; (16b)
which form a closed set of differential equations for x1and
p1with a general solution
x1ðtÞ¼AcosðxtÞþBsinðxtÞþ‘1þmg=k1; (17a)
p1ðtÞ¼k1
xBcosðxtÞ/C0AsinðxtÞ ðÞ : (17b)
Here, AandBare constants, and the angular frequency is
deﬁned by
x¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
k1k2=ðmðk1þk2ÞÞp
: (18)
Given x1ðtÞ, we can determine x2as a function of time from
the result (14a) . The position of the mass below the ceiling,
x1ðtÞþx2ðtÞ, then follows. We ﬁnd that the mass executes
simple harmonic motion about its equilibrium position ‘1
þ‘2þmgðk1þk2Þ=ðk1k2Þwith angular frequency x.
B. Pendulum and two springs
Figure 2shows a pendulum of length ‘hanging from two
springs. Each spring has stiffness k, and for simplicity, we take
the relaxed length of each spring to be zero. The generalizedcoordinates are the Cartesian coordinates xandyof the point
where the springs attach to the pendulum, and the angle hof
the pendulum rod. (The Cartesian coordinate origin is midwaybetween the points where the springs attach to the ceiling. The
angle his measured from the negative y-axis.)
The kinetic energy for this system is T¼ðm=2Þð_X
2þ_Y2Þ,
where X¼xþ‘sinhandY¼y/C0‘coshare the Cartesian
coordinates of the mass m. The Lagrangian is
L¼m
2ð_x2þ_y2þ‘2_h2Þþm‘ð_xcoshþ_ysinhÞ_h
/C0mgðy/C0‘coshÞ/C0kðx2þy2þd2Þ; (19)
Fig. 2. A pendulum hanging from two springs. The springs are attached to
the ceiling at the points x¼6dandy¼0.
217 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 217 04 October 2023 22:50:20
and the matrix of second derivatives of Lwith respect to the
velocities _x;_y;_his
Lij¼m 0 m‘cosh
0 mm ‘sinh
m‘coshm‘sinh m‘20
@1
A: (20)
This matrix is singular with rank 2.
The momenta for this system are
px¼m_xþm‘_hcosh; (21a)
py¼m_yþm‘_hsinh; (21b)
ph¼m‘ð_xcoshþ_ysinhÞþm‘2_h: (21c)
Since the Lagrangian is quadratic in the velocities, the con-
straint can be constructed as /¼Viðpi/C0LiÞ, where the vec-
torVi¼ð /C0 ‘cosh;/C0‘sinh;1Þspans the null space of Lij.
(Details are given at the end of this paper.25) In this case,
Li¼0, and the primary constraint is
/¼/C0 ‘pxcosh/C0‘pysinhþph: (22)
The canonical Hamiltonian can be written as
HC¼1
2mðp2
xþp2
yÞþkðx2þy2þd2Þ
þmgðy/C0‘coshÞ; (23)
and the primary Hamiltonian is HP¼HCþk/.
The consistency condition ½/;HP/C138¼0 yields the second-
ary constraint
w¼2k‘ðxcoshþysinhÞ; (24)
which gives tan h¼/C0x=y. This tells us that the angle of the
force exerted by the springs on the massless connection point
must coincide with the angle of the pendulum rod. This is aconsequence of Newton’s third law—the forces exerted bythe springs on the rod must be equal in magnitude but oppo-
site in direction to the force that the rod exerts on the
springs—and the fact that the rod can only exert a forcealong its own direction, at angle h.
The condition ½w;H
P/C138¼0 determines the Lagrange multi-
plier to be
k¼pxcoshþpysinh
mð‘þxsinh/C0ycoshÞ; (25)
and
HT¼1
2mðp2
xþp2
yÞþkðx2þy2þd2Þþmgðy/C0‘coshÞ
þpxcoshþpysinh
mð‘þxsinh/C0ycoshÞ
/C2ð /C0 ‘pxcosh/C0‘pysinhþphÞ (26)
is the total Hamiltonian.
Note that the denominator in Eq. (25) is the coefﬁcient of
kin½w;HP/C138. This coefﬁcient vanishes when x¼/C0 ‘sinh;
y¼‘cosh. At these points in phase space, the Lagrange
multiplier is not determined. This is not a shortcoming of theDirac–Bergmann formalism, rather, it is a property of the
physical system deﬁned by the Lagrangian (19). When
x¼/C0 ‘sinhandy¼‘cosh, the mass mis at the origin, and
the pendulum rod can rotate without any inertial resistance,and without any change in the potential energy. Thus, atthese points in phase space, the system exhibits a gauge-like
freedom in which multiple conﬁgurations are physically
indistinguishable. We can avoid this complication by assum-ing the mass stays below the ceiling, so that Y¼y/C0‘cosh
is always negative.
With this assumption, the constraints are second class:
½/;w/C138¼2k‘ð‘þxsinh/C0ycoshÞ6¼0. There is no gauge
freedom, so H
E¼Hfc¼HT. We can construct the Dirac
bracket from Eq. (2)with
Ml/C23¼1
2k‘ð‘þxsinh/C0ycoshÞ0/C01
10/C18/C19
: (27)
The constraints /¼w¼0 imply40
h¼/C0arctan ðx=yÞ; (28a)
ph¼‘ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2þy2p ðxpy/C0ypxÞ; (28b)
and we can use these results to reduce the Hamiltonian
HR¼1
2mðp2
xþp2
yÞþmgy 1þ‘=ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2þy2p/C16/C17
þkðx2þy2þd2Þ: (29)
The nonzero Dirac brackets among the remaining variables
are
x;px½/C138/C3¼rþ‘x2=r2
rþ‘; (30a)
x;py½/C138/C3¼y;px½/C138/C3¼‘xy=r2
rþ‘; (30b)
y;py½/C138/C3¼rþ‘y2=r2
rþ‘; (30c)
where r/C17ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2þy2p
. The equations of motion are
_x¼x;HR½/C138/C3¼‘xðxpxþypyÞþpxr3
mr2ðrþ‘Þ; (31a)
_y¼y;HR½/C138/C3¼‘yðxpxþypyÞþpyr3
mr2ðrþ‘Þ; (31b)
_px¼px;HR ½/C138/C3¼/C02kx; (31c)
_py¼py;HR ½/C138/C3¼/C0mg/C02ky: (31d)
These can be solved numerically in a straightforward fash-
ion. The angle hðtÞand its conjugate phðtÞfollow from
Eqs. (28).
C. Masses, springs, and ring
Three identical masses slide without friction on a ring of
radius R. The masses are connected by springs, as shown
in Fig. 3. Each spring has stiffness k, and for simplicity,
218 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 218 04 October 2023 22:50:20
we set the relaxed lengths equal to zero. The generalized
coordinates for this system are the angles h1,h2,h3of the
three masses and the Cartesian coordinates xandyof the
point where the springs connect. (The origin is at the centerof the ring. All angles are measured with respect to the x-
axis.)
The Lagrangian for this system is
L¼mR2
2ð_h2
1þ_h2
2þ_h2
3Þ/C0Vðh;x;yÞ (32)
with potential energy
Vðh;x;yÞ¼k
2n
ðx/C0Rcosh1Þ2þðy/C0Rsinh1Þ2
þðx/C0Rcosh2Þ2þðy/C0Rsinh2Þ2
þðx/C0Rcosh3Þ2þðy/C0Rsinh3Þ2o
:(33)
The conjugate momenta are
pi/C17@L
@_hi¼mR2_hi; (34a)
px/C17@L
@_x¼0; (34b)
py/C17@L
@_y¼0; (34c)
where i¼1, 2, and 3. We have two primary constraints
/1¼px; (35a)
/2¼py; (35b)
and the primary Hamiltonian is
HP¼1
2mR2ðp2
1þp2
2þp2
3ÞþVðh;x;yÞþk1pxþk2py:
(36)
The consistency conditions ½/a;HP/C138¼0 lead to the second-
ary constraintsw1¼kRðcosh1þcosh2þcosh3Þ/C03kx; (37a)
w2¼kRðsinh1þsinh2þsinh3Þ/C03ky; (37b)
and the conditions ½wm;HP/C138¼0 yield restrictions on the
Lagrange multipliers
k1¼/C01
3mRðp1sinh1þp2sinh2þp3sinh3Þ; (38a)
k2¼1
3mRðp1cosh1þp2cosh2þp3cosh3Þ: (38b)
The secondary constraints tell us that the three springs connect
at the point given by the average location of the three masses.
This is required for the forces ~Fi¼/C0kðx/C0Rcoshi;y
/C0RsinhiÞthat the springs exert on the massless connection
point to sum to zero.
Inserting the results for the Lagrange multipliers into the
primary Hamiltonian, we ﬁnd the total Hamiltonian
HT¼1
2mR2ðp2
1þp2
2þp2
3ÞþVðh;x;yÞ
/C0px
3mRðp1sinh1þp2sinh2þp3sinh3Þ
þpy
3mRðp1cosh1þp2cosh2þp3cosh3Þ: (39)
The constraints CðscÞ
l¼f/1;/2;w1;w2gare second class
with Poisson bracket
Ml/C23¼CðscÞ
l;CðscÞ
/C23hi
¼00 3 k0
00 0 3 k
/C03k 00 0
0/C03k000
BB@1
CCA:
(40)
We now construct the Dirac bracket as deﬁned in Eq. (2).
The brackets among the phase space variables include
h
i;pj/C2/C3/C3¼dij; (41a)
x;pi½/C138/C3¼/C0R
3sinhi; (41b)
y;pi½/C138/C3¼R
3coshi; (41c)
where iandjrange over 1, 2, and 3. The remaining Dirac
brackets vanish.
We can use the constraints to eliminate four of the phase
space variables; the natural choice is x,y,px, and py. From
CðscÞ
l¼0, we ﬁnd px¼py¼0 and
x¼R
3ðcosh1þcosh2þcosh3Þ; (42a)
y¼R
3ðsinh1þsinh2þsinh3Þ: (42b)
The reduced Hamiltonian is
HR¼1
2mR2ðp2
1þp2
2þp2
3Þ/C0kR2
3cosðh1/C0h2Þ ð
þcosðh2/C0h3Þþcosðh3/C0h1ÞÞ þ kR2: (43)
Fig. 3. Three masses connected by springs move without friction on a circu-
lar ring.
219 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 219 04 October 2023 22:50:20
From here, we obtain the equations of motion for the angles
_hi¼hi;HR½/C138/C3¼pi=ðmR2Þ; (44)
and their conjugate momenta
_p1¼p1;HR ½/C138/C3¼kR2
3sinðh2/C0h1Þþsinðh3/C0h1Þ ðÞ ;
(45a)
_p2¼p3;HR ½/C138/C3¼kR2
3sinðh3/C0h2Þþsinðh1/C0h2Þ ðÞ ;
(45b)
_p3¼p3;HR ½/C138/C3¼kR2
3sinðh1/C0h3Þþsinðh2/C0h3Þ ðÞ :
(45c)
It is straightforward to solve these equations numerically.
Equations (42) then determine the coordinates x,yas a func-
tion of time.
D. Masses, rods, and springs
The system shown in Fig. 4consists of four masses ﬁxed
at the midpoints of four massless, freely extensible rods. A
freely extensible rod is rigid in transverse directions butdoes not have a ﬁxed length.
41That is, the rods can expand
or contract as needed to span the distance between the
vertical posts. Figure 4shows two versions of this system.
In the left ﬁgure, springs are attached to the connection
points between the rods (the “corners” with coordinates
y1–y4). In the right ﬁgure, the springs are attached to the
masses.
The Lagrangian for this system is
L¼m
2/C20_y1þ_y2
2/C18/C192
þ_y2þ_y3
2/C18/C192
þ_y3þ_y4
2/C18/C192
þ_y4þ_y1
2/C18/C192/C21
/C0VðyÞ; (46)
with potential energyVðyÞ¼mg y 1þy2þy3þy4 ½/C138 þk
2/C2
ða/C0y1Þ2
þða/C0y2Þ2þða/C0y3Þ2þða/C0y4Þ2/C3
(47)
when the springs are attached to the corners, and
VðyÞ¼mg y 1þy2þy3þy4 ½/C138 þk
8/C2
ð2a/C0y1/C0y2Þ2
þð2a/C0y2/C0y3Þ2þð2a/C0y3/C0y4Þ2
þð2a/C0y4/C0y1Þ2/C3
(48)
when the springs are attached to the masses. Here, kdenotes
the spring constant and a¼h/C0‘, where his the height of
the ceiling and ‘is the relaxed length of each spring.
The momenta are
p1¼m
4ð_y4þ2_y1þ_y2Þ; (49a)
p2¼m
4ð_y1þ2_y2þ_y3Þ; (49b)
p3¼m
4ð_y2þ2_y3þ_y4Þ; (49c)
p4¼m
4ð_y3þ2_y4þ_y1Þ; (49d)
which yield the single primary constraint
/¼p1/C0p2þp3/C0p4: (50)
The canonical Hamiltonian is given by
HC¼1
2m/C205
2ðp2
1þp2
2þp2
3þp2
4Þ
/C02ðp1p2þp2p3þp3p4þp4p1Þ
þp1p3þp2p4/C21
þVðyÞ; (51)
and the primary Hamiltonian is HP¼HCþk/.
Focus on the case shown on the left of Fig. 4, with springs
attached to the corners and the potential energy of Eq. (47).
The consistency conditions yield a secondary constraint
Fig. 4. Four massless, freely extensible rods are connected to each other at the corner posts. The rods slide freely along the posts. In the left ﬁgure, s prings are
attached to the corners. In the right ﬁgure, springs are attached to the masses.
220 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 220 04 October 2023 22:50:20
w¼/C0kðy1/C0y2þy3/C0y4Þ; (52)
and the restriction
k¼/C05
4mðp1/C0p2þp3/C0p4Þ (53)
on the Lagrange multiplier. The Lagrange multiplier can be
simpliﬁed to k¼0 using the constraint /¼0.
The secondary constraint is interesting, because it places a
restriction on the conﬁguration of the system that might not be
obvious. One can imagine moving any one of the corners, byhand, independently of the others. The mechanical arrange-
ment of rods and posts does not place any restrictions on the y
values. However, as a dynamical system, the y’s must obey
y
1/C0y2þy3/C0y4¼0. This is because the y’s can be changed
while keeping the masses in place. For example, if y1andy3
are increased by some amount dy, while y2and y4are
decreased by the same amount dy, the masses remain
unmoved. There is no inertial resistance to this type of motion.
As a result, the springs can instantly “snap” the corners into
the preferred conﬁguration satisfying y1/C0y2þy3/C0y4¼0.
This is the conﬁguration that minimizes the potential (47)
while keeping the locations of the masses ﬁxed.
In this example, the total Hamiltonian HTcoincides with
the canonical Hamiltonian HC. The constraints /,ware sec-
ond class, so we can use them to eliminate two of the phase
space variables. For example, let
y4¼y1/C0y2þy3; (54a)
p4¼p1/C0p2þp3: (54b)
Then the reduced Hamiltonian becomes
HR¼1
2m/C2
3ðp2
1þp2
2þp2
3Þ/C04ðp1p2þp2p3Þ
þ2p1p3/C3
þ2gmðy1þy3Þþk/C2
y2
1þy2
2þy2
3
/C0y1y2þy1y3/C0y2y3/C02aðy1þy3/C0aÞ/C3
: (55)
The equations of motion are obtained from HRand the Dirac
bracket. Writing these as a system of second order equations
for the coordinates, we ﬁnd
€y1¼/C0g/C0k
2mð3y1/C0y3/C02aÞ; (56a)
€y2¼/C0g/C0k
2mð4y2/C0y1/C0y3/C02aÞ; (56b)
€y3¼/C0g/C0k
2mð3y3/C0y1/C02aÞ: (56c)
This simple system of linear equations can be solved analyti-
cally for y1,y2, and y3as a function of time t. The remaining
variable y4ðtÞis determined from Eq. (54a) .
The general solution is a linear combination of three har-
monic modes: (i) the rods remain horizontal ( y1¼y2
¼y3¼y4) and oscillate up and down with frequencyﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ
k=mp
; (ii) the rod between y1andy2and the rod between y3
andy4remain horizontal as they oscillate 180/C14out of phase
with frequencyﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2k=mp
; (iii) the rod between y2andy3and
the rod between y4andy1remain horizontal as they oscillate
180/C14out of phase with frequencyﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2k=mp
.Now specialize to the system shown on the right side of
Fig. 4with springs attached to the masses and the potential
energy of Eq. (48). In this case, the time derivative of /van-
ishes, ½/;HP/C138¼0, so there are no secondary constraints and
the Lagrange multiplier kis unrestricted. The total
Hamiltonian HTcoincides with the primary Hamiltonian HP.
Since /is the only constraint, it is necessarily ﬁrst class
and it generates a gauge transformation. Explicitly, let G
¼/C15/where /C15is an arbitrary function of time. The gauge
transformation of any phase space function F(q,p) is deter-
mined by the Poisson bracket of Fwith the gauge generator
G; that is, dF¼½F;G/C138. For the phase space coordinates, we
have dy1¼/C15;dy2¼/C0 /C15;dy3¼/C15;dy4¼/C0 /C15, and dpi¼0
(with i¼1;…;4). This describes a change in the q’s and p’s
for which the masses don’t move and the spring lengths
don’t change. In other words, the physical state of the system
is unchanged.
Observables are phase space functions that are gauge
invariant. Observables include the locations of the masses,
namely, x12/C17ðy1þy2Þ=2;x23/C17ðy2þy3Þ=2;x34/C17ðy3þy4Þ=2,
andx41/C17ðy4þy1Þ=2, and the momenta pi. We can identify
the physical meaning of the p’s by computing the time deriv-
atives of the masses’ locations using the total Hamiltonian.
This shows that pi¼mvi, where viis the average of the veloc-
ities of the two masses adjacent to the corner yi.
From this simple example, we see that each physical state
of the system is described by a curve in phase space, a curve
deﬁned by the transformation dF¼/C15½F;//C138. These curves are
called “gauge orbits.”
We can select a single point on each gauge orbit to represent
the physical state of the system. We do this by choosing a
gauge condition vðq;pÞ¼0s u c ht h a t vand/, together, form
a set of second class constraints. For example, we can requirethe rod between y
1andy2to remain horizontal by choosing
v¼y2/C0y1: (57)
Since ½v;//C1386¼0, the set CðallÞ
M¼fv;/gis indeed second
class. The Dirac bracket is constructed as in Eq. (3), and we
can use the constraints to eliminate two of the variables, say,y
1andp1. The fully reduced Hamiltonian is
HFR¼1
2m/C2
3ðp2
2þp2
4Þþ4ðp2
3/C0p2p3/C0p4p3Þ
þ2p2p4/C3
þVðyÞjy1¼y2; (58)
where VðyÞjy1¼y2is the potential energy of Eq. (48) evaluated
aty1¼y2. The nonzero Dirac brackets among the remaining
variables are
y3;p3½/C138/C3¼y4;p4½/C138/C3¼1; (59a)
y2;p2½/C138/C3¼y3;p2½/C138/C3¼/C0 y4;p2½/C138/C3¼1=2; (59b)
and the equations of motion _F¼½F;HFR/C138/C3are
_y2¼1
2mð3p2/C02p3þp4Þ; (60a)
_y3¼1
2mð/C0p2þ6p3/C03p4Þ; (60b)
_y4¼1
2mð/C0p2/C02p3þ5p4Þ; (60c)
221 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 221 04 October 2023 22:50:20
_p2¼ak/C0mg/C0k
4ð3y2þy3Þ; (60d)
_p3¼ak/C0mg/C0k
4ðy2þ2y3þy4Þ; (60e)
_p4¼ak/C0mg/C0k
4ðy2þy3þ2y4Þ: (60f)
These results imply €yi¼ak=m/C0g/C0ðk=mÞyiwhere i¼2, 3,
and 4. Thus, each of the three corners y2,y3, and y4indepen-
dently execute simple harmonic motion with frequencyﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ
k=mp
about their equilibrium positions a/C0mg=k. The cor-
nery1moves in sync with y2due to the gauge condition
v¼y2/C0y1¼0.
There are other interesting gauge choices. For example,
we can freeze the corner y4by letting
v¼y4/C0aþmg=k: (61)
After constructing the Dirac bracket, eliminating the varia-
bles x4and p4and reducing the Hamiltonian, we ﬁnd the
equations €yi¼ak=m/C0g/C0ðk=mÞyifori¼1, 2, and 3. The
corners y1,y2, and y3independently execute simple harmonic
motion with frequencyﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ
k=mp
, while y4remains ﬁxed.
The evolution of the observables is, of course, indepen-
dent of the gauge choice. In particular, the motions of themasses are the same whether we choose Eq. (57) or Eq. (61).
It is not difﬁcult to see that each of the four masses executes
simple harmonic motion with frequencyﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ
k=mp
. However,
the amplitudes and phases are not independent—they must
satisfy x
12þx34¼x23þx41. This relationship follows from
the deﬁnitions x12/C17ðy1þy2Þ=2, etc.
E. Pairs of pulleys
Figure 5shows three pairs of massless pulleys. Each pair
consists of a ﬁxed lower pulley and an upper pulley attachedto a mass and a spring. A cord runs over and under the pul-
leys, as shown, with the left end attached to the right end.
That is, the left and right sides of the ﬁgure are “periodicallyidentiﬁed” so that the cord forms a single continuous loop.
(This can be achieved in three dimensions by attaching the
springs and the bottom pulleys to circular supports.) Note
that we can construct such a system using any number of
pairs of pulleys. We will focus on the version with three
pairs.
The coordinates for this system are the angles a
1,a2,a3of
the lower, ﬁxed pulleys. Consider the height of mass m2.I f
the angle a1increases by da1, the height of m2increases by
Rda1=2 where Ris the radius of the lower pulley. If the
angle a2increases by da2, the height of m2decreases by
Rda2=2. Thus, we see that the height of m2ish2¼Rða1
/C0a2Þ=2þc, where cis a constant. Likewise, the height of
m1ish1¼Rða3/C0a1Þ=2þc, and the height of m3is
h3¼Rða2/C0a3Þ=2þc.
Letm1¼m2¼m3and use the common notation mfor
each mass. The kinetic energy for this system is
T¼ðm=2Þð_h2
1þ_h2
2þ_h2
3Þ,o r
T¼mR2
8ð_a1/C0_a2Þ2þð_a2/C0_a3Þ2þð_a3/C0_a1Þ2hi
:
(62)
The gravitational potential energy mgðh1þh2þh3Þis simply
a constant. The spring potential energy is ðk=2Þ½ða/C0h1Þ2
þða/C0h2Þ2þða/C0h3Þ2/C138, where the constant adepends on the
height of the ceiling and the relaxed length of each spring. To
within an additive constant, the total potential energy is
VðaÞ¼kR2
8ða1/C0a2Þ2þða2/C0a3Þ2þða3/C0a1Þ2hi
:
(63)
As usual, the Lagrangian is L¼T/C0V.
The momenta for this system are
p1¼mR2
4ð2_a1/C0_a2/C0_a3Þ; (64a)
p2¼mR2
4ð2_a2/C0_a3/C0_a1Þ; (64b)
p3¼mR2
4ð2_a3/C0_a1/C0_a2Þ: (64c)
The matrix of second derivatives @2L=@_ai@_ajhas rank 2, and
there is one primary constraint
/¼p1þp2þp3: (65)
The canonical Hamiltonian can be written as
HC¼4
3mR2ðp2
1þp1p2þp2
2ÞþVðaÞ; (66)
where VðaÞis given in Eq. (63). The primary Hamiltonian is
HP¼HCþk/.
The Poisson bracket ½/;HP/C138vanishes identically, so the
consistency condition does not lead to any further constraints
and does not restrict the Lagrange multiplier. The primary
constraint /is ﬁrst class. We see that this is a gauge theory
with gauge generator G¼/C15/.
Under a gauge transformation, the phase space coordinates
transform as
Fig. 5. A loop of cord winds through three pairs of pulleys; the left and right
ends of the ﬁgure are identiﬁed. Masses and springs are attached to each of
the upper pulleys. This system can be extended to any number of pairs of
pulleys.
222 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 222 04 October 2023 22:50:20
dai¼ai;G½/C138 ¼/C15; (67a)
dpi¼pi;G½/C138 ¼0; (67b)
fori¼1, 2, and 3. Physically, the gauge freedom arises
because the pulleys can rotate by equal amounts ( da1¼da2
¼da3), causing the cord to cycle through the system while
leaving each mass ﬁxed in place. The observables for this
system include the differences, a3/C0a1;a1/C0a2;a2/C0a3,
which are proportional to the heights h1,h2,h3of the masses.
The observables also include the momenta pi. In physical
terms, these are given by
p1¼mRðv1/C0v3Þ=2; (68a)
p2¼mRðv2/C0v1Þ=2; (68b)
p3¼mRðv3/C0v2Þ=2; (68c)
where v1,v2, and v3are the velocities of the three masses.
Let us ﬁx the gauge with the condition v¼0 where
v¼a1þa2þa3: (69)
The set fv;/gis second class, and the nonzero Dirac brack-
ets are ½ai;pj/C138/C3¼2=3 for i¼jand½ai;pj/C138/C3¼/C01=3 for i6¼j.
We can use v¼0 and /¼0 to eliminate two of the varia-
bles, say, a3andp1. Then the fully reduced Hamiltonian is
HFR¼4
3mR2p2
2þp2p3þp2
3/C0/C1
þ3kR2
4a2
1þa1a2þa2
2/C0/C1
: (70)
The equations of motion for the remaining variables are
_a1¼/C04
3mR2ðp2þp3Þ; (71a)
_a2¼4
3mR2p2; (71b)
_p2¼/C03kR2
4a2; (71c)
_p3¼3kR2
4ða1þa2Þ: (71d)
The resulting second order equations for the angles are €a1
¼/C0 ð k=mÞa1and €a2¼/C0 ð k=mÞa2. Thus, the pulleys a1and
a2execute independent simple harmonic motion with angu-
lar frequencyﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ
k=mp
. The third angle is determined from the
gauge condition as a3¼/C0a1/C0a2.
The observables for this system include the heights hiof
the masses. Each mass executes simple harmonic motion
with frequencyﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ
k=mp
, subject to the restriction
h1þh2þh3¼const. The restriction follows from the rela-
tions h1¼Rða3/C0a1Þ=2þc, etc.
IV. EXERCISES FOR THE READER
The following problems are left as exercises for the
reader. Solutions can be found in the supplementary
material.42(1) A pendulum of mass mand length ‘hangs from the ceil-
ing, as shown in Fig. 6. Two massless springs are
attached to the ceiling, a distance Dapart, with spring #1
wound around the pendulum rod. The two springs are
attached to each other. Let each spring have stiffness k
and a relaxed length of zero. Use the angle of the pendu-lum and the length of spring #1 as generalized
coordinates.
(2) Two massless, frictionless pulleys are arranged as shown
in Fig. 7. The axis of the upper pulley is ﬁxed, while the
lower pulley is free to move vertically. The mass mis
also restricted to move vertically. Note the direction in
which the cords are wound around the pulleys. Use theorientation angles a
1anda2as generalized coordinates.
V. CONCLUSIONS
Classical mechanics textbooks typically avoid singular
Lagrangians by ﬁat. For many popular books, such as
Classical Mechanics by Goldstein43and Mechanics by
Landau and Lifschitz,44this is understandable since these
were written before the work of Dirac and Bergmann.
However, today we need not limit our attention to nonsingu-lar systems. The Dirac–Bergmann algorithm is a natural
extension of the standard Lagrangian and Hamiltonian for-
malism and is not overly difﬁcult to apply. It allows us to
Fig. 7. A mass mhanging from a series of pulleys. The radii of the two pul-
leys can be different.
Fig. 6. A pendulum with two springs. One spring is wound around the pen-dulum rod.
223 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 223 04 October 2023 22:50:20
analyze interesting singular systems and creates a closer link
to modern ﬁeld theories with gauge freedom.
ACKNOWLEDGMENTS
The author would like to thank the referees for insight and
suggestions.
AUTHOR DECLARATIONS
Conflict of Interest
The author has no conﬂicts to disclose.
a)Electronic mail: david_brown@ncsu.edu, ORCID: 0000-0003-0997-8737.
1P. A. M. Dirac, “Generalized Hamiltonian dynamics,” Can. J. Math. 2,
129–148 (1950).
2P. A. M. Dirac, “The Hamiltonian form of ﬁeld dynamics,” Can. J. Math.
3, 1–23 (1951).
3P. A. M. Dirac, “Generalized Hamiltonian dynamics,” Proc. Roy. Soc.
(London) 246, 326–332 (1958).
4P. A. M. Dirac, “The theory of gravitation in Hamiltonian form,” Proc.
Roy. Soc. (London) 246, 333–343 (1958).
5P. A. M. Dirac, “Fixation of coordinates in the Hamiltonian theory of grav-
itation,” Phys. Rev. 114, 924–930 (1959).
6P. G. Bergmann, “Non–linear ﬁeld theories,” Phys. Rev. 75, 680–685
(1949).
7P. G. Bergmann and J. H. M. Brunings, “Non-linear ﬁeld theories II.Canonical equations and quantization,” Rev. Mod. Phys. 21, 480–487
(1949).
8P. G. Bergmann, R. Penﬁed, R. Schiller, and H. Zatzkis, “The Hamiltonianof the general theory of relativity with electromagnetic ﬁeld,” Phys. Rev.
80, 81–88 (1950).
9J. L. Anderson and P. G. Bergmann, “Constraints in covariant ﬁeld theo-
ries,” Phys. Rev. 83, 1018–1025 (1951).
10R. H. Penfeld, “Hamiltonians without parametrization,” Phys. Rev. 84,
737–743 (1951).
11P. G. Bergmann and I. Goldberg, “Dirac bracket transformations in phasespace,” Phys. Rev. 98, 531–538 (1955).
12L. Rosenfeld, “Zur quantelung der wellenfelder,” Ann. Phys. 397, 113
(1930); , reprinted in Eur. Phys. J. H 42, 63–94 (2017).
13D. Salisbury and K. Sundermeyer, “L /C19eon Rosenfeld’s general theory of
constrained Hamiltonian dynamics,” Eur. Phys. J. H 42, 23–61 (2017).
14P. A. M. Dirac, Lectures on Quantum Mechanics (Belfer Graduate School
of Sciences, Yeshiva University, New York, 1964).
15E. C. G. Sudarshan and N. Mukunda, Classical Dynamics: A Modern
Perspective (Wiley, New York, 1974).
16A. Hanson, T. Regge, and C. Teitelboim, Constrained Hamiltonian
Systems (Accademia Nazionale dei Lincei, Roma, 1976).
17K. Sundermeyer, Constrained Dynamics (Springer–Verlag, Berlin, 1982).
18M. Henneaux and C. Teitelboim, Quantization of Gauge Systems
(Princeton U. P., Princeton, 1992).
19H. J. Rothe and K. D. Rothe, Classical and Quantum Dynamics of
Constrained Hamiltonian Systems (World Scientiﬁc, Singapore, 2010).
20A. Deriglazov, Classical Mechanics: Hamiltonian and Lagrangian
Formalism (Springer, New York, 2017).
21L. Lusanna, Non-Inertial Frames and Dirac Observables in Relativity
(Cambridge U. P., Cambridge, 2019).
22G. Date, “Lectures on constrained systems,” e-print arXiv:1010.2062
[gr-qc].
23J. D. Brown, “Singular Lagrangians, constrained Hamiltonian systems andgauge invariance: An example of the Dirac–Bergmann algorithm,”
Universe 8, 171 (2022).24The examples of the compound spring and the pendulum attached to two
springs have been discussed previously by J. U. Cisneros-Parra, “On sin-
gular Lagrangians and Dirac’s method,” Rev. Mexicana Fis. 58, 61–68
(2012). The analysis in that paper did not fully follow the general algo-
rithm as developed by Dirac and Bergmann, see https://rmf.smf.mx/ojs/
index.php/rmf/article/view/3885 .
25If the Lagrangian is quadratic in the velocities, as is typical for systems in
classical mechanics, it has the form Lðq;_qÞ¼ _qiLij_qj=2þLi_qiþL0,
where Lij,Li, and L0depend only on the coordinates qi. The conjugate
momenta are then pi¼Lij_qjþLi. Let Videnote a vector in the null space
ofLij, so that ViLij¼0. If follow that /¼Vipi/C0ViLi¼0 is a constraint
on the q’s and p’s.
26This is the view taken by Dirac. Alternatively, some authors (Refs. 9and
27–30 ) deﬁne a gauge transformation as an invariance of the Lagrangian.
With this deﬁnition, the primary ﬁrst class constraints, by themselves, do
not always generate gauge transformations. Rather, gauge transformations
can be associated with particular linear combinations of primary and sec-
ondary ﬁrst class constraints.
27L. Castellani, “Symmetries in constrained Hamiltonian systems,” Ann.
Phys. 143, 357–371 (1982).
28J. M. Pons, D. C. Salisbury, and L. C. Shepley, “Gauge transformations in
the Lagrangian and Hamiltonian formalisms of generally covariant theo-
ries,” Phys. Rev. D 55, 658–668 (1997).
29J. M. Pons, “On Dirac’s incomplete analysis of gauge transformations,”
Stud. Hist. Phil. Sci. B 36, 491–518 (2005).
30J. B. Pitts, “A ﬁrst class constraint generates not a gauge transformation,
but a bad physical change: The case of electromagnetism,” Ann. Phys.
351, 382–406 (2014).
31R. Cawley, “Determination of the Hamiltonian in the presence of con-
straints,” Phys. Rev. Lett. 42, 413–416 (1979).
32A. Frenkel, “Comment on Cawley’s counterexample to a conjecture of
Dirac,” Phys. Rev. D 21, 2986–2987 (1980).
33R. Sugano and T. Kimura, “Comments on constraints of Gauge theories,”
J. Phys. A 16, 4417–4421 (1983).
34Z. Li, “On the invalidity of a conjecture of Dirac,” Chin. Phys. Lett. 10,
68–70 (1993).
35B.-C. Wu, “Dirac’s conjecture,” Int. J. Theor. Phys. 33, 1529–1533
(1994).
36O. Miskovic and J. Zanelli, “Dynamical structure of irregular constrainedsystems,” J. Math. Phys. 44, 3876–3887 (2003).
37Y.-L. Wang, Z.-P. Li, and K. Wang, “Gauge symmetries and the Dirac
conjecture,” Int. J. Theor. Phys. 48, 1894–1904 (2009).
38H. J. Rothe and K. D. Rothe, “Gauge identities and the Dirac conjecture,”
Ann. Phys. 313, 479–496 (2004).
39If one accepts the Dirac conjecture, then all linear combinations of ﬁrst class
constraints generate gauge transformations. If the Lagrangian is only invari-
ant under particular linear combinations of ﬁrst class constraints, then the
Lagrangian theory can be viewed as a partially gauge–ﬁxed theory. In other
words, the gauge symmetry expressed in the Lagrangian theory is a subset
of the gauge freedom of the extended Hamiltonian theory.
40Here, we assume y<0 and /C0p=2/C20h/C20p, which implies Y¼y
/C0‘cosh<0.
41A freely extensible rod can be approximated by a series of ﬁxed-length
rods and cylinders, where the rods slide through the cylinders without fric-
tion. A vertical guide can be used to keep the mass at the midpoint
between the vertical posts.
42See supplementary material at https://www.scitation.org/doi/suppl/
10.1119/5.0107540 for solutions to the exercises in Sec. IV.
43H. Goldstein, C. Poole, and J. Safko, Classical Mechanics , 3rd ed.
(Addison-Wesley, San Francisco, 2000). The ﬁrst edition was published
by H. Goldstein in 1950.
44L. D. Landau and E. M. Lifshitz, Mechanics , 3rd ed., Course of
Theoretical Physics Vol. 1 (Elsevier, Amsterdam, 1976). The ﬁrst Russian
language edition was published in 1940.
224 Am. J. Phys., Vol. 91, No. 3, March 2023 J. David Brown 224 04 October 2023 22:50:20
