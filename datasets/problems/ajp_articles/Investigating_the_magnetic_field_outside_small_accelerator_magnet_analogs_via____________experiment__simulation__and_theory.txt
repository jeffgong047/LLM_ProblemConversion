
View
Online
Export
CitationCrossMarkPAPERS| JUNE 01 2023
Investigating the magnetic field outside small accelerator
magnet analogs via experiment, simulation, and theory 
Kelley D. Sullivan  
 ; Antara Sen  
 ; M. C. Sullivan  
Am. J. Phys.  91, 432 (2023)
https://doi.org/10.1 119/5.0068701
Articles Y ou May Be Interested In
Using the Magpylib library to analyze the ferrofluids in magnetic field sourcing from cylinders
AIP Conference Proceedings  (May 2023)
Analysis of ferrofluid in the container for levitation in 2D using Python Magpylib library
AIP Conference Proceedings  (May 2023)
Tunable homogeneous kG magnetic field production using permanent magnets
Rev. Sci. Instrum.  (December 2021) 04 October 2023 22:52:46
Investigating the magnetic field outside small accelerator magnet
analogs via experiment, simulation, and theory
Kelley D. Sullivan,a)Antara Sen,b)M. C. Sullivanc)
Department of Physics & Astronomy, Ithaca College, Ithaca, New York 14850
(Received 26 August 2021; accepted 25 March 2023)
Particle accelerators use powerful and complex magnetic ﬁelds to turn, shape, and eventually
collide beams of near-light-speed particles, yet the fundamental magnetic principles behind theaccelerator magnets can be understood by undergraduate students. In this paper, we use small-scale
accelerator magnet analogs in a multi-faceted, low-cost exploration of the magnetic ﬁeld exterior
to accelerator magnets. These ﬁelds are best understood using the multipole expansion of the ﬁeld.If we assume that the magnetic ﬁeld is created by ideal magnetic dipoles, we can derive a
theoretical model that shows that each accelerator magnet conﬁguration is dominated by a single
multipole moment and obeys B/1=r
lþ2, where lis the multipole order (with l¼1;2;3;and 4 for
the dipole, quadrupole, octopole, and hexadecapole moments, respectively). Using commercially
available NdFeB magnets and the magnetic ﬁeld sensor inside a smartphone, we experimentally
verify the power-law dependence of the accelerator magnet conﬁgurations. Finally, we use theopen-source Python library Magpylib to simulate the magnetic ﬁeld of the permanent magnet
conﬁgurations, showing good agreement among theory, experiment, and simulation.
#2023
Published under an exclusive license by American Association of Physics Teachers.
https://doi.org/10.1119/5.0068701
I. INTRODUCTION
The advanced laboratory project described in this article
uses accelerator magnets as the motivation—the “hook”—but the learning goals of the project are mathematical deriva-tion, numerical computation, visualization via simulation,experiment design and execution, and data collection andanalysis. This project can be scaled to ﬁt the learning objec-tives of intermediate or advanced laboratory courses and canbe modiﬁed to match the desired skill development for anindividual student. Requiring, at minimum, only a handful ofmagnets, 3D-printed magnet holders, a few raw materialstypically found around the home, a smartphone, and someingenuity, this project can be completed at low cost and canbe conducted in-person or remotely.
Particle accelerators are well known for their impressive
and large mechanical systems, including magnetic focusingand guiding systems.
1The particle beam usually travels
through the center of complex magnet conﬁgurations thatsurround the beam with the poles of electromagnets. Thesemagnet conﬁgurations have been designed to bend (dipole)or focus (quadrupole) the beam or to correct chromatic aber-rations (sextupole)
1,2—several even have their own
Wikipedia pages.3–5We present an advanced laboratory
experiment that investigates accelerator magnets throughinexpensive small-scale permanent magnet analogs, built by
placing permanent magnets with alternating polarities on the
faces of a regular polygon with an even number of sides.Figure 1shows a sextupole magnet conﬁguration. The ﬁelds
inside the magnet conﬁgurations are well known
1(some-
times called “contact ﬁelds,” a term borrowed from atomicphysics).6,7However, the ﬁelds outside the conﬁgurations
are not commonly studied. Given the small size of our accel-erator magnet analogs, they are perfect for use in examiningthese exterior ﬁelds.
In our advanced laboratory experiment, we use a smart-
phone to measure the magnetic ﬁeld. The advent of smart-phones has made a whole suite of physical sensors accessibleto a wide audience. Smartphones have turned into sophisti-
cated pieces of equipment
8,9whose popularity rose dramati-
cally during the pandemic as measurement devices for the
undergraduate physics laboratory. The smartphone magnetic
ﬁeld sensor, intended for use as a compass and in navigationand GPS, has been utilized in experiments where magnets
have been used as timing sensors in pendula,10springs,10and
rotations.11The sensor, a 3-axis Hall sensor, has been used
to explore the magnetic ﬁeld generated by the Earth in both alaboratory context12and in semester-long examinations of
the local magnetic ﬁeld.10,13The magnetic ﬁeld sensor has
also been used to measure the magnetic ﬁelds fromwires,10,14from electric rails,10from Helmholtz coils (when
paired with the accelerometer),10,15and recently in measure-
ments of a dipole and linear quadrupole.16,17Most of these
smartphone laboratories are intended to engage introductory
physics students. Our experiment is based on Refs. 16and
17and uses the smartphone magnetic ﬁeld sensor to measure
the magnetic ﬁeld outside an accelerator magnet analog andthen compare the experimental results to theoretical predic-
tions and simulations.
In Fig. 1, the magnetic ﬁeld sensor inside the phone is
located approximately in the same position as the vectorarrowhead visible in the top left corner of the phone. The
inset shows the magnetic ﬁeld strength as a function of dis-
tance from the center of the magnet conﬁguration for dipoleand sextupole magnet conﬁgurations. The data were obtainedwith the phone using the app Phyphox while the magnet con-
ﬁguration was translated to discrete positions along the
extension arm.
To better understand our measurements, we must predict
what the magnetic ﬁelds outside the magnet conﬁgurations
should look like. We can use simulations to predict these
magnetic ﬁelds. Advances in computing have made compu-tation and simulations common, and open-source programslike Python and repositories like GitHub have made these
complex computations accessible and low-cost. The Python
library Magpylib
18allows users to simulate arbitrary
432 Am. J. Phys. 91(6), June 2023 http://aapt.org/ajp #2023 Published under an exclusive license by AAPT 432 04 October 2023 22:52:46
conﬁgurations of permanent magnets and then examine the
behavior of their associated ﬁelds in both space and time. The
library is straightforward to use for a student with an introduc-
tory knowledge of programming. Figure 1shows a simulated
magnetic ﬁeld generated by a sextupole magnet conﬁguration.
A color gradient indicates the changing magnitude of the ﬁeld
(decreasing from white to yellow to red). Students can use thesimulation to visualize the ﬁelds that would be present outsidethe accelerator magnet analogs, providing qualitative conﬁr-
mation of the expected symmetry and setting requirements
and constraints on the experiment design.
Students with an interest in theoretical physics who have a
working knowledge of Taylor series expansions (intermedi-ate level) or vector calculus (advanced level) can also create
a theoretical model to predict the magnetic ﬁeld produced by
each magnet conﬁguration. If each permanent magnet isreplaced with an ideal dipole, then the ﬁeld can be calculated
analytically. To ﬁnd the magnetic ﬁeld outside the magnet
conﬁgurations, students can use the multipole expansion.The expansion of arbitrary charge and current conﬁgurationsinto multipole moments is a fundamental tool in physics,
19
and it embodies the deconstruction of difﬁcult problems intosmaller and more tractable ones while also yielding impor-tant physical insight. The power-law dependence of the mul-tipole moments, in which the ﬁeld is proportional to 1 =r
lþ2,
where the power lþ2 increases with the multipole order l,
means that the leading multipole moment will dominate thephysical behavior of the system far from the center of the
system. A system with a net electric charge behaves primar-
ily as a point charge—the monopole term, l¼0. The dipole
moment ( l¼1) dominates in electric systems with no netcharge, and as a result, the dipole dominates bonding in
chemical, biochemical, and biological systems.
20Magnetic
systems (which have no monopoles) also behave primarily
as dipoles ( l¼1). Accelerator magnet conﬁgurations are par-
ticularly interesting, because they create ﬁelds in whichmoments higher than the dipole moment dominate the far-
ﬁeld behavior. The inset of Fig. 1shows both the theoretical
and measured magnetic ﬁeld magnitude as a function of theradial distance from the center of a sextupole and a dipole
magnet conﬁguration. The magnetic ﬁeld from the dipole
magnet conﬁguration generates the familiar 1 =r
3behavior,
while the sextupole magnet leading term is the octopole
moment ( l¼3) and drops off more quickly as 1 =r5.
This experiment requires 3D printed magnet holders,21
which can be printed in-house or using a 3D printing ser-
vice.33This experiment also provides additional opportuni-
ties for students with an interest in engineering to design and
3D print optional experimental apparatus to aid in the accu-rate and precise measurement of the ﬁeld. In the work pre-
sented here, we use a stationary smartphone “bed” and
extension arm (see Fig. 1) to carefully position the smart-
phone and magnet conﬁgurations relative to each other to
allow for easily repeatable measurements of the ﬁeld at vary-
ing distances between the center of the magnet conﬁgurationand the sensor inside the smartphone. Our CAD ﬁles are pro-
vided in the supplementary material or online.
21,22
II. ANALYTICAL MODELING
In this article, we will present measurements of six differ-
ent planar conﬁgurations of permanent magnets, represented
Fig. 1. A visual integration of the project’s many facets. The 3D-printed smartphone bed (positioned vertically to the right) securely holds the smar tphone. The
3D-printed extension arm (positioned horizontally across the center of the ﬁgure) contains the sextupole conﬁguration of magnets. Magnetic ﬁeld li nes (from
Magpylib simulation) are shown centered on the magnet conﬁguration. The magnetic ﬁeld sensor is located in the upper left corner of the smartphone. Th e
inset shows experimental data (markers) and theory curves (dashed lines) for the sextupole ( l¼3) and dipole ( l¼1) magnet conﬁgurations, verifying the
expected 1 =rlþ2behavior of the magnetic ﬁeld strength as a function of the radial distance from the center of the conﬁgurations.
433 Am. J. Phys., Vol. 91, No. 6, June 2023 Sullivan, Sen, and Sullivan 433 04 October 2023 22:52:46
in Fig. 2as ideal dipoles each with dipole moment m.23The
three simple conﬁgurations on the left have been studied orare simple extensions of previous works.17,19The three con-
ﬁgurations on the right are inspired by accelerator magnets,where each dipole sits on the face of a regular polygon, withdipoles pointing alternately towards or away from the centerof the conﬁguration. These conﬁgurations are called thequadrupole, sextupole, and octupole magnets. In this experi-
ment, we will consider only the ﬁeld in the plane of the mag-
net conﬁgurations.
Unfortunately, there is inconsistent nomenclature between
the multipole expansion standard in physics, chemistry, andengineering and the nomenclature used in accelerator phys-ics. In the expansion of ﬁelds into their multipole moments,the order lgives rise to the name of the moment via the
power 2
l. Hence, the orders l¼0;1;2;3;4( 2l¼1;2;4;
8;16) are named the monopole, dipole, quadrupole, octopole,
and hexadecapole (16-pole) moments. In accelerator physics,it is standard to name the magnet conﬁgurations by the num-ber of poles that face the center of the conﬁguration (wherethe particle beam would travel). Thus, in accelerator physics,a dipole magnet has two poles and is used to create a con-
stant ﬁeld.
3The quadrupole, sextupole, and octupole mag-
nets are arranged around a square, hexagon, and octagon,respectively, as shown in Fig. 2. To avoid confusion, we
always refer to them as moments (e.g., the octopole moment)from the multipole expansion and magnets (e.g., the sextu-pole magnet) from accelerator physics.
24
To calculate the ﬁeld from the magnet conﬁgurations in
Fig.2, we should examine them in the multipole expansion.
The expansion of charge and current distributions into theirmultipole moments is discussed at the undergraduate level,19
though there is little discussion of the moments beyond thedipole. The calculation of multipole moments from an arbi-trary current distribution is well established,
25and multi-
poles can be calculated even from permanent magnets.26Analytical derivations of the magnetic ﬁeld of the multipoles
can be quite daunting, however, and is the subject of multi-
ple publications in the pedagogical literature.27–31
In the upper left of Fig. 2, we see the simplest magnetic
system: a dipole.19Two magnetic dipoles facing each other
will cancel the dipole moment in the multipole expansion,
leaving the quadrupole moment as the leading term in the
expansion (middle and lower left panels). On the upper right
side of Fig. 2, the planar quadrupole used in particle acceler-
ators is simply the combination of two linear quadrupoles,
again leaving the quadrupole moment as the leading term in
the magnetic ﬁeld. In the supplementary material,22we
derive the fact that six dipoles arranged as shown for the sex-
tupole conﬁguration will cancel the dipole and quadrupole
moments, leaving the octopole moment as the leading term.Similarly the octupole magnet will cancel the dipole, quadru-
pole, and octopole terms; thus, the leading term is the hexa-
decapole (16-pole) moment.
In order for the magnetic ﬁeld to be dominated by a single
term in the multipole expansion, we must look at distances
where rfrom the center of the conﬁguration to the point of
interest is much greater than the radius aof the polygon,
r/C29a. If we choose the point of interest in a 2D plane per-
pendicular to the faces of the magnets and lying along the
line that extends from the center of the conﬁguration through
one of the faces, then by symmetry we expect the net mag-
netic ﬁeld from the magnet conﬁguration to only have a
radial ﬁeld component. In the supplementary material,22we
derive the magnetic ﬁeld and show that the magnetic ﬁeld ofthe multipole conﬁguration follows a pattern, given by
B¼fl0
4pmal/C01
rlþ2; (1)
where mis the dipole moment, fis a numerical prefactor that
depends on the magnet conﬁguration and the choice of axis,lis the order of the leading multipole moment, and ais the
distance from the center of the conﬁguration to the location
of one of the dipoles. The leading multipole moment and the
numerical values of the prefactor fare given in Table I.
Equation (1)is a simple formula that conforms to all
expectations of how the ﬁeld exterior to the multipole mag-
nets should behave: the power lþ2 increases as the leading
multipole moment increases, additional factors with units of
Fig. 2. Arrangement of ideal dipoles with the north pole oriented either
towards (blue) or away from (red) the center of the multipole conﬁguration.
The magnetic ﬁeld is evaluated at a distance rfrom the center of the multi-
pole conﬁguration along an axis through one of the dipoles, except for the
linear quadrupole perpendicular to the axis. The distance from the center of
the conﬁguration to the center of each dipole is given by a. Multipole mag-
net naming convention follows the standard in accelerator physics (Ref. 24).Table I. Outside a multipole magnet conﬁguration, the power in B/1=rlþ2
is determined by the multipole order l. The prefactor determines the value of
the magnetic ﬁeld generated by multipole conﬁgurations given in Eq. (1).
The magnetic ﬁeld is calculated at a distance rfrom the center of the conﬁg-
uration along a line from the center through one of the dipoles, except for
the linear quadrupole perpendicular to the axis, which is along a line perpen-
dicular to that line (Ref. 24).
Multipole magnetLeading mutipole
momentMultpole
order l Prefactor f
Dipole Dipole 1 2
Linear quadrupole,
perpendicular to axisQuadrupole 2 6
Linear quadrupole,
parallel to axisQuadrupole 2 12
Planar quadrupole Quadrupole 2 18
Sextupole Octopole 3 45Octupole Hexadecapole 4 87.5
434 Am. J. Phys., Vol. 91, No. 6, June 2023 Sullivan, Sen, and Sullivan 434 04 October 2023 22:52:46
length appear in the numerator to ensure the dimensions
are correct, the ﬁeld depends on the strength of the dipoles
used to make the multipole magnet, and only the prefactor
in front changes. Armed with this simpliﬁed model andexpression for the magnetic ﬁeld, the curious student is well-
positioned to delve into a visual and experimental explora-
tion of the ﬁelds generated by the accelerator magnetconﬁgurations.
III. VISUALIZATION VIA SIMULATION
For many students, curiosity ﬁrst demands that they see
the phenomena they are studying in action. We use Pythonand the open-source library Magylib,
18a package that can
model macroscopic permanent magnets of various sizes andstrengths, position them in space, evolve them in time, andcalculate the resultant magnetic ﬁeld in space and time. Thispackage is free and user-friendly, and it offers studentsexcellent introductory-level practice with programming,magnets, and magnetic ﬁelds.
Students can use the Magpylib package to visualize the
magnetic ﬁeld generated by the permanent magnet conﬁgu-rations shown in Fig. 2. In Fig. 3, each of the permanent
magnets is drawn to scale with north (red) and south (blue)poles indicated on the diagram. The size aof the conﬁgura-
tion varies from a¼9.5 mm (quadrupoles) to a¼14.2 mm
Fig. 3. Field lines for all ﬁve magnet conﬁgurations. Permanent magnets are drawn to scale with north and south poles shaded red and blue, respectively . The
ﬁeld lines are drawn with arrows, and the color of the ﬁeld line indicates the magnitude of the magnetic ﬁeld, varying in strength from white to yellow to red.
Multipole magnet naming convention follows the standard in accelerator physics (Ref. 24).
435 Am. J. Phys., Vol. 91, No. 6, June 2023 Sullivan, Sen, and Sullivan 435 04 October 2023 22:52:46
(sextupole) to a¼18.5 mm (octupole).24The simulation ﬁeld
lines agree well with the known ﬁelds for dipoles19and
quadrupoles.6Our Magpylib simulation code is available
online and in the supplementary material.21,22
Note the symmetry in the ﬁeld patterns. The dipole and
the linear quadrupole magnets create familiar two- and four-
lobed ﬁeld patterns, and the number of lobes equals the total
number of magnetic poles present. The orientations of the
accelerator magnet analogs (the right side of Fig. 3), mean-
while, create symmetries where the number of lobes in each
ﬁeld pattern is the same as the number of magnets present or
the number of poles that face inward towards the center.
While this differs from the more common explanations for a
dipole and quadrupole, it can be explained through a careful
examination of the visualizations. As the ﬁeld leaves each
north (red) pole, the ﬁeld will bend towards the nearest south
(blue) pole, which are directly adjacent to the north pole
magnet. This repeats with every north pole, giving two lobesper outward facing north pole.
With this visualization, students can link the ﬁeld symme-
try to the expected dominant term in the multipole expansion
(Table I). In addition, in all patterns, one can see that the
ﬁeld at a point on the line from the center of the magnet con-
ﬁguration through the center of any magnet points along that
line (i.e., in the r-direction only), as predicted in Sec. II.
Finally, students can use the visualization of the dipole mag-
net to guide their data collection and analysis of the location
of the sensor within the phone, as discussed in the supple-mentary material.
22
IV. EXPERIMENTAL DESIGN
The experiment presented in this article includes many
elements available to engage students in experiment design,
fabrication, and setup. The complete apparatus is inexpen-
sive, and the setup and data-taking can be completed in-
person or remotely.
For our experiments, we purchased NdFeB N52 cuboid
magnets32of size 12 :7/C212:7/C26:35 mm3. We designed
magnet holders (available online21,22) for each magnet con-
ﬁguration and 3D printed the holders at Shapeways.33These
magnet holders are necessary to ensure the magnets are in
the proper position to eliminate lower-order multipole
moments.
We also designed a smartphone bed that can be adjusted
to accommodate all smartphones currently available and anextension arm to position the magnet holders and prevent
rotation.21,22The extension arm has side walls that can be
added or removed to accommodate the holders for the differ-
ent multipole magnet conﬁgurations and can slide along thesmartphone bed to align the arm to the magnetic ﬁeld sensor
inside the phone. Figure 1shows the physical apparatus
(smartphone bed and extension arm) and the sextupole mag-net holder. The bed and extension arm are not required, but
they simplify the data collection in two ways: ﬁrst, they
accurately locate the magnetic ﬁeld sensor inside the phone,and second, they facilitate a reliable and repeatable measure-
ment of the distance from the center of the multipole conﬁg-
uration to the sensor. Without the bed and extension arm,students are free to imagine how to conduct the measure-
ment. Our remote students in fall 2020 had many different
and clever experimental setups, most made from cardboardand wood.
Finally, this experiment requires a smartphone and an app
to be able to access the magnetic ﬁeld measurements made
by the smartphone. There are several cross-platform appsavailable to measure the magnetic ﬁeld. We used Phyphox,
34
which works on Android and iOS devices, is free, can export
the data as a.csv ﬁle, offers both calibrated and raw magne-
tometry data, and can be operated remotely from a computervia WiFi connection. The total cost of the experimental
setup, excluding the smartphone, was less than $250.
Here, we summarize the experiment; full details for each
step are discussed in the supplementary material.
22To col-
lect data, we ﬁrst located the magnetic ﬁeld sensor inside the
smartphone. Once located, we measured the magnetic ﬁeld
as a function of distance for the different magnet conﬁgura-tions. Each magnet conﬁguration was placed at ﬁxed loca-
tions along the extension arm, and the distance from the
center of the conﬁguration to the sensor was measured inCAD. For all measurements, the residual magnetic ﬁeld mea-
sured without magnets present was subtracted from the
measurement.
V. DATA AND ANALYSIS
The results for a single magnet (dipole) are shown as dots
in Fig. 4. (Uncertainty in the data is much smaller than the
points.) In Fig. 4(a), the dotted lines represent a ﬁtted theo-
retical curve, found by ﬁxing the slope at –3 and allowingthe least-squares ﬁt to vary the dipole moment to ﬁnd an
Fig. 4. Measurements of the magnetic ﬁeld generated by a single permanent magnet. (a) The magnetic ﬁeld as a function of distance with an inverse cubic ﬁ t.
(b) A log-log plot showing clear power-law behavior. The ﬁt line has a slope of /C02:9760:01. The intercept is used to determine the magnitude of the dipole
moment m.
436 Am. J. Phys., Vol. 91, No. 6, June 2023 Sullivan, Sen, and Sullivan 436 04 October 2023 22:52:46
appropriate ﬁt to the model. Taking the logarithm of both
sides of Eq. (1)gives us
logðBÞ¼logl0
4pfmal/C01/C18/C19
/C0ðlþ2ÞlogðrÞ; (2)
where the power becomes the slope of a log-log plot. Figure
4(b)shows a log-log plot of the same data with a linear least-
squares ﬁt where the power is allowed to vary, yielding a
slope of /C02:9760:01.35This slope corresponds to l¼1 and
conﬁrms that the dipole moment dominates the behavior of
the magnetic ﬁeld. The dipole moment min Eq. (1)can be
found using the intercept in Fig. 4(b) (using the value for f
from Table I). The intercept of /C00:6160:01 gives a dipole
moment of m¼1:2160:02 Am2.
For the linear quadrupole oriented in two ways and the
planar quadrupole, we expect the ﬁeld to vary as B/1=r4
with the different prefactors as listed in Table I. The experi-
mental results are shown as markers in Fig. 5. (Uncertainty
in the data is much smaller than the marks.) The dotted lines
represent theoretical curves, found by ﬁxing the slope at –4.
The ﬁts are quite good by eye, and the dipole moments are
1:3560:07 Am2for the linear quadrupole parallel to the
axis, 1 :3560:06 Am2for the linear quadrupole perpendicu-
lar to the axis, and 1 :3960:03 Am2for the planar quadru-
pole. The values for mdo not vary signiﬁcantly among the
quadrupole magnet conﬁgurations, though they are signiﬁ-
cantly discrepant from the value found for the single dipole
magnet.
For the sextupole and octupole magnet conﬁgurations, we
again ﬁx the slopes at –5 and –6, respectively, and allow the
dipole moment mto vary in the least-squares ﬁt. The strong
correlation between the data and theory veriﬁes the power-
law dependence of the ﬁelds. The value for the dipole
moment mis determined to be 1 :2960:08 Am2and
1:5160:08 Am2for the sextupole and octupole conﬁgura-
tions, respectively. We note that these results for mare again
signiﬁcantly discrepant from the value found for the dipole,
yet the largest discrepancy, found for the most complex con-
ﬁguration, the octupole magnet, varies by only 25%. This is
impressive given the need for the dipole, quadrupole, andoctopole moments in the multipole expansion to cancel out
in order to produce a dominant hexadecapole moment thatpresents as a 1 =r
6dependency in the magnetic ﬁeld data.
The dipole moments of the magnets are assumed to be equal
in the model but vary by 0.5% in the experiment. We alsoexpect that slight misalignments of the magnets in the holderor rotation of the magnet holder will affect the value for the
dipole moment.
Our data in Fig. 5represent the full range of useful data
collection for the quadruple, sextupole, and octupole mag-nets. At distances closer than /C245 cm, the strong permanent
magnets can harm the phone. (This distance may be smaller
for larger or more powerful magnets; students should be
careful not to damage their smartphone.) For the dipole mag-net, measured data remain consistent with B/1=r
3for dis-
tances up to 50 cm from the sensor. In contrast, at distances
farther than /C2415 cm, the data for the quadrupole, sextupole,
and octupole magnet conﬁgurations curve up and away fromthe expected behavior when plotted on a log-log plot. Smalldifferences in the dipole moment mof the permanent mag-
nets mean the cancellation isn’t perfect and leads to a small
net dipole moment of the system. At large r, this remnant
dipole moment ( /1=r
3) dominates over the quadrupole,
octopole, or hexadecapole moments, which drop off more
rapidly as /C241=r4;1=r5, and 1 =r6, respectively.
VI. CALCULATIONS VIA SIMULATION
In addition to visualization of the magnetic ﬁeld, the
Magpylib package can also be used to calculate the mag-
netic ﬁeld at any point in space. If we use the simulation to
determine the magnetic ﬁeld along the positive x-axis in each
of the conﬁgurations in Fig. 3, we can reproduce our experi-
mental setup in silico . We can then compare our simulated
results to the expected results from Eq. (1)using Table I.
Our simulated results are compared to the theoretical predic-
tions in Fig. 6(a), where we see excellent agreement between
simulation and theory. All the magnets in the simulation andtheoretical ﬁts in Fig. 6have the same dipole moment of
m¼1:12 Am
2(in contrast with our experimental results,
where the dipole moment mvaried by up to 25%). The
results in Fig. 6corroborate our analytical predictions and
indicate that non-interacting permanent magnets do indeed
create the expected multipole ﬁelds.
We can extract still more information from the simulation.
We veriﬁed the behavior far from the center of the multipolemagnet conﬁguration, but we can also examine the magneticﬁeld in regions we cannot access experimentally. We can
examine the ﬁeld closer than /C245 cm, where the assumption
thatr/C29abegins to break down. This simulation also allows
the user to look inside the magnet conﬁgurations, shown in
Fig. 6(b). In this ﬁgure, we can see linear behavior of the
ﬁeld inside the quadrupole conﬁgurations and quadratic
behavior inside the sextupole conﬁguration. The linear andquadratic behaviors (slopes of þ1 andþ2) are utilized for
bending and focusing the particle beam in accelerator phys-
ics.
1,2The octupole, with cubic behavior (a slope of þ3), is
not commonly used in accelerators.
Finally, the simulation can be used to create arbitrary col-
lections of permanent magnets and arrange them in space. Inour application, this means we can create a decapole or
dodecapole magnet conﬁguration and extend the simulation
to higher multipole moments. This is very useful, giventhat the algebra required to calculate the prefactor for theFig. 5. Measurements on all multipole magnet conﬁgurations. The dotted
lines are ﬁts to the model from Eq. (1)using Table I. The only free parame-
ter in the model line ﬁts is the dipole moment m, which was found via least
squares ﬁtting, and varies between 1.21 and 1 :51 Am2. These results show
that the experimental data from the multipole magnet conﬁgurations agree
well with the model for both slope and intercept; thus, the magnet conﬁgura-
tions are well modeled by ideal dipoles and the magnetic ﬁeld multipole
ﬁeld expansion. For clarity, the data for the dipole are offset vertically by
–0.75, the sextupole by þ0.5, and the octupole by þ1.
437 Am. J. Phys., Vol. 91, No. 6, June 2023 Sullivan, Sen, and Sullivan 437 04 October 2023 22:52:46
octupole magnet, while not conceptually complex, is cer-
tainly complicated and error-prone.
VII. CONCLUSIONS
Using particle accelerators as a “hook,” we draw students
into a multifaceted project that provides a broad range of
skill-building opportunities through an examination of the
magnetic ﬁeld behavior exterior to a collection of small-scale
accelerator magnet analogs. We have examined ﬁve different
magnet conﬁgurations via theory using ideal magnetic
dipoles, via experiment using commercially available NdFeB
permanent magnets, and via simulation using Python and
Magpylib to simulate permanent magnets. In all cases, we see
thatB/1=rlþ2. As the multipole magnet increases in com-
plexity from dipole to quadrupole to sextupole to octupole,
the theory predicts the power lþ2 should also increase; this is
also borne out by our theoretical derivations, experiments, and
simulations. The predicted powers of lþ2¼3;4;5;6 for the
magnet conﬁgurations are also veriﬁed in our calculations,
simulations, and experimental results. In our experimental ﬁts,
the measured values of the dipole moment mvary by 25% or
less. For the most complex conﬁguration, the octupole mag-
net, this discrepancy reaches the maximum of 25%, a remark-
ably small difference considering the stringent requirements
necessary to cancel the dipole, quadrupole, and octopole
moments exactly to allow the B/C241=r6hexadecapole
moment to dominate the far-ﬁeld behavior.The equipment used in this work is highly accessible,
given the ubiquity of smartphones and personal computers
and the proliferation of user-friendly and free software pack-
ages like Python and Magpylib. Most students will need to
be supplied with only magnets and magnet holders to com-
plete this project. This makes the project ideal for in-person
or remote work, making magnetic labs readily available to
students far from a physical campus.
This work can be customized to ﬁt a student’s needs or
interest, be they analytical theory, CAD design, 3D printing,
computer visualization and simulation, or data collection and
analysis. The project can be expanded or compressed depend-
ing on the course with different parts of the project appropriate
for sophomore-level courses all the way to a senior project. Inaddition, this experiment is ripe for additional explorations. A
student interested in experimentation could measure the ﬁeld
as a function of angle and verify each individual multipole
magnet’s unique ﬁeld conﬁguration. A student motivated by
computation could model a non-symmetric arrangement of
magnets or investigate the effect of including magnets of dif-
fering ﬁeld strength, either (or both) of which might verify thediscrepancy in the measured value of the magnet dipole
moment m. Recognizing that permanent magnets are not per-
fect dipoles, a student engaged by analysis could modify the ﬁt
to include both higher and lower-order terms in the expansion,
and use residual plots to conﬁrm the necessity of these terms. Astudent interested in 3D printing can print the smartphone bed
and extension arm, either with or without modiﬁcations for
their own smartphone. A student excited by engineering design
could change the phone holder such that any location for the
extension arm is possible. (Only discrete locations are available
in our experiment.) Finally, a student excited to explore acceler-
ator physics could design and build a larger-scale version, suchthat the smartphone could ﬁt inside the conﬁguration and mea-
sure the contact ﬁelds relevant for accelerators.
36
Finally, the intentional inclusion of low-cost solutions, in
our case, the use of smartphone sensors and Python, can be
viewed as a beacon of hope. No longer is the learning of
physical phenomena and the scientiﬁc method bound toclassrooms but is now a universal opportunity. In times of
widespread educational inequities, making experiments and
simulations low-cost and accessible to all provides an oppor-
tunity to contribute to educational models that can reach
underserved communities.
ACKNOWLEDGMENTS
The authors would like to thank the brave remote students
of Intermediate Lab during fall 2020 for attempting the ﬁrst
versions of this experiment and the in-person students in fall2021 who discovered other needed improvements. A special
thanks goes to Alex Powell, whose determined data
collection uncovered errors in our assumptions and to our
colleague Jerome Fung for his careful reading and editing of
our manuscript. The authors would also like to thank theanonymous reviewers of the manuscript for their careful
edits and corrections, which have greatly improved this
paper.
AUTHOR DECLARATIONS
Conflict of Interest
The authors have no conﬂicts of interest to disclose.Fig. 6. Dots indicate the simulated magnetic ﬁeld from the magnet conﬁgu-
rations shown in Fig. 3. In (a), the dotted lines are ﬁts to the model from Eq.
(1) using Table I. All magnets have the same dipole moment,
m¼1:12 Am2. We can see the simulation agrees well with the model, show-
ing that our non-interacting permanent magnets behave very similarly to
ideal dipoles. The dipole data are offset vertically by –0.75; the sextupole
byþ0.5, and the octupole by þ1. In (b), we show the contact ﬁeld inside
the magnet conﬁgurations. The ﬁt lines are slopes of þ1 (quadrupoles), þ2
(sextupole), and þ3 (octupole). The octupole is offset vertically by –1.
438 Am. J. Phys., Vol. 91, No. 6, June 2023 Sullivan, Sen, and Sullivan 438 04 October 2023 22:52:46
a)ORCID: 0000-0003-2379-0132.
b)ORCID: 0000-0002-0999-9370.
c)Electronic mail: mcsullivan@ithaca.edu, ORCID: 0000-0002-3782-835X.
1R. Appleby, G. Burt, J. Clarke, and H. Owen, “The science and technology
of particle accelerators,” in The Science and Technology of Particle
Accelerators , 1st ed. (CRC Press, Boca Raton, FL, 2020), pp. 112–162.
2A. Milanese, “An introduction to magnets for accelerators,” <https://indico.
cern.ch/event/1101643/contributions/ >(2022), accessed on April 06,
2022.
3“Dipole magnet,” <https://en.wikipedia.org/wiki/Dipole_magnet >(2022),
accessed on May 13, 2022.
4“Quadrupole magnet,” <https://en.wikipedia.org/wiki/Quadrupole_magnet >
(2022), accessed on May 13, 2022.
5“Sextupole magnet,” <https://en.wikipedia.org/wiki/Sextupole_magnet >
(2022), accessed on May 13, 2022.
6C. G. Gray, G. Karl, and V. A. Novikov, “Quadrupolar contact ﬁelds:Theory and applications,” Am. J. Phys. 77, 807–817 (2009).
7C. G. Gray, G. Karl, and V. A. Novikov, “Magnetic multipolar contact
ﬁelds: The anapole and related moments,” Am. J. Phys. 78, 936–948
(2010).
8M. Monteiro and A. C. Mart /C19ı, “Resource letter MDS-1: Mobile devices
and sensors for physics teaching,” Am. J. Phys. 90, 328–343 (2022).
9D. J. O’Brien, “A guide for incorporating e-teaching of physics in a post-
covid world,” Am. J. Phys. 89, 403–412 (2021).
10See Ref. 8(and references therein) for additional references.
11U. Pili and R. Violanda, “Measuring average angular velocity with a
smartphone magnetic ﬁeld sensor,” Phys. Teach. 56, 114–115 (2018).
12S. Arabasi and H. Al-Taani, “Measuring the earth’s magnetic ﬁeld dip
angle using a smartphone-aided setup: A simple experiment for introduc-
tory physics laboratories,” Eur. J. Phys. 38, 025201 (2016).
13J. Tronicke and M. H. Trauth, “Classroom-sized geophysical experiments:
Magnetic surveying using modern smartphone devices,” Eur. J. Phys. 39,
035806 (2018).
14Y. Ogawara, S. Bhari, and S. Mahrley, “Observation of the magnetic ﬁeldusing a smartphone,” Phys. Teach. 55, 184–185 (2017).
15A. Shakur and B. Valliant, “Flyby measurement of the magnetic ﬁeld of a
helmholtz coil with a smart cart,” Phys. Teach. 58, 15–17 (2020).
16E. Arribas, I. Escobar, C. P. Suarez, A. Najera, and A. Bel /C19endez,
“Measurement of the magnetic ﬁeld of small magnets with a smartphone:A very economical laboratory practice for introductory physics courses,”
Eur. J. Phys. 36, 065002 (2015).
17E. Arribas, I. Escobar, R. Ramirez-Vazquez, C. del Pilar Suarez
Rodriguez, J. Gonzalez-Rubio, and A. Bel /C19endez, “Linear quadrupole mag-
netic ﬁeld measured with a smartphone,” Phys. Teach. 58, 182–185
(2020).18M. Ortner and L. G. Coliado Bandeira, “Magpylib: A free python package
for magnetic ﬁeld computation,” SoftwareX 11, 100466 (2020).
19D. J. Grifﬁths, “Electrodynamics,” in Introduction to Electrodynamics , 4th
ed. (Cambridge U. P., Cambridge, 2017), pp. 151–158, 252–266.
20J. E. McMurry and R. C. Fay, General Chemistry: Atoms First , 2nd ed.
(Pearson Education, London, 2014), Chap. 10.
21The CAD drawings and Magpylib simulation code are available for download
from Github at github.com/matthew-c-sullivan/MagneticMultipoleExpt.
22See the supplementary material at https://www.scitation.org/doi/suppl/
10.1119/5.0068701 for CAD ﬁles, simulation code in python, experimental
details, and a derivation of the analytical solution leading to Eq. (1).
23A dipole is a current loop of area Aand current Iwith dipole moment m
¼IA. An ideal dipole is a loop of inﬁnitesimal area Aand inﬁnite current I,
where the product m¼IAremains constant (Ref. 19).
24We are using the spelling that is most common in the different ﬁelds.
“Octupole” magnet is the spelling used in accelerator physics for the accel-
erator magnet conﬁguration with eight magnets on an octagon. “Octopole”moment is the spelling used in electrodynamics for the l¼3 order in the
ﬁeld expansion that varies as 1 =r
5.
25R. Raab and O. de Lange, Multipole Theory in Electromagnetism:
Classical, Quantum, and Symmetry Aspects, with Applications (Oxford U.
P., Oxford, 2004).
26A. Wolski, “Maxwell’s equations for magnets,” e-print arXiv:1103.0713
[physics.acc-ph] (2019).
27C. G. Gray, “Multipole expansions of electromagnetic ﬁelds using Debyepotentials,” Am. J. Phys. 46, 169–179 (1978).
28C. G. Gray, “Simpliﬁed derivation of the magnetostatic multipole expan-
sion using the scalar potential,” Am. J. Phys. 46, 582–583 (1978).
29C. G. Gray, “Magnetic multipole expansions using the scalar potential,”
Am. J. Phys. 47, 457–459 (1979).
30C. G. Gray, “Deﬁnition of the magnetic quadrupole moment,” Am. J.
Phys. 48, 984–985 (1980).
31H. Gonz /C19alez, S. R. Ju /C19arez, P. Kielanowski, and M. Loewe, “Multipole
expansion in magnetostatics,” Am. J. Phys. 66, 228–231 (1998).
32See<https://cmsmagnetics.com/ >to purchase permanent magnets, accessed
on August 9, 2021.
33See<https://www.shapeways.com/ >to order 3-D printed parts, accessed
on August 9, 2021.
34See<https://phyphox.org/ >for further information about the Phyphox
app, accessed on August 9, 2021.
35Generally, care must be taken when using log-log plots, and the results areusually only valid over many decades of data.
36We are indebted to our editors and anonymous reviewers for many of thesesuggestions.
439 Am. J. Phys., Vol. 91, No. 6, June 2023 Sullivan, Sen, and Sullivan 439 04 October 2023 22:52:46
