
View
Online
Export
CitationCrossMarkPAPERS| MARCH 01 2023
An exploration of circumbinary systems using gravitational
microlensing 
Brett C. George ; Eleni-Alexandra Kontou ; Patrycja Przewoznik ; Eleanor T urrell
Am. J. Phys.  91, 182–192 (2023)
https://doi.org/10.1 119/5.0088604
Articles Y ou May Be Interested In
Motions of Kepler circumbinary planets in restricted three-body problem under radiating primaries
AIP Conference Proceedings  (September 2015)
Gas Accretion from a Circumbinary Disk to Protoplanetary Disks
AIP Conference Proceedings  (August 2009)
SPOTS: Search for Planets Of T wo Stars—A Direct Imaging Survey for Exoplanets in Binary Systems
AIP Conference Proceedings  (August 2009) 04 October 2023 22:50:06
An exploration of circumbinary systems using gravitational
microlensing
Brett C. George
Department of Physics, College of the Holy Cross, Worcester, Massachusetts 01610
Eleni-Alexandra Kontoua)
Department of Physics, College of the Holy Cross, Worcester, Massachusetts 01610; Physics Program, Bard
College, 30 Campus Rd., Annandale-on-Hudson, New York 12504; and ITFA and GRAPPA, Universiteit van
Amsterdam, Science Park 904, Amsterdam, The Netherlands
Patrycja Przewoznik
Department of Physics, College of the Holy Cross, Worcester, Massachusetts 01610
Eleanor Turrellb)
Physics Program, Bard College, 30 Campus Rd., Annandale-on-Hudson, New York 12504
(Received 18 February 2022; accepted 26 November 2022)
Gravitational microlensing is one of the methods to detect exoplanets–planets outside our solar
system. Here, we focus on the theoretical modeling of systems with three lensing objects and inparticular circumbinary systems. Circumbinary systems include two stars and at least one planet
and are estimated to represent a sizeable portion of all exoplanets. Extending a method developed
for binary lenses to the three lens case, we explore the parameter space of circumbinary systems,producing exact magniﬁcation maps and light curves.
#2023 Published under an exclusive license by
American Association of Physics Teachers.
https://doi.org/10.1119/5.0088604
I. INTRODUCTION
Gravitational lensing was one of the major predictions of
the general theory of relativity. It refers to the bending of
light by a massive object between the source and the
observer. Gravitational microlensing is a special case ofgravitational lensing where multiple images are created with
very small separations. Typically, a separation of less than a
few milliarcseconds remains unresolved with current capa-bilities. Thus, the images are not separate but the overallmagniﬁcation changes produce an observable effect.
Gravitational microlensing is more difﬁcult to observe
than strong lensing where the images can be separated. In1986, Paczynski
1was the ﬁrst to propose that microlensing
might be observable in the Magellanic clouds. Since the ini-
tial searches, thousands of microlensing events have beenobserved (see Ref. 2for more references). Mao and
Paczynski3were the ﬁrst to suggest, in 1991, that gravita-
tional microlensing could be used to discover exoplanets,that is, planets outside our solar system. The main idea is thefollowing: As a background star passes behind, and close tothe line of sight of a foreground star, there is a gravitationallensing event. This is a microlensing event as typically theimages are unresolved, creating only a surge in the ﬂux ofthe source star. If the foreground star hosts planets, that willcreate an additional perturbation which can be observed.
The ﬁrst exoplanets were discovered in the 1990s,
4,5and
in the last few decades, thousands of exoplanets have beenobserved using different methods. The most popular is thetransit method, where, as a planet passes in front of a star, a
dip in its ﬂux is observable. Other methods include Doppler
spectroscopy, and, more recently, direct imaging.
The ﬁrst detection of an exoplanet using microlensing was
in 2004.
6Since then, over a hundred exoplanets have been
detected using this method. Searching for exoplanets using
microlensing presents signiﬁcant difﬁculties as planetarydeviations in light curves are short lived, not repeatable, andcan easily be missed. Additionally, planetary parameters,
such as the mass and orbit, depend on the properties of thehost star and these are typically unknown. Thus, the mostsuccessful observations usually include a combination of
microlensing followed by high-resolution imaging.
Despite these difﬁculties, microlensing offers some advan-
tages compared to the more popular transit and Doppler meth-ods. The most important one is that microlensing is the most
sensitive method for small planets further from their host star. In
particular, planets beyond the so-called “snow line” where ice istypically formed are usually undetectable using other methods.
Thus, microlensing can provide an important addition to the
other methods in an effort to create a representative map of exo-planets in our galaxy and beyond.
The vast majority of exoplanets discovered orbit a single
star. This is perhaps an artifact of our detection methods as it
is estimated that as many as 50% of the stars in our galaxy
are part of binary or multiple star systems.
7A planet that
orbits two stars is called a circumbinary planet and the sys-
tem a circumbinary system. The ﬁrst such exoplanet was dis-
covered using pulsar timing.8About 20 circumbinary planets
have so far been discovered using different methods. The
ﬁrst circumbinary planet discovered using microlensing was
found in 20169and it is the only one to date.
Detecting circumbinary planets using microlensing
presents both observational and theoretical challenges.While solving a single lens equation is trivial, adding more
bodies signiﬁcantly increases the complexity. General Nlens
systems have been studied using a linear approximation ofthe lens equation and the method of inverse polygon map-
ping.
10This very fast method allows the calculation of
microlensing magniﬁcation patterns and has led to the devel-opment of a pedagogically valuable interactive simulation.
11
The explorations of analogue optical systems for gravita-
tional lensing that allow the direct study of multiple gravita-
tional lens systems12,13should also be noted.
182 Am. J. Phys. 91(3), March 2023 http://aapt.org/ajp #2023 Published under an exclusive license by AAPT 182 04 October 2023 22:50:06
Double lens systems have been well studied theoreti-
cally.14,15Triple lens systems that include circumbinary sys-
tems involve even more parameters (ﬁve instead of two) anda much more complex system of equations, making a theo-retical exploration challenging.
A general three lens system is not analytically tractable.
One method is to use symmetries that simplify the problem as
in Refs. 20and 21. Perturbation theory
15,16is a different
approach that has been studied. More often, the structure of thecaustics, curves where the magniﬁcation diverges, is studied,such as in the work of Dan /C20ek and Heyrovsk /C19y who explored the
parameter space of triple gravitational lenses using a combina-tion of analytical and numerical methods.
17–19
One star–two (or multiple) planet systems have received the
most attention22,23with the planets usually treated in a pertur-
bative way. Some star–planet–moon systems have also beenstudied.24Circumbinary systems have been studied less.
Examples include Refs. 25and26with the latter examining
circumbinary caustics for a large range of the parameter space.
The goal of this paper is to provide an exploration of the
parameter space of circumbinary systems using a direct andexact method. Instead of caustics, we study full magniﬁca-tion maps and light curves. A combination of an analyticalapproach developed ﬁrst by Witt and Mao
27for binary lenses
and a numerical one using Mathematica are utilized. Themethod can be easily used by undergraduate students to gen-erate both magniﬁcation maps and light curves.
The paper starts with a pedagogical introduction to the lens
e q u a t i o ni nS e c . IIand continues with the basics of magniﬁca-
tion in single- and N-lens systems in Sec. III.I nS e c . IV,t h e
triple lens case is analyzed, describing the parameter space and
our methodology. In Sec. V, we explore the parameter space,
varying the mass and distance of planet from the binary starsystem, relative mass and distance between the stars, and theangle of the system. In Sec. VI, we apply our method to the
ﬁrst circumbinary system discovered using microlensing.
9We
conclude in Sec. VIIand discuss possibilities for future work.
II. THE LENS EQUATION
This section begins with the analysis of the geometry of a
single lens with spherical symmetry that illustrates the basicsof gravitational lensing, roughly following Refs. 2and28.
A. The single lens equation
The deﬂection angle for a light ray passing by a mass Mat
an impact parameter bis given by29
a¼2RS
b¼4GM
c2b; (1)
forb/C29RS,w h e r e RSis the Schwarzschild radius. For a spher-
ical lens, the geometry of the deﬂection is given by Fig. 1.
From Fig. 1, we have for the transverse distances
O0I¼O0SþSI; (2)
or, since SI/C25DLStana,
DStanh/C25DStanbþDLStana: (3)
In realistic situations, all the angles are extremely small so
the small angle approximation, tan x/C25xcan be used and Eq.
(3)becomeshDS¼bDSþaDLS: (4)
Equation (4)is called the lens equation. Substituting the
deﬂection angle from Eq. (1), the lens equation becomes
h¼bþ2RS
bDLS
DS: (5)
From Fig. 1, the impact parameter b¼tanhDL, or in the
small angle approximation, b¼hDL. So, Eq. (5)becomes
h¼bþh2
E
h; (6)
where
hE¼2RSDLS
DSDL/C18/C19/C20/C211=2
(7)
is the Einstein angle. When b¼0 and the source is aligned
with the lens, the image position his equal to the Einstein
angle. The spherical symmetry implies that in this case the
image is a ring around the lens. The ring has a physical
radius
RE/C17DLhE (8)
Fig. 1. Geometry of gravitational lensing from a single lens with spherical
symmetry. Note that the angles are exaggerated for clarity. Ois the position
of the observer, Sthe position of the source, Lthe position of the lens, and I
the position of the image. DLis the distance of the lens from the observer,
DSis the distance of the source from the observer, and DLS¼DS/C0DL(Ref.
30). The path of light is shown in the thick black line, and its extension
(dashed line) reveals the position of the image. bis the angular position of
the source and his the angular position of the image, where the angles are
measured from the lens. ais the deﬂection angle given by Eq. (1)andbis
the impact parameter (see also Ref. 28).
183 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 183 04 October 2023 22:50:06
called the Einstein radius. All angles can be normalized by
hE, so differential equation (5)becomes
u¼y/C0y/C01; (9)
where
u/C17b
hE;y/C17h
hE: (10)
So,uandyare the angular positions of the source and the
lens, respectively, in units of the Einstein angle. Solving Eq.
(9)gives the positions of the images in terms of the position
of the source. Solving the quadratic equation for the positionof the images gives
y
6¼1
2u6ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
u2þ4p/C16/C17
: (11)
Foru¼0, there is one image with radius 1 (Einstein ring).
Foru6¼0, one of the images yis positive and larger than 1,
while the other is negative and less than 1. Since the varia-
bles are normalized by the Einstein angle, one image isalways outside the Einstein ring and the other inside as
shown in Fig. 2where the source in the unlensed source
plane is assumed to be circular and not point-like.
B. The general lens equation
If there is more than one lens, it is difﬁcult to visualize the
path of the light. However, if we think of the single lens
equation (6)as a mapping between the angular source posi-
tionband the angular positions of the images h, it can be
generalized to the case of Npoint lenses. The new lens equa-
tion is
h¼bþaðhÞ; (12)
where ais the new deﬂection angle. The angular positions
are now two-dimensional vectors since their directions arenot trivial as in the single lens case. The deﬂection angle for
the case of Npoint lenses of masses m
iis31aðhÞ¼4GD LS
DLDSc2XN
imih/C0hi
jh/C0hij2; (13)
where hiare the angular positions of the lenses, and we
assume that the distances between the lenses are too small
compared to the distances of the lenses to the source and the
observer. Equation (13) is a straightforward generalization of
Eq.(1). For one lens and the vectors reducing to scalars, it
becomes a¼2RsDLS=ðDLDShÞ. Using the deﬁnition of the
Einstein angle from Eq. (7), where here M¼PN
imi, gives
aðhÞ¼h2
EXN
imi
Mh/C0hi
jh/C0hij2: (14)
Replacing in Eq. (13) and deﬁning again the normalized
angular positions of the source, the lenses, and the images
u/C17b
hE;y/C17h
hE;yi/C17hi
hE(15)
gives
u¼y/C0XN
i/C15iy/C0yi
jy/C0yij2; (16)
where /C15i/C17mi=M.
It is convenient to write the lens equation in complex
coordinates. First, we deﬁne the components of the vectorsu,y, and y
ito be
u¼ðu1;u2Þ;y¼ðy1;y2Þyi¼ðyi1;yi2Þ: (17)
Then, complex variables for the source, the images, and the
lens positions can be deﬁned as
f¼u1þiu2;z¼y1þiy2;zi¼yi1þiyi2: (18)
So, the lens equation (16) becomes
f¼z/C0XN
i/C15i
/C22z/C0/C22zi: (19)
III. MAGNIFICATION
A. Single lens
Lensing preserves the surface brightness of the source but
not its ﬂux. The ﬂux is deﬁned as
Df¼ðsurface brightness Þ/C2DX; (20)
where DXis the solid angle of the source or the image,
DX¼sinhDhD//C25hDhD/; (21)
in the small angle approximation.
The magniﬁcation (or demagniﬁcation) of an image is
deﬁned as the ﬂux of the image divided by the ﬂux of theunlensed source. Following Fig. 2, the magniﬁcation of each
of the images A
6is
A6¼DX6
DX/C3¼/C12/C12/C12/C12y6Dy6
uDu/C12/C12/C12/C12; (22)
Fig. 2. (a) The angular size of the unlensed source. (b) The two images cre-
ated with lensing. The dashed circle in (b) is the Einstein ring with angular
size one according to our parametrization. Image yþis outside of the ring
and larger while image y/C0inside of the ring and smaller.
184 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 184 04 October 2023 22:50:06
where DX6is the solid angle of the images and DX/C3is the
solid angle of the source. Here, the surface brightness can-
cels because it is conserved, and D/cancels since it is the
same for source and images. Now since we are looking at the
case of a point source, we take the limit of Dh!0 and get
A6¼/C12/C12/C12/C12y6
udy6
du/C12/C12/C12/C12: (23)
The derivative is taken using Eq. (11)
dy6
du¼1
216uﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
u2þ4p/C18/C19
; (24)
so
A6¼1
2u2þ2
uﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
u2þ4p 61 !
: (25)
The total magniﬁcation is the sum of the ﬂux of the two
images,
Atot¼jAþjþjA/C0j¼u2þ2
uﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
u2þ4p : (26)
As expected, for u!1 ;Atot!1, while as u!0;
Atot!1 .
The source, the lens, and the observer are all in motion rel-
ative to each other. Here, the simplest case is assumed:Uniform motion with constant velocity. Since we only care
about the relative motion of the system, we assume that only
the source is moving and we can parametrize its angularposition uwith time.
As shown in Fig. 3, the angular position of the source can
be written as
uðtÞ¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
u
2
0þðCtÞ2q
; (27)
where u0is the minimum angular separation between the
lens and the source and cis a constant. Since the angular
position of the source is dimensionless and parametrized by
the Einstein angle, the constant has the inverse units of time
C¼1=tEand
tE/C17hE
lrel; (28)where lrelis the proper motion of the source relative to the
lens (see Ref. 2for more information). If the minimum angu-
lar separation between the source and the lens happens attime t
0and not t¼0,t!t/C0t0and Eq. (27) becomes
uðtÞ¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
u2
0þt/C0t0
tE/C18/C192s
: (29)
Using Eqs. (26) and(29), the total magniﬁcation can be writ-
ten as a function of time, a light curve. Light curves for dif-ferent values of u
0are shown in Fig. 4.
B. General lens
For a non-spherically symmetric lens, as is the case of
multiple point masses, a solid-angle element of the source is
mapped to a solid-angle element of the image.32Then, Eq.
(23) generalizes to the inverse of the determinant of the
Jacobian of the mapping of Eq. (19) and the magniﬁcation is
given by
Aj¼1
detJ/C12/C12/C12/C12
z¼zj: (30)
The individual image can be magniﬁed or demagniﬁed as
in the case of the central image in strong gravitational lenssystems.
33
Writing the Jacobian in terms of the real source and image
variables
detJ/C17/C12/C12/C12/C12@u1=@y1@u1=@y2
@u2=@y1@u2=@y2/C12/C12/C12/C12¼@u1
@y1@u2
@y2/C0@u1
@y2@u2
@y1: (31)
In gravitational lensing, @u1=@y2¼@u2=@y1because of
symmetry.31,34
The derivatives can be written as
df¼@f
@zdzþ@f
@/C22zd/C22z¼@f
@zþ@f
@/C22z/C18/C19
dy1þi@f
@z/C0@f
@/C22z/C18/C19
dy2
(32)
and
Fig. 3. The angular position of the source as function of time. u0is the mini-
mum angular separation between the source and the lens. Since the motion
of the source is considered uniform, its angular position in that direction can
be written as a linear function of time Ct.
Fig. 4. (Color online) Light curves for a single lens microlensing event. The
curves have u0¼0;0:01;0:1;0:2;0:3;0:4;0:5;1 from lightest to darkest.
We can see that for u0¼0, the total magniﬁcation diverges for t¼t0, while
for larger u0the magniﬁcation goes to one for all times.
185 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 185 04 October 2023 22:50:06
df¼du1þidu2
¼@u1
@y1dy1þ@u1
@y2dy2þi@u2
@y1dy1þ@u2
@y2dy2/C18/C19
¼@u1
@y1þi@u2
@y1/C18/C19
dy1þ@u1
@y2þi@u2
@y2/C18/C19
dy2: (33)
Using Eqs. (32) and(33) results in
@f
@zþ@f
@/C22z¼@u1
@y1þi@u2
@y1; (34a)
@f
@z/C0@f
@/C22z¼@u2
@y2/C0i@u1
@y2: (34b)
Solving for the derivatives of fand squaring gives
4@f
@z/C18/C192
¼@u1
@y1þ@u2
@y2/C18/C192
; (35a)
4@f
@/C22z@f
@/C22z/C18/C19
¼@u1
@y1/C0@u2
@y2/C18/C192
þ4@u2
@y1/C18/C192
: (35b)
Subtracting the previous equations gives the expression for
the determinant of the Jacobian as given in Eq. (31). It can
be written in terms of the complex variables as
detJ¼@f
@z/C18/C192
/C0@f
@/C22z@f
@/C22z/C18/C19
: (36)
If the mass density is not continuous, like in the case of
lenses that can be approximated by point masses, @f=@z¼1
(see Ref. 34), so Eq. (36) becomes
detJ¼1/C0@f
@/C22z@f
@/C22z/C18/C19
: (37)
To ﬁnd the total magniﬁcation, the absolute values of the
magniﬁcations of all the images are summed:
A/C17X
jjAjj: (38)
The places where the magniﬁcation diverges or det J¼0
form closed curves. These curves are called critical curveson the image plane and caustics on the source’s plane. This
differs from the notion of caustics in classical optics where
the caustics are deﬁned on the observer’s plane.
To compute the caustics, we take the derivative of the lens
equation (19)
@f
@/C22f¼XN
i/C15i
ð/C22z/C0/C22ziÞ2; (39)
and then the equation det J¼0 becomes
/C12/C12/C12/C12XN
i/C15i
ð/C22z/C0/C22ziÞ2/C12/C12/C12/C122
¼1: (40)
This equation can be solved parametrically34fory1ð/Þand
y2ð/ÞusingXN
i/C15i
ð/C22z/C0/C22ziÞ2¼eiw; (41)
forw2½0;2pÞ.
IV. TRIPLE LENS SYSTEMS
A. Parametrization
For three lenses the Nlens, Eq. (19) becomes
f¼z/C0/C151
/C22z/C0/C22z1/C0/C152
/C22z/C0/C22z2/C0/C153
/C22z/C0/C22z3: (42)
As in the case of a double lens system, we can simplify the
equation and reduce the number of parameters. First, we notice
that/C151þ/C152þ/C153¼1, so we can write /C153¼1/C0/C151/C0/C152. Then,
set the origin of the axes in the middle between the two lenses(1 and 2). So, z
2¼/C0z1and we can place z3/C17‘0on the real
axis. Finally, write the z1in its polar form, so z1¼‘ei/,w h e r e
‘/C17jz1j. So, the lens equation (42)becomes
f¼z/C0/C151
/C22z/C0‘e/C0i//C0/C152
/C22zþ‘e/C0i//C01/C0/C151/C0/C152
/C22z/C0‘0: (43)
Fig. 5. The choice of parameters for the three lens system. The origin of the
axes is the midpoint between masses 1 and 2 while the position of mass 3 is
on the real axis. The angle /is the angle between the line that connects
masses 1 and 2 and the positive real axis.
Fig. 6. The choice of parameters for the source trajectory.
186 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 186 04 October 2023 22:50:06
The system can be completely described by ﬁve parameters:
/C151;/C152;‘ ;‘0;and/. Figure 5represents the conﬁguration.
B. Method
We showed in Sec. II Athat in the single lens case, the lens
equation can be solved by ﬁnding the positions and then cal-culating the magniﬁcation. Something similar could in princi-
p l eb ed o n ei nt h e Nlens case. One could solve the lens
equation (19) forzand get jsolutions for the images positions
and then use the location of the images to calculate the magni-
ﬁcation of each using Eq. (38). However, this method presents
signiﬁcant difﬁculties even in the double lens case.
Examining the triple lens equation (42), we notice that it
involves both zand/C22z. To remove the /C22zdependence, take the
conjugate of Eq. (43) which gives us the conjugate of z
/C22z¼/C22fþ/C151
z/C0‘ei/þ/C152
zþ‘ei/þ1/C0/C151/C0/C152
z/C0‘0: (44)
We replace /C22zin Eq. (43) and after ﬁnding the common
denominator of the fraction and assuming that it is non-zero,
we are left with a tenth-order polynomial in z:
P1ðz;f;/C22fÞ¼X10
i¼1ciðf;/C22fÞzi¼0: (45)
Rhie35presents a way to calculate the coefﬁcients analytically.36
Here, we compute the coefﬁcients using Mathematica and pre-
sent the result in the “10 degree polynomial coefﬁcients” sup-
plementary material.39
Locating the image positions from the equation and then ﬁnd-
ing the magniﬁcation for each of them is not only a difﬁcult taskbut also unnecessary. We desire only the total magniﬁcation.
Instead of solving this tenth-order equation, the magniﬁcation is
found directly using the resultant method. This method was ﬁrstdeveloped by Witt and Mao
27for the double lens case.
First, we evaluate
@f
@/C22z¼/C151
ð/C22z/C0‘e/C0i/Þ2þ/C152
ð/C22zþ‘e/C0i/Þ2þ1/C0/C151/C0/C152
ð/C22z/C0‘0Þ2;(46)
using Eq. (43). Then, from Eqs. (30) and(37), we have the
magniﬁcation of each image Ajin terms of z,fand/C22z. Using
(44), we eliminate /C22z. Clearing the denominators as before
results in an 18th order polynomial in z
P2ðAj;z;f;/C22fÞ¼0: (47)
Now we have two polynomials in zwith coefﬁcients that are
functions of the source position fand/C22fand the magniﬁcation
Aj. As our goal is to ﬁnd the Aj’s in terms of f, we eliminate z
by taking the resultant of P1andP2.
In general, when there are two polynomials of the same
variable, for example
fðxÞ¼anxnþan/C01xn/C01þ/C1/C1/C1þ a1xþa0; (48)
with roots a1;…;anand
gðxÞ¼bmxmþbm/C01xm/C01þ/C1/C1/C1þ b1xþb0; (49)
with roots b1;…;bmwe can deﬁne a third polynomial, the
resultantR¼am
0bn0Yn
i¼1Ym
j¼1ðai/C0bjÞ: (50)
Ifa0b06¼0, the resultant is zero if the polynomials have a
common root. The resultant is particularly useful if we have
a system of equations. Let ai¼aiðyÞand bj¼bjðyÞand
fðx;yÞ¼gðx;yÞ¼0. Then if RðbÞ¼0, either the polyno-
mials fðx;bÞand gðx;bÞhave a common root or a0ðbÞ
¼b0ðbÞ¼0. So, solving the system is reduced to the com-
putation of the roots of the polynomial R(y)¼0. The resul-
tant is effectively a method of reducing the number
of unknowns in a system of equations. Calculatingthe resultant from Eq. (50) is inefﬁcient as it contains
the roots of the original equations. However, the resultant
can also be expressed in the form of the determinant of amatrix of the coefﬁcients of the two polynomials. For
details on the methods of calculating the resultant of two
polynomials, see Ref. 38.
Here, the resultant of P
1and P2was calculated using
Mathematica and in particular, using the “subresultant”
method which was proven to be the most efﬁcient. The result
is a 10th order polynomial in Ajwith coefﬁcients that are
functions of fand/C22f
Fig. 7. (Color online) Magniﬁcation maps and light curves for different
planet to star ratios: 1/100, 1/1000, and 1/10 000 (from top to bottom). The
density plots on the left show the logarithmic absolute magniﬁcation on the
source plane (natural logarithm). The curves on the right show the light
curve produced for the trajectory of the source shown as a straight red line
on the left.
187 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 187 04 October 2023 22:50:06
PresðAj;f;/C22fÞ¼0: (51)
The roots of the polynomial are the individual magniﬁcations
of each image, and summing their absolute values (38) gives
the total magniﬁcation.
Setting f¼xþiy, we can then plot the magniﬁcation at
each point for different values of the source position creatinga magniﬁcation map. The magniﬁcation maps produced,
especially using the logarithmic scale, show very clear
curves with large magniﬁcation. Those structures can bestraightforwardly interpreted as the caustic curves, the placeswhere the magniﬁcation diverges in the source’s plane.
In the double lens case, one can ﬁnd these roots and proceed
to plot the magniﬁcation. However, in the triple lens case that
proved impossible. Instead, we used the Mathematica randomnumber generator to select pairs of ( x,y) and proceeded to eval-
uate the magniﬁcation for each individual point. Each point
(x,y) represents a point on the source plane, which is ﬁlled by
computing a sufﬁcient number of random points. This proce-dure is presented in the Mathematica program “Magniﬁcation
map” included in the supplementary material.
39A computation
of about 20,000 points which creates a detailed magniﬁcationmap takes about 45 min processor computation time with a2.3 GHz Quad-Core Intel Core i7 processor.
In order to generate light curves, we ﬁrst parameterize the
source trajectory. Here, his the angle that the source trajec-
tory makes with the xaxis of the source plane. We deﬁne u
0
as the distance on the xaxis of the source trajectory from the
origin. The parametrization is shown in Fig. 6. Note that this
is a slightly different deﬁnition of u0than the one used in the
literature. Then, we have
y¼xtanh/C0u0: (52)
We use again a random number generator for xvalues and get
a set of points of the form fx;jAjg. This method is presented in
the Mathematica ﬁle “Light curve” in the supplementary mate-rial.39Note in Figs. 7–15 Ref¼xand Im f¼y.V. EXPLORATION OF PARAMETERS
In this section, we use the method described in Sec. IV B
to derive magniﬁcation maps and light curves for a variety of
circumbinary systems. As an assumption, the lenses 1 and 2will have larger mass than lens 3 to model a system with two
stars and a planet. We proceed to examine the effects of the
mass ratios, the distance between the stars, the distance of
the planet, and the angle /.
We start with setting our base parameters. In each section,
one of these parameters will vary and the rest will be set tothe following values unless otherwise stated. The mass of
the stars is set equal to one another and the mass of the
planet 1/1000 of that. The stars’ distance is ‘¼0:25, the
planet’s distance ‘
0¼1 and the angle of the system
/¼p=4. The planet’s distance is taken longer than the
stars’ distance to explore possible microlensing conﬁgura-
tions for planets further from their stars where other methodsfail. The trajectory of the source is characterized by h¼p=4
andu
0¼0:1.
A. Mass of planet
First, we explore the effect of the mass of the planet com-
pared to the stars in a circumbinary system. Three different
Fig. 8. (Color online) Magniﬁcation maps for different planet distances:
‘0¼1:2, 1.1, 0.9, and 0.8 (from top left clockwise). The top panels show
wide systems while the bottom ones close.
Fig. 9. (Color online) Magniﬁcation maps and light curves for different star
separation: ‘¼0:1, 0.2, and 0.3 (from top to bottom). The density plots on
the left show the logarithmic absolute magniﬁcation on the source plane.
The curves on the right show the light curve produced for the trajectory of
the source shown as a straight red line on the left.
188 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 188 04 October 2023 22:50:06
planetary masses expressed as the ratio of the mass of the
planet to the star: 1/100, 1/1000, and 1/10 000 are explored.
The ﬁrst could correspond to a system of two main sequence
Sun-mass stars and a brown dwarf, an object that has a massbetween those of the largest gas giant planets and the small-
est stars. The second represents a giant gas planet with the
mass of Jupiter and the third a smaller gas planet with themass of Neptune.
The magniﬁcation maps and light curves are given in
Fig.7. For the brown dwarf case, the caustic of the system is
complex and characteristic of a triple lens system. The peakcorresponding to the presence of the brown dwarf is double
and very visible. In the case of the Jupiter-mass planet, the
planetary caustic is a perturbation to the main caustic of thestars. However, looking at the light curve, the planet produ-
ces a very clear peak easily detectable. In the last case, the
planetary caustic is barely visible and the light curve of thestars is only slightly perturbed.
B. Distance of planet
Varying the distance of the planet has a signiﬁcant effect
in the shape of the planetary caustics. In the case of a star
and planet system, the three topologies of the caustic are
close ( <1), resonant ( ¼1), and wide ( >1).
2The same cate-
gories can be applied to a circumbinary system with the rele-vant distance being the one of the planet from the center of
two stars ‘
0. These topologies have been studied at the level
of caustics26but here, we present exact magniﬁcation maps.
In Fig. 8, there are four magniﬁcation maps with different
planet distances using the base parameters but planet mass
ratio 1/100. The choice of the large mass ratio was in orderhave the ability to note the change of topology between the
wide and close systems. It is interesting to note that the
planet is detectable more easily in the more wideconﬁguration (top left ‘
0¼1:2), a case where utilizing other
methods such as the transit method is difﬁcult.
C. Distance of stars
The distance between the two stars can change both the
shape of the planetary caustic and the light curve of the
system. When the two stars are close, the planetary causticis a result of both stars as they are similar distances to the
planet.
In Fig. 9, we examine magniﬁcation maps and light
curves for short star distances and mass ratio 1/1000. Onthe top panel the stars are so close ( ‘¼0:1) that the corre-
sponding light curve is similar to a single star and a planet.
In such a system, it would be difﬁcult to detect both starsand the planet as the caustics of the stars are dominant for
sources passing through the center of the system. The sec-
ond panel shows a case where the stars are further apart(‘¼0:2) and dependent on the trajectory of the source,
both stars could be detected or not. The third case corre-
sponds to a larger distance ( ‘¼0:3) where both stars could
be detected for most source trajectories. It is interesting to
observe that the planetary caustic is less prominent in this
case.
Fig. 10. (Color online) Magniﬁcation maps for different star distances:
‘¼0:4, 0.65, 0.9, and 1.15 (from top left clockwise). The top panels show
the change in geometry for ‘/H114070:5 while the bottom ones the weakening of
the caustic connecting the two stars for ‘/H114071.
Fig. 11. (Color online) Magniﬁcation maps and light curves for different
angles of the system: /¼p=2;p=3;andp=6 (from top to bottom). The den-
sity plots on the left show the logarithmic absolute magniﬁcation on the
source plane. The curves on the right show the light curve produced for the
trajectory of the source shown as a straight red line on the left.
189 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 189 04 October 2023 22:50:06
Figure 10shows magniﬁcation maps for larger star dis-
tances, using mass ratio 1/100 so that the planetary causticis visible. Here, with increasing star distance the geometryincreasingly resembles that of a single star and planet withthe stars caustics disconnecting. The geometry of the caus-tic between the two stars changes drastically from ‘¼0:4
(top left panel) to ‘¼0:65 (top right panel). At the bottom
left ( ‘¼0:9) and especially bottom right panel ( ‘¼1:15),
we see the stars’ caustic separating. It is of note that eventhough the caustic connecting the two stars has visibly lessmagniﬁcation, the shape of it is still that of a double lens.
The planetary caustic is moving along with the star that itis closer to, even though the position of the planet does notchange.
D. Angle of the system
Next, we vary the angle /of the system. It is obvious that
different angles lead to very different geometries of the caus-tics and different detectability of the planet in the system. Inthe plots shown in Fig. 11,‘
0¼1:1 is used, so the planetary
caustic is distinct.
As we notice in Fig. 11, the planetary caustic moves fur-
ther up the vertical axis and closer to the center as the angle
of the system gets smaller. In terms of detectability of the
planet, the most difﬁcult case is that of the planet being on orclose to the symmetry axis of the star system. For mostsource trajectories apart from the horizontal ones, the planetcan remain undetectable.
An interesting comparison is that of /¼0a n d /¼p=2
s h o w ni nF i g . 12. Here, the symmetry of the two systems is the
same, making the planet difﬁcult to detect. However, there are
signiﬁcant differences in the shape of the planetary caustic. For/¼0, the caustic is much closer and it shows the beginnings
of a close geometry. For /¼p=2, there is a clear wide geome-
try with the planetary caustic being smaller and further away.
E. Mass of stars
In this subsection, we vary the mass of the two stars to
produce magniﬁcation plots for systems with two different
masses. Of special interest are the cases where the systemtransitions from that of two stars and a planet to one star and aplanet. In practice, this may be difﬁcult to distinguish observa-tionally, as often both models ﬁt well on the light curve.
To examine this transition, three cases were chosen: Two
stars of unequal mass and a planet, a star, a brown dwarf, and a
planet, and a star and two planets of equal mass. Figure 13
Fig. 12. (Color online) Magniﬁcation maps of the /¼p=2 (left) and /¼0
(right) angles of the system.
Fig. 13. (Color online) Magniﬁcation maps and light curves with/C15
1=/C152¼1=1000, 1/100, and 1/10 (top to bottom). Here, /¼p=3 and
u0¼0.Table I. Parameters of the system for magniﬁcation maps.
Circumbinary Two-planet
/C151 0.464 79 8 :5025/C210/C06
/C152 0.534 87 0.999 615
‘ 0.010 650 2 0.950 452
‘0/C00.814 68 /C00.796 07
/(Rads) 0.369 89 /C03.076 11
Fig. 14. (Color online) Magniﬁcation maps for the two probable geometries:
The two planet (left) and circumbinary (right).
190 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 190 04 October 2023 22:50:06
shows the three systems, the ratio of the smallest to the largest
mass is always 1/1000 while the second mass /C152takes the values
1/1000, 1/100, and 1/10 of /C151(top to bottom). The top corre-
sponds to a system with two planets with one of them close tothe star. The light curve is indistinguishable from a system with
a star and one planet as the second planet is too close to the star.
In the second case, the geometry changes as the planet (orbrown dwarf) is signiﬁcantly larger. However, this is not neces-
sarily detectable from a light curve far enough from the star.
The third case represents the geometry of two stars with one ofthem larger than the other.
VI. EXAMPLE: THE OGLE-2007-BLG-349L(AB)C
SYSTEM
The ﬁrst circumbinary system discovered using microlens-
ing (and the only one thus far) was OGLE-2007-BLG-
349L(AB)c in 2016.
9The light curve from the system ﬁts
two classes of models: two-planet models and circumbinaryplanet models. Here, we use the best ﬁt data for both the two
planet and the circumbinary models (Table 2 of Ref. 9).
In order to match the data, note that in the conventions of
Ref. 9, the mass /C15
1corresponds to our mass /C153. Then, the ori-
gin of the axes is the center of mass between masses /C151and
/C152and not the middle of the distance. Thus, we need to make
the substitution ‘!/C151‘=/C152. Table Itranslates the data to
match our conventions.
There are several differences between our method and
the one used by Ref. 9. We solve the system exactly and
produce complete magniﬁcation maps that show more thanthe caustics. However, the orbital motion of the system and
the size of the source is not taken into account, and there-
fore, the magniﬁcation shown in the light curves is largerthan the one in the Ref. 9model. These parameters could
be incorporated in future work but are beyond the scope of
this paper.
First, we look at the magniﬁcation maps that correspond
to the caustics of Fig. 3 of Ref. 9. Looking at Fig. 14, the
magniﬁcation maps look relatively similar. The main differ-
ence is the y-axis symmetry which is broken in the case of
the circumbinary system.
A comparison of the contour with log jAj>8 in Fig. 15
shows the differences between the two geometries in more
detail. In particular, the circumbinary case has largermagniﬁcation near the center. The symmetry differences
between the two cases are also illustrated.
Turning to the light curves, the parameters of Ref. 9for
the source trajectory in each case are used. While the magni-
ﬁcation maps have differences, with the right source trajec-tory the two geometries have almost identical light curves(see Fig. 16). The difference in maximum magniﬁcation can
be attributed to the ﬁnite source versus point source as used
in this analysis.
VII. CONCLUSIONS
In this work, we explored the parameter space of cir-
cumbinary systems in exoplanetary microlensing using anexact method of solution for the three lens equation. The
effect of all ﬁve parameters was considered, and both
exact magniﬁcation maps and light curves were produced.The magniﬁcation maps reveal a richer structure than thecaustics usually studied as they show not only the pointsof large magniﬁcation but also how the magniﬁcation
changes.
There are several directions in which this work could be
extended. Including orbital motion of the system is animportant one. Creating animations of magniﬁcation mapscan show the change of the geometry of the system similarto what was done in Ref. 26.I tw o u l da l s ob ev e r yi n t e r e s t -
ing to combine the orbital motion with the relative motion
of the source and generate the corresponding light curves.In real microlensing events, the orbital motion can play arole if its time scale is comparable to the transit time of thesource.
Including a ﬁnite source with uniform or non-uniform sur-
face brightness is also of interest. Important theoretical work
has been done on that topic,
37so those results could be
incorporated.
A longer term goal would be to extend the method to
include more lenses. New techniques are likely needed hereas the complexity of the system with even one more lens
would make the numerical results signiﬁcantly slower. The
much larger parameter space can also pose a problem whichcould be circumvented by imposing certain additionalsymmetries.
ACKNOWLEDGMENTS
E.-A.K. and E.T. would like to thank Hal Haggard for
collaboration in the earlier stages of this work. E.T. wassupported by the Physics Program of Bard College. The
Fig. 15. (Color online) Comparison of the log jAj>8 for the two planet and
the circumbinary geometries.
Fig. 16. (Color online) Light curves for the two geometries using the twodifferent source trajectories. The form of the curves is almost identical. Thetime tis in HJD
0following Ref. 9.
191 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 191 04 October 2023 22:50:06
authors thank Radek Poleski for several useful comments on
the manuscript. B.C.G. was supported by the ResearchAssociates program of the College of the Holy Cross. E.-A.K. is supported by the ERC Consolidator GrantQUANTIVIOL.
AUTHOR DECLARATIONS
Conflict of Interest
The authors have no conﬂicts to disclose.
a)Electronic mail: e.a.kontou@uva.nl, ORCID: 0000-0003-4409-8188.
b)ORCID: 0000-0001-8820-4371.
1B. Paczynski, “Gravitational microlensing by the galactic halo,”
Astrophys. J. 304, 1–5 (1986).
2B. S. Gaudi, “Exoplanetary microlensing,” arXiv:1002.0332 (2010).
3S. Mao and B. Paczynski, “Gravitational microlensing by double stars and
planetary systems,” Astrophys. J. 374, L37–L40 (1991).
4A. Wolszczan and D. A. Frail, “A planetary system around the millisecond
pulsar PSR1257 þ12,” Nature 355(6356), 145–147 (1992).
5M. Mayor and D. Queloz, “A Jupiter-mass companion to a solar-type star,”
Nature 378(6555), 355–359 (1995).
6I. A. Bond, A. Udalski, M. Jaroszy /C19nski, N. Rattenbury, B. Paczy /C19nski, I.
Soszy /C19nski, L. Wyrzykowski, M. Szyma /C19nski, M. Kubiak, O. Szewczyk
et al. , “OGLE 2003-BLG-235/MOA 2003-BLG-53: A planetary micro-
lensing event,” Astrophys. J. Lett. 606(2), L155–L158 (2004).
7D. Raghavan, H. A. McAlister, T. J. Henry, D. W. Latham, G. W. Marcy,
B. D. Mason, D. R. Gies, R. J. White, and A. Theo, “A survey of stellarfamilies: Multiplicity of solar-type stars,” Astrophys. J. Suppl. Ser. 190(1),
1–42 (2010).
8S. Thorsett, Z. Arzoumanian, and J. Taylor, “PSR B1620-26: A binary radiopulsar with a planetary companion?,” Astrophys. J. 412, L33–L36 (1993).
9D. Bennett, S. Rhie, A. Udalski, A. Gould, Y. Tsapras, D. Kubas, I. Bond,
J. Greenhill, A. Cassan, N. Rattenbury et al. , “The ﬁrst circumbinary
planet found by microlensing: OGLE-2007-BLG-349L (AB) C,” Astron.
J.152(5), 125 (2016).
10E. Mediavilla, J. A. Mu ~noz, P. Lopez, T. Mediavilla, C. Abajas, C.
Gonzalez-Morcillo, and R. Gil-Merino, “A fast and very accurate
approach to the computation of microlensing magniﬁcation patterns based
on inverse polygon mapping,” Astrophys. J. 653(2), 942–953 (2006).
11See <https://github.com/benbarsdell/grav-lensing-sim >for the code of
the simulation.
12M. Selmke and J. A. Lock, “Optical caustics of multiple objects in water:Two vertical rods and normally incident light,” Appl. Opt. 59(26),
7981–7993 (2020).
13M. Selmke, “An optical n-body gravitational lens analogy,” Am. J. Phys.
89(1), 11–20 (2021).
14P. Schneider and A. Weiss, “The two-point-mass lens – Detailed investiga-
tion of a special asymmetric gravitational lens,” Astron. Astrophys. 164,
237–259 (1986).
15V. Bozza, “Caustics in special multiple lenses,” Astron. Astrophys.
355(2), 423–432 (2000).
16V. Bozza, “Secondary caustics in close multiple lenses,” Astron.
Astrophys 359, 1–8 (2000).17K. Dan /C20ek and D. Heyrovsk /C19y, “Image-plane analysis of n-point-mass lens
critical curves and caustics,” Astrophys. J. 806(1), 63 (2015).
18K. Dan /C20ek and D. Heyrovsk /C19y, “Critical curves and caustics of triple-lens
models,” Astrophys. J. 806(1), 99 (2015).
19K. Dan /C20ek and D. Heyrovsk /C19y, “Triple-lens gravitational microlensing:
Critical curves for arbitrary spatial conﬁguration,” Astrophys. J. 880(2), 72
(2019).
20S. Mao, A. Petters, and H. Witt, “Properties of point mass lenses on a regu-lar polygon and the problem of maximum number of images,” arXiv:astro-
ph/9708111 (1997).
21S. H. Rhie, “n-point gravitational lenses with 5 (n-1) images,” arXiv:astro-
ph/0305166 (2003).
22B. S. Gaudi, R. M. Naber, and P. D. Sackett, “Microlensing by multiple
planets in high-magniﬁcation events,” Astrophys. J. Lett. 502(1), L33–L37
(1998).
23C. Han, H.-Y. Chang, J. H. An, and K. Chang, “Properties of microlensinglight curve anomalies induced by multiple planets,” Mon. Not. R. Astron.
Soc.328(3), 986–992 (2001).
24C. Han and W. Han, “On the feasibility of detecting satellites of extrasolar
planets via microlensing,” Astrophys. J. 580(1), 490–493 (2002).
25C. Han, “Distinguishing between planetary and binary interpretations of
microlensing central perturbations under the severe ﬁnite-source effect,”
Astrophys. J. Lett. 691(1), L9–L12 (2008).
26J. K. Luhn, M. T. Penny, and B. S. Gaudi, “Caustic structures and detect-
ability of circumbinary planets in microlensing,” Astrophy. J. 827(1), 61
(2016).
27H. J. Witt and S. Mao, “On the minimum magniﬁcation between causticcrossings for microlensing by binary and multiple stars,” Astrophys. J.
Lett. 447(2), L105–L108 (1995).
28J. B. Hartle, Gravity: An Introduction to Einstein’s General Relativity
(Cambridge U. P., Cambridge, 2021).
29The deﬂection angle’s form can be derived by a purely Newtonian calcula-
tion of a massive particle moving with the speed of light, passing by
another massive object. The result is the same as Eq. (1)except a factor of
two. This factor can only be retrieved by a general relativistic calculation
(for example, see Ref. 28).
30Note that this expression is not correct for cosmological distances.
31P. Schneider, “The ampliﬁcation caused by gravitational bending of light,”
Astron. Astrophys. 140, 119–124 (1984).
32R. Narayan and M. Bartelmann, “Lectures on gravitational lensing,”
arXiv:astro-ph/9606001 (1996).
33G. Dobler, C. R. Keeton, and J. Wambsganss, “Microlensing of central
images in strong gravitational lens systems,” Mon. Not. R. Astron. Soc.
377(3), 977–986 (2007).
34H. Witt, “Investigation of high ampliﬁcation events in light curves of grav-
itationally lensed quasars,” Astron. Astrophys. 236, 311–322 (1990).
35S. H. Rhie, “How cumbersome is a tenth order polynomial?: The case of
gravitational triple lens equation,” arXiv:astro-ph/0202294 (2002).
36The method presented in the reference is valuable. However, we have
located some small errors in the ﬁnal form of the coefﬁcients.
37H. J. Witt and S. Mao, “Can lensed stars be regarded as pointlike formicrolensing by machos?,” Astrophys. J. 430, 505–510 (1994).
38I. M. Gelfand, M. M. Kapranov, and A. V. Zelevinsky, “Discriminants and
resultants for polynomials in one variable,” in Discriminants, Resultants,
and Multidimensional Determinants. Mathematics: Theory & Applications(Birkh €auser, Boston, MA, 1994).
39See supplementary material at https://www.scitation.org/doi/suppl/
10.1119/5.0088604 for the Mathematica code and coefﬁcients.
192 Am. J. Phys., Vol. 91, No. 3, March 2023 George et al. 192 04 October 2023 22:50:06
